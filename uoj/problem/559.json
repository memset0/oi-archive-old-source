{"title":"【NOI2020】命运","time_limit":2000,"memory_limit":1024,"url":"http://uoj.ac/problem/559","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n<p><strong>提示</strong>：我们在题目描述的最后一段提供了一份简要的、形式化描述的题面。 </p>\n<p>在遥远的未来，物理学家终于发现了时间和因果的自然规律。即使在一个人出生前，我们也可以通过理论分析知晓他或她人生的一些信息，换言之，物理学允许我们从一定程度上“预言”一个人的“命运”。</p>\n<p>简单来说，一个人的命运是一棵由时间点构成的有根树 $T$：树的根结点代表着出生，而叶结点代表着死亡。每个非叶结点 $u$ 都有一个或多个孩子 $v_1,v_2,\\cdots,v_{c_u}$，表示这个人 在 $u$ 所代表的时间点做出的 $c_u$ 个不同的选择可以导向的不同的可能性。形式化的，一个<strong>选择</strong>就是树上的一条边 $(u,v_i)$，其中 $u$ 是 $v_i$ 的父结点。</p>\n<p>一个人的一生是从出生（即根结点）到死亡（即某一个叶子结点）的一条不经过重复结点的路径，这条路径上任何一个包含至少一条边的子路径都是这个人的一段<strong>人生经历</strong>，而他或她以所有可能的方式度过一生，从而拥有的所有人生经历，都被称为<strong>潜在的人生经历</strong>。换言之，所有潜在的人生经历就是所有 $u$ 到 $v$ 的路径，满足 $u,v \\in T，u \\neq v$， 并且 $u$ 是 $v$ 的祖先。在数学上，这样一个潜在的人生经历被记作有序对 $(u,v)$，树 T 所有潜在的人生经历的集合记作 $\\mathcal{P}_T$。</p>\n<p>物理理论不仅允许我们观测代表命运的树，还能让我们分析一些潜在的人生经历是否是“重要”的。一个人所作出的每一个选择——即树上的每一条边 —— 都可能是<strong>重要</strong>或<strong>不重要</strong>的。一段潜在的人生经历被称为重要的，当且仅当其对应的路径上存在一条边是重要的。我们可以观测到一些潜在的人生经历是重要的：换言之，我们可以观测得到 一个集合 $\\mathcal{Q} \\subseteq \\mathcal{P}_T$，满足其中的所有潜在的人生经历 $(u,v) \\in \\mathcal{Q}$ 都是重要的。 </p>\n<p>树 $T$ 的形态早已被计算确定，集合 $\\mathcal{Q}$ 也早已被观测得到，一个人命运的不确定性 已经大大降低了。但不确定性仍然是巨大的 —— 来计算一下吧，对于给定的树 $T$ 和集合 $\\mathcal{Q}$，存在多少种不同的方案确定每条边是否是重要的，使之满足所观测到的 $\\mathcal{Q}$ 所对应的限制：即对于任意 $(u,v) \\in \\mathcal{Q}$，都存在一条 $u$ 到 $v$ 路径上的边被确定为重要的。 </p>\n<p><strong>形式化的</strong>：给定一棵树 $T = (V,E)$ 和点对集合 $\\mathcal{Q} \\subset V \\times V$ ，满足对于所有 $(u,v) \\in \\mathcal{Q}$， 都有 $u \\neq v$，并且 $u$ 是 $v$ 在树 $T$ 上的祖先。其中 $V$ 和 $E$ 分别代表树 T 的结点集和边集。求有多少个不同的函数 $f : E \\rightarrow {0,1}$（将每条边 $e \\in E$ 的 $f(e)$ 值置为 0 或 1），满足对于任何 $(u,v) \\in \\mathcal{Q}$，都存在 $u$ 到 $v$ 路径上的一条边 $e$ 使得 $f(e) = 1$。由于答案可能非常大，你只需要输出结果对 $998,244,353$（一个素数）取模的结果。</p>\n"},{"title":"输入格式","format":"html","require":["katex"],"content":"\n\n<p>第一行包含一个正整数 $n$，表示树 $T$ 的大小，树上结点从 $1$ 到 $n$ 编号，$1$ 号结点为根结点；</p>\n<p>接下来 $n−1$ 行每行包含空格隔开的两个数 $x_i,y_i$，满足 $1 \\le x_i,y_i \\le n$，表示树 上的结点 $x_i$ 和 $y_i$ 之间存在一条边，但并不保证这条边的方向； </p>\n<p>接下来一行包含一个非负整数 $m$，表示所观测得到信息的条数。 </p>\n<p>接下来 $m$ 行每行包含空格隔开的两个数 $u_i,v_i$，表示 $(u_i,v_i) \\in \\mathcal{Q}$。<strong>请注意</strong>：输入数据可能包含重复的信息，换言之可能存在 $i \\neq j$，满足 $u_i = u_j$ 且 $v_i = v_j$。</p>\n<p>输入数据规模和限制参见本题末尾的表格。</p>\n"},{"title":"输出格式","format":"html","require":["katex"],"content":"\n\n<p>输出仅一行一个整数，表示方案数对 $998,244,353$ 取模的结果。</p>\n"},{"title":"样例一","format":"html","require":["katex"],"content":"\n\n<h4>input</h4>\n<pre>5\n1 2\n2 3\n3 4\n4 5\n2\n1 3\n2 5\n</pre>\n\n<h4>output</h4>\n<pre>10\n</pre>\n\n<h4>explanation</h4>\n<p>共有 16 种方案，其中不满足题意的方案有以下 6 种： </p>\n<ul><li>$(1,2),(2,3),(3,5)$ 确定为不重要，$(3,4)$ 确定为重要：集合 $\\mathcal{Q}$ 中没有限制被满足。 </li>\n<li>$(1,2),(2,3),(3,4),(3,5)$ 确定为不重要：集合 $\\mathcal{Q}$ 中没有限制被满足。 </li>\n<li>$(1,2),(2,3)$ 确定为不重要，$(3,4),(3,5)$ 确定为重要：集合 $\\mathcal{Q}$ 中 $(1,3)$ 没被满足。 </li>\n<li>$(1,2),(2,3),(3,4)$ 确定为不重要，$(3,5)$ 确定为重要：集合 $\\mathcal{Q}$ 中 $(1,3)$ 没被满足。 </li>\n<li>$(2,3),(3,5)$ 确定为不重要，$(1,2),(3,4)$ 确定为重要：集合 $\\mathcal{Q}$ 中 $(2,5)$ 没被满足。 </li>\n<li>$(2,3),(3,4),(3,5)$ 确定为不重要，$(1,2)$ 确定为重要：集合 $\\mathcal{Q}$ 中 $(2,5)$ 没被满足。 </li>\n<li>其他方案下，集合 $\\mathcal{Q}$ 中的限制都被满足了。</li>\n</ul>"},{"title":"样例二","format":"html","require":["katex"],"content":"\n\n<h4>input</h4>\n<pre>15\n2 1\n3 1\n4 3\n5 2\n6 3\n7 6\n8 4\n9 5\n10 7\n11 5\n12 10\n13 3\n14 9\n15 8\n6\n3 12\n5 11\n2 5\n3 13\n8 15\n1 13\n</pre>\n\n<h4>output</h4>\n<pre>960\n</pre>\n\n"},{"title":"样例三","format":"html","require":["katex"],"content":"\n\n<p>见样例数据下载。</p>\n"},{"title":"样例四","format":"html","require":["katex"],"content":"\n\n<p>见样例数据下载。</p>\n"},{"title":"数据范围","format":"html","require":["katex"],"content":"\n\n<div class=\"table-responsive\">\n    <table class=\"table table-bordered table-text-center table-vertical-middle\"><thead><tr><th>测试点编号</th><th>$n$</th><th>$m$</th><th>$T$为完全二叉树</th></tr></thead><tbody><tr><td>$1$</td><td rowspan=\"4\">$\\le 10$</td><td rowspan=\"4\">$\\le 10$</td><td rowspan=\"16\">否</td></tr><tr><td>$2$</td></tr><tr><td>$3$</td></tr><tr><td>$4$</td></tr><tr><td>$5$</td><td>$\\le 500$</td><td>$\\le 15$</td></tr><tr><td>$6$</td><td>$\\le 10000$</td><td>$\\le 10$</td></tr><tr><td>$7$</td><td>$\\le 100000$</td><td rowspan=\"2\">$\\le 16$</td></tr><tr><td>$8$</td><td>$\\le 500000$</td></tr><tr><td>$9$</td><td>$\\le 100000$</td><td rowspan=\"2\">$\\le 15$</td></tr><tr><td>$10$</td><td>$\\le 500000$</td></tr><tr><td>$11$</td><td>$\\le 600$</td><td>$\\le 600$</td></tr><tr><td>$12$</td><td>$\\le 1000$</td><td>$\\le 1000$</td></tr><tr><td>$13$</td><td rowspan=\"2\">$\\le 2000$</td><td rowspan=\"2\">$\\le 500000$</td></tr><tr><td>$14$</td></tr><tr><td>$15$</td><td rowspan=\"2\">$\\le 500000$</td><td rowspan=\"2\">$\\le 2000$</td></tr><tr><td>$16$</td></tr><tr><td>$17$</td><td rowspan=\"2\">$\\le 100000$</td><td rowspan=\"4\">$\\le 100000$</td><td rowspan=\"2\">是</td></tr><tr><td>$18$</td></tr><tr><td>$19$</td><td>$\\le 50000$</td><td rowspan=\"7\">否</td></tr><tr><td>$20$</td><td>$\\le 80000$</td></tr><tr><td>$21$</td><td rowspan=\"2\">$\\le 100000$</td><td rowspan=\"5\">$\\le 500000$</td></tr><tr><td>$22$</td></tr><tr><td>$23$</td><td rowspan=\"3\">$\\le 500000$</td></tr><tr><td>$24$</td></tr><tr><td>$25$</td></tr></tbody></table></div>\n\n<p><strong>全部数据满足：</strong>$n \\le 5 \\times 10^5$，$m \\le 5 \\times 10^5$。输入构成一棵树，并且对于 $1 \\le i \\le m$，$u_i$ 始终为 $v_i$ 的祖先结点。</p>\n<p><strong>完全二叉树：</strong>在本题中，每个非叶结点都有左右子结点，且所有叶子结点深度相同的树称为满二叉树；将满二叉树中的结点按照从上到下、从左向右的顺序编号，编号最小的若干个结点形成的树称为完全二叉树。</p>\n<p><strong>时间限制</strong>：$2\\texttt{s}$</p>\n<p><strong>空间限制</strong>：$1\\texttt{GB}$</p>\n"},{"title":"下载","format":"html","require":["katex"],"content":"\n\n<p><a href=\"/download.php?type=problem&amp;id=559\">样例数据下载</a></p>\n\n"}]}