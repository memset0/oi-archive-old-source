{"title":"【UR #5】怎样跑得更快","time_limit":1000,"memory_limit":256,"url":"http://uoj.ac/problem/62","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n<div class=\"hide\">\n$\\newcommand\\lcm{\\mathbin{\\mathrm{lcm}}}$\n</div>\n\n<p>大力水手问禅师：“大师，我觉得我光有力气是不够的。比如我吃菠菜可以让力气更大，但是却没有提升跑步的速度。请问怎样才能跑得更快？我试过吃白菜，没有效果。”</p>\n<p>禅师浅笑，答：“方法很简单，不过若想我教你，你先看看这道UOJ Round的C题。”</p>\n<p>令 $p = 998244353$（$7 \\times 17 \\times 2^{23} + 1$，一个质数）。</p>\n<p>给你整数 $n, c, d$。现在有整数 $x_1, \\dots, x_n$ 和 $b_1, \\dots, b_n$ 满足 $0 \\leq x_1, \\dots, x_n, b_1, \\dots, b_n &lt; p$，且对于 $1 \\leq i \\leq n$ 满足：</p>\n<p>\\begin{equation}\n\\sum_{j = 1}^{n} \\gcd(i, j)^c \\cdot \\lcm(i, j)^d \\cdot x_j \\equiv b_i \\pmod{p}\n\\end{equation}\n其中 $v \\equiv u \\pmod{p}$ 表示 $v$ 和 $u$ 除以 $p$ 的余数相等。$\\gcd(i, j)$ 表示 $i$ 和 $j$ 的最大公约数，$\\lcm(i, j)$ 表示 $i$ 和 $j$ 的最小公倍数。</p>\n<p>有 $q$ 个询问，每次给出 $b_1, \\dots, b_n$，请你解出 $x_1, \\dots, x_n$ 的值。</p>\n"},{"title":"# 输入格式","format":"html","require":["katex"],"content":"\n\n<p>第一行四个整数 $n, c, d, q$。保证 $n, q \\geq 1$。</p>\n<p>接下来 $q$ 行，每行 $n$ 个整数依次表示 $b_1, \\dots, b_n$。保证 $0 \\leq b_1, \\dots, b_n &lt; p$。</p>\n"},{"title":"# 输出格式","format":"html","require":["katex"],"content":"\n\n<p>共 $q$ 行，每行对给出的 $b_1, \\dots, b_n$，输出对应的 $x_1, \\dots, x_n$。如果有多组解输出任意一组即可。如果无解那么这一行只用输出一个整数 $-1$。</p>\n"},{"title":"# 样例一","format":"html","require":["katex"],"content":"\n\n<h4>input</h4>\n<pre>3 1 0 2\n1 0 0\n1 2 3\n\n</pre>\n\n<h4>output</h4>\n<pre>499122179 998244352 499122176\n998244352 1 1\n\n</pre>\n\n<h4>explanation</h4>\n<p>对于第一个询问，要满足的等式为：</p>\n<p>\\begin{eqnarray}\n\\begin{cases}\nx_1 + x_2 + x_3 &amp; \\equiv &amp; 1 &amp; \\pmod{p}\\\\\nx_1 + 2x_2 + x_3 &amp; \\equiv &amp; 0 &amp; \\pmod{p}\\\\\nx_1 + x_2 + 3x_3 &amp; \\equiv &amp; 0 &amp; \\pmod{p}\n\\end{cases}\n\\end{eqnarray}</p>\n"},{"title":"# 样例二","format":"html","require":["katex"],"content":"\n\n<p>见样例数据下载。</p>\n"},{"title":"# 限制与约定","format":"html","require":["katex"],"content":"\n\n<p>对于所有数据，$nq \\leq 3 \\times 10^5$，$0 \\leq c, d \\leq 10^9$。</p>\n<div class=\"table-responsive\">\n<table class=\"table table-bordered table-text-center table-vertical-middle\"><thead><tr><th>测试点编号</th>\n<th>$n$</th>\n<th>$q$</th>\n<th>其他</th>\n</tr></thead><tbody><tr><td>1</td><td>$\\leq 3$</td><td>$=1$</td><td>$c, d \\leq 1000$</td></tr><tr><td>2</td><td rowspan=\"7\">$\\leq 100$</td><td>$=1$</td><td>$c = d$</td></tr><tr><td>3</td><td rowspan=\"2\">$\\leq 10$</td><td rowspan=\"2\">保证有唯一解</td></tr><tr><td>4</td></tr><tr><td>5</td><td rowspan=\"4\">$\\leq 1000$</td><td>$c = 1, d = 0$</td></tr><tr><td>6</td><td rowspan=\"3\">保证有唯一解</td></tr><tr><td>7</td></tr><tr><td>8</td></tr><tr><td>9</td><td rowspan=\"6\">$\\leq 1000$</td><td rowspan=\"3\">$=1$</td><td rowspan=\"3\">保证有唯一解</td></tr><tr><td>10</td></tr><tr><td>11</td></tr><tr><td>12</td><td rowspan=\"3\">$\\leq 10$</td><td>$c = d$</td></tr><tr><td>13</td><td rowspan=\"2\">保证有唯一解</td></tr><tr><td>14</td></tr><tr><td>15</td><td rowspan=\"6\">$\\leq 10^5$</td><td rowspan=\"6\">$\\leq 3$</td><td rowspan=\"2\">$c = 1, d = 0$</td></tr><tr><td>16</td></tr><tr><td>17</td><td>$c = d$</td></tr><tr><td>18</td><td rowspan=\"3\">无</td></tr><tr><td>19</td></tr><tr><td>20</td></tr></tbody></table></div>\n\n<p><strong>时间限制：</strong>$1\\texttt{s}$</p>\n<p><strong>空间限制：</strong>$256\\texttt{MB}$</p>\n"},{"title":"# 后记","format":"html","require":["katex"],"content":"\n\n<p>还没听完题，大力水手就嘶吼着：“太难了我不会我不会！”，飞快地跑掉了。</p>\n<p>禅师看着大力水手消失的背影，叹了口气说：“你们这些人啊，每天就想做些大水题，一碰到难题，跑得不知道比谁都快。”</p>\n<p>后来大力水手把UOJ Round的C题题面贴在了汽车的后挡风玻璃上，人类从此掌握了光速旅行的正确方式。</p>\n"},{"title":"# 下载","format":"html","require":["katex"],"content":"\n\n<p><a href=\"/download.php?type=problem&amp;id=62\">样例数据下载</a></p>\n\n"}]}