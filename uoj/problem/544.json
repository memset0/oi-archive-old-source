{"title":"【统一省选2020】作业题","time_limit":0,"memory_limit":0,"url":"http://uoj.ac/problem/544","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n<p>小 W 刚刚在离散数学课学习了生成树的知识：一个无向图 $G = (V,E)$ 的生成树 $T$ 为边集 $E$ 的一个大小为 $|V|-1$ 的子集，且保证 $T$ 的生成子图在 $G$ 中连通。</p>\n<p>小 W 在做今天的作业时被这样一道题目难住了：</p>\n<p>给定一个 $n$ 个顶点 $m$ 条边（点和边都从 $1$ 开始编号）的无向图 $G$，保证图中无重边和无自环。每一条边有一个正整数边权 $w_i$，对于一棵 $G$ 的生成树 $T$，定义 $T$ 的价值为：$T$ 所包含的边的边权的最大公约数乘以边权之和，即：</p>\n<p>$$\nval(T) = \\left(\\sum_{i=1}^{n-1} w_{e_i}\\right) \\times \\gcd (w_{e_1}, w_{e_2}, \\dots, w_{e_{n-1}})\n$$</p>\n<p>其中 $e_1, e_2, \\dots, e_{n-1}$ 为 $T$ 包含的边的编号。</p>\n<p>小 W 需要求出 $G$ 的所有生成树 $T$ 的价值之和，他做了很久也没做出来，请你帮帮他。由于答案可能很大，你只需要给出答案对 $998244353$ 取模后的结果。</p>\n"},{"title":"输入格式","format":"html","require":["katex"],"content":"\n\n<p>第一行两个正整数 $n,m$，表示 $G$ 的点数和边数。</p>\n<p>接下来 $m$ 行，每行三个正整数 $u_i, v_i, w_i$，第 $i$ 行表示一条无向边连接 $u_i$ 号点和 $v_i$ 号点，权值为 $w_i$。</p>\n"},{"title":"输出格式","format":"html","require":["katex"],"content":"\n\n<p>一行一个整数，表示答案对 $998244353$ 取模后的结果。</p>\n"},{"title":"样例1","format":"html","require":["katex"],"content":"\n\n<h4>input</h4>\n<pre><code class=\"sh_plain\">3 3\n1 2 4\n2 3 6\n1 3 12</code></pre>\n<h4>output</h4>\n<pre><code class=\"sh_plain\">192</code></pre>\n<h4>explanation</h4>\n<p>$G$ 共有三棵生成树：</p>\n<p>$T_1 = \\{(1, 2), (2, 3)\\}$，价值为 $10\\times 2 = 20$。</p>\n<p>$T_2 = \\{(1, 2), (1, 3)\\}$，价值为 $16\\times 4 = 64$。</p>\n<p>$T_3 = \\{(1, 3), (2, 3)\\}$，价值为 $18\\times 6 = 108$。</p>\n<p>总和为 $192$。</p>\n"},{"title":"样例2","format":"html","require":["katex"],"content":"\n\n<p>见附加文件中 <code>ex_count2.in</code> 与 <code>ex_count2.ans</code>。</p>\n"},{"title":"数据范围","format":"html","require":["katex"],"content":"\n\n<p>对于前 $10\\%$ 的数据满足：$m\\le 15$。</p>\n<p>另有 $20\\%$ 的数据满足：$m \\le n$。</p>\n<p>另有 $20\\%$ 的数据满足：$w_i$ 均相同。</p>\n<p>另有 $20\\%$ 的数据满足：$w_i$ 均为质数。</p>\n<p>对于 $100\\%$ 的数据满足：$1\\le n\\le 30, 1\\le m \\le \\frac {n(n-1)}2, 1\\le w_i \\le 152501$。</p>\n<p><strong>时间限制:</strong> $3\\texttt{s}$</p>\n<p><strong>空间限制:</strong> $512\\texttt{MB}$</p>\n\n"}]}