{"title":"【NOI2014】动物园","time_limit":1000,"memory_limit":512,"url":"http://uoj.ac/problem/5","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n<p>近日，园长发现动物园中好吃懒做的动物越来越多了。例如企鹅，只会卖萌向游客要吃的。为了整治动物园的不良风气，让动物们凭自己的真才实学向游客要吃的园长决定开设算法班，让动物们学习算法。 某天，园长给动物们讲解KMP算法。</p>\n<p>园长：“对于一个字符串$S$它的长度为$L$。我们可以在$O(L)$的时间内求出一个名为next的数组。有谁预习了next数组的含义吗？”</p>\n<p>熊猫：“对于字符串$S$的前$i$个字符构成的子串，既是它的后缀又是它的前缀的字符串中，它本身除外，最长的长度记作 next[i]。”</p>\n<p>园长:“非常好,那你能举个例子吗?”</p>\n<p>熊猫:“例如$S$为<u>abcababc</u>，则next[5]=2。因为S的前5个字符为<u>abcab</u>，<u>ab</u>既是它的后缀又是它的前缀，并且找不到一个更长的字符串满足这个性质。同理，还可得出 next[1] = next[2] = next[3] = 0, next[4] = next[6] = 1, next[7] = 2, next[8] = 3。”</p>\n<p>园长表扬了认真预习的熊猫同学。随后，他详细讲解了如何在$O(L)$的时间内求出next数组。下课前，园长提出了一个问题：“KMP算法只能求出next数组。我现在希望求出一个更强大num数组——对于字符串$S$的前$i$个字符构成的子串，既是它的后缀同时又是它的前缀，并且该后缀与该前缀不重叠，将这种字符串的数量记作num[i]。例如$S$为<u>aaaaa</u>，则num[4]=2。这是因为$S$的前$4$个字符为<u>aaaa</u>，其中<u>a</u>和<u>aa</u>都满足性质‘既是后缀又是前缀’，同时保证这个后缀与这个前缀不重叠。而<u>aaa</u>虽然满足性质‘既是后缀又是前缀’。但遗憾的是这个后缀与这个前缀重叠了，所以不能计算在内。同理，num[1]=0,num[2]=num[3]=1,num[5]=2。”</p>\n<p>最后，园长给出了奖励条件，第一个做对的同学奖励巧克力一盒。听了这句话，睡了一节课的企鹅立刻就醒过来了。但企鹅并不会做这道题，于是向参观动物园的你寻求帮助。你能否帮助企鹅写一个程序求出num数组呢？</p>\n<p>特别地，为了避免大量的输出，你不需要输出num[i]分别是多少，你只需要输出 $\\prod_{i=1}^L (num[i]+1)$对$1000000007$取模的结果即可。</p>\n<p>其中$\\prod_{i=1}^n (num[i]+1)=(num[1]+1)\\times (num[2]+1)\\times \\dots \\times (num[n]+1)$。</p>\n"},{"title":"# 输入格式","format":"html","require":["katex"],"content":"\n\n<p>输入文件的第1行仅包含一个正整数$n$</p>\n<p>表示测试数据的组数。 随后$n$行，每行描述一组测试数据。</p>\n<p>每组测试数据仅含有一个字符串$S$，$S$的定义详见题目描述。数据保证$S$，中仅含小写字母。输入文件中不会包含多余的空行，行末不会存在多余的空格。</p>\n"},{"title":"# 输出格式","format":"html","require":["katex"],"content":"\n\n<p>输出文件应包含$n$行</p>\n<p>每行描述一组测试数据的答案</p>\n<p>答案的顺序应与输入数据的顺序保持一致。对于每组测试数据，仅需要输出一个整数，表示这组测试数据的答案对1000000007取模的结果。</p>\n<p>输出文件中不应包含多余的空行</p>\n"},{"title":"# 样例一","format":"html","require":["katex"],"content":"\n\n<h4>input</h4>\n<pre>3\naaaaa\nab\nabcababc\n\n</pre>\n\n<h4>output</h4>\n<pre>36\n1\n32\n\n</pre>\n\n"},{"title":"# 样例二","format":"html","require":["katex"],"content":"\n\n<p>见“样例数据下载”</p>\n"},{"title":"# 限制与约定","format":"html","require":["katex"],"content":"\n\n<div class=\"table-responsive\">\n<table class=\"table table-bordered table-text-center table-vertical-middle\"><thead><tr><th>测试点编号</th>\n<th>约定</th>\n</tr></thead><tbody><tr><td>1</td><td>$n \\leq 5, L \\leq 50$</td></tr><tr><td>2</td><td>$n \\leq 5, L \\leq 200$</td></tr><tr><td>3</td><td>$n \\leq 5, L \\leq 200$</td></tr><tr><td>4</td><td>$n \\leq 5, L \\leq 10000$</td></tr><tr><td>5</td><td>$n \\leq 5, L \\leq 10000$</td></tr><tr><td>6</td><td>$n \\leq 5, L \\leq 100000$</td></tr><tr><td>7</td><td>$n \\leq 5, L \\leq 200000$</td></tr><tr><td>8</td><td>$n \\leq 5, L \\leq 500000$</td></tr><tr><td>9</td><td>$n \\leq 5, L \\leq 1000000$</td></tr><tr><td>10</td><td>$n \\leq 5, L \\leq 1000000$</td></tr></tbody></table></div>\n\n<p>时间限制：$1\\texttt{s}$</p>\n<p>空间限制：$512\\texttt{MB}$</p>\n"},{"title":"# 下载","format":"html","require":["katex"],"content":"\n\n<p><a href=\"/download.php?type=problem&amp;id=5\">样例数据下载</a></p>\n\n"}]}