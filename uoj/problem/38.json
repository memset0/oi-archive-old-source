{"title":"【清华集训2014】奇数国","time_limit":1000,"memory_limit":256,"url":"http://uoj.ac/problem/38","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n<p>在一片美丽的大陆上有 $100000$ 个国家，记为 $1$ 到 $100000$。这里经济发达，有数不尽的账房，并且每个国家有一个银行。某大公司的领袖在这 $100000$ 个银行开户时都存了 $3$ 大洋，他惜财如命，因此会不时地派小弟 GFS 清点一些银行的存款或者让 GFS 改变某个银行的存款。该村子在财产上的求和运算等同于我们的乘法运算，也就是说领袖开户时的存款总和为 $3^{100000}$。这里发行的软妹面额是最小的 $60$ 个素数 $（p_1 = 2, p_2 = 3, \\dots, p_{60} = 281）$，任何人的财产都只能由这 $60$ 个基本面额表示，即设某个人的财产为 $\\text{fortune}$（正整数），则 $\\text{fortune} = p_1^{k_1} \\cdot p_2^{k_2} \\cdot \\dots \\cdot p_{60}^{k_{60}}$。</p>\n<p>领袖习惯将一段编号连续的银行里的存款拿到一个账房去清点，为了避免 GFS 串通账房叛变，所以他不会每次都选择同一个账房。GFS 跟随领袖多年已经摸清了门路,知道领袖选择账房的方式。如果领袖选择清点编号在 $[a, b]$ 内的银行财产，他会先对 $[a, b]$ 的财产求和（计为 $\\text{product}$），然后在编号属于 $[1, \\text{product}]$ 的账房中选择一个去清点存款，检验自己计算是否正确同时也检验账房与 GFS 是否有勾结。GFS 发现如果某个账房的编号 $\\text{number}$ 与 $\\text{product}$ 相冲，领袖绝对不会选择这个账房。怎样才算与 $\\text{product}$ 不相冲呢？若存在整数 $x,y$ 使得 $\\text{number} \\cdot x + \\text{product} \\cdot y = 1$，那么我们称 $\\text{number}$ 与 $\\text{product}$ 不相冲，即该账房有可能被领袖相中。当领袖又赚大钱了的时候，他会在某个银行改变存款，这样一来相同区间的银行在不同的时候算出来的 $\\text{product}$ 可能是不一样的，而且领袖不会在某个银行的存款总数超过 $1000000$。</p>\n<p>现在 GFS 预先知道了领袖的清点存款与变动存款的计划，想请你告诉他，每次清点存款时领袖有多少个账房可以供他选择，当然这个值可能非常大，GFS 只想知道对 $19961993$ 取模后的答案。</p>\n"},{"title":"# 输入格式","format":"html","require":["katex"],"content":"\n\n<p>第一行一个整数 $x$ 表示领袖清点和变动存款的总次数。</p>\n<p>接下来 $x$ 行，每行 $3$ 个整数 $a_i, b_i, c_i$。$a_i$ 为 $0$ 时表示该条记录是清点计划，领袖会清点 $b_i$ 到 $c_i$ 的银行存款，你需要对该条记录计算出 GFS 想要的答案。$a_i$ 为 $1$ 时表示该条记录是存款变动，你要把银行 $b_i$ 的存款改为 $c_i$，不需要对该记录进行计算。</p>\n"},{"title":"# 输出格式","format":"html","require":["katex"],"content":"\n\n<p>输出若干行，每行一个数，表示那些年的答案。</p>\n"},{"title":"# 样例一","format":"html","require":["katex"],"content":"\n\n<h4>input</h4>\n<pre>6\n0 1 3\n1 1 5\n0 1 3\n1 1 7\n0 1 3\n0 2 3\n\n</pre>\n\n<h4>output</h4>\n<pre>18\n24\n36\n6\n\n</pre>\n\n<h4>explanation</h4>\n<p>初始化每个国家存款都为 $3$;</p>\n<ul><li>$1$ 到 $3$ 的 $\\text{product}$ 为 $27$，$[1,27]$ 与 $27$ 不相冲的有 $18$ 个数;</li>\n<li>$1$ 的存款变为 $5$;</li>\n<li>$1$ 到 $3$ 的 $\\text{product}$ 为 $45$，$[1,45]$ 与 $45$ 不相冲的有 $24$ 个数;</li>\n<li>$1$ 的存款变为 $7$;</li>\n<li>$1$ 到 $3$ 的 $\\text{product}$ 为 $63$，$[1,63]$ 与 $63$ 不相冲的有 $36$ 个数;</li>\n<li>$2$ 到 $3$ 的 $\\text{product}$ 为 $9$，$[1,9]$ 与 $9$ 不相冲的有 $6$ 个数。</li>\n</ul>"},{"title":"# 限制与约定","format":"html","require":["katex"],"content":"\n\n<p>$20\\%$ 的数据满足: $x \\leq 10000$，当 $a_i = 0$ 时 $0 \\leq c_i − b_i \\leq 100$; 每个 $\\text{product} \\leq 10^{18}$;</p>\n<p>$30\\%$ 的数据满足：$x \\leq 50000$，当 $a_i = 0$ 时 $0 \\leq c_i − b_i \\leq 10000$;</p>\n<p>$50\\%$ 的数据满足：$x \\leq 100000$，当 $a_i = 0$ 时 $0 \\leq c_i − b_i \\leq 100000$;</p>\n<p>以上数据不重合，$20\\% +30\\% + 50\\% = 100\\%$，且保证满足题干要求。</p>\n<p><strong>时间限制：</strong>$1\\texttt{s}$</p>\n<p><strong>空间限制：</strong>$256\\texttt{MB}$</p>\n"},{"title":"# 来源","format":"html","require":["katex"],"content":"\n\n<p>中国国家队清华集训2014~2015 Day 1 - By 白云仁</p>\n"},{"title":"# 下载","format":"html","require":["katex"],"content":"\n\n<p><a href=\"/download.php?type=problem&amp;id=38\">样例数据下载</a></p>\n\n"}]}