{"title":"【ZJOI2019】麻将","time_limit":2000,"memory_limit":512,"url":"http://uoj.ac/problem/466","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n<p>九条可怜是一个热爱打麻将的女孩子。因此她出了一道和麻将相关的题目，希望这题不会让你对麻将的热爱消失殆尽。</p>\n<p><img class=\"img-responsive center-block\" src=\"//img.uoj.ac/utility/110.webp\" alt=\"110.webp\"/></p>\n<p>今天，可怜想要打麻将，但是她的朋友们都去下自走棋了，因此可怜只能自己一个人打。可怜找了一套特殊的麻将，它有 $n(n \\ge 5)$ 种不同的牌，大小分别为 $1$ 到 $n$，每种牌都有 $4$ 张。</p>\n<p>定义面子为三张大小相同或者大小相邻的麻将牌，即大小形如 $i, i, i(1 \\le i \\le n)$ 或者 $i, i + 1, i + 2(1 \\le i \\le n − 2)$。定义对子为两张大小相同的麻将牌，即大小形如 $i, i(1 \\le i \\le n)$。</p>\n<p>定义一个麻将牌集合 $S$ 是胡的当且仅当它的大小为 $14$ 且满足下面两个条件中的至少一个：</p>\n<ul><li>$S$ 可以被划分成五个集合 $S_1$ 至 $S_5$。其中 $S_1$ 为对子，$S_2$ 至 $S_5$ 为面子。</li>\n<li>$S$ 可以被划分成七个集合 $S_1$ 至 $S_7$，它们都是对子，且对应的大小<strong>两两不同</strong>。</li>\n</ul><p>举例来说，下列集合都是胡的（这儿只标记了大小）：</p>\n<ul><li>$\\{1, 1, 1, 1, 2, 3, 4, 5, 6, 7, 8, 9, 9, 9\\}$</li>\n<li>$\\{1, 1, 2, 2, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8\\}$</li>\n<li>$\\{1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7\\}$</li>\n</ul><p>而下列集合都不是胡的：</p>\n<ul><li>$\\{1, 1, 1, 2, 3, 4, 5, 6, 7, 8, 9, 9, 9\\}$</li>\n<li>$\\{1, 1, 1, 1, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8\\}$</li>\n<li>$\\{1, 1, 1, 2, 3, 4, 5, 6, 7, 8, 9, 9, 9, 11\\}$</li>\n</ul><p>可怜先摸出了 $13$ 张牌，并把剩下的 $4n-13$ 张牌随机打乱。打乱是等概率随机的，即所有 $(4n-13)!$ 种排列都等概率出现。</p>\n<p>对于一个排列 $P$，可怜定义 $S_i$ 为可怜事先摸出的 $13$ 张牌加上 $P$ 中的前 $i$ 张牌构成的集合，定义 $P$ 的权值为<strong>最小的$i$ 满足 $S_i$ 存在一个子集是胡的</strong>。如果你对麻将比较熟悉，不难发现 $P$ 的权值就是理论上的最早胡牌巡目数。注意到 $n \\geq 5$ 的时候，$S_{4n-13}$ 总是存在胡的子集的，因此 $P$ 的权值是良定义的。</p>\n<p>现在可怜想要训练自己的牌效，因此她希望你能先计算出 $P$ 的权值的期望是多少。</p>\n"},{"title":"输入格式","format":"html","require":["katex"],"content":"\n\n<p>第一行输入一个整数 $n$，表示这副特殊的麻将牌中的大小种类数。</p>\n<p>接下来输入 $13$ 行每行两个整数 $w,t(1 \\leq w \\leq n,1 \\leq t \\leq 4)$，表示可怜最开始摸出的第 $i$ 张牌是大小为 $w$ 的第 $t$ 张牌，保证 $(w,t)$ 二元组两两不同。</p>\n"},{"title":"输出格式","format":"html","require":["katex"],"content":"\n\n<p>输出一行一个整数，表示答案对 $998244353$ 取模后的值。即如果答案的最简分数表示为 $\\frac{x}{y}(x \\geq 0, y \\geq 1, \\gcd(x,y) = 1)$，你需要输出 $x \\times y^{-1} \\text{ mod } 998244353$。</p>\n"},{"title":"样例一","format":"html","require":["katex"],"content":"\n\n<h4>input</h4>\n<pre>9\n1 1\n1 2\n1 3\n2 1\n3 1\n4 1\n5 1\n6 1\n7 1\n8 1\n9 1\n9 2\n9 3\n</pre>\n\n<h4>output</h4>\n<pre>1\n</pre>\n\n<h4>explanation</h4>\n<p>上述牌型叫做纯正九莲宝灯，不难发现不管再加一张什么牌它都是胡的。所以对于所有排列 $P$，权值都是 $1$，因此权值的期望就是 $1$。</p>\n"},{"title":"样例二至样例三","format":"html","require":["katex"],"content":"\n\n<p>见样例数据下载。</p>\n"},{"title":"限制与约定","format":"html","require":["katex"],"content":"\n\n<p>对于 $20\\%$ 的数据，$n = 5$。</p>\n<p>对于 $50\\%$ 的数据，$n \\leq 13$。</p>\n<p>对于另外 $20\\%$ 的数据，$n \\leq 100, w_i=i, t_i = 1$。</p>\n<p>对于另外 $20\\%$ 的数据，$n \\leq 100, w_i = \\lceil \\frac{i}{4} \\rceil, t_i = i \\text{ mod }4 + 1$。</p>\n<p>对于 $100\\%$ 的数据， $5 \\leq n \\leq 100$。</p>\n<p><strong>时间限制</strong>：$2\\texttt{s}$</p>\n<p><strong>空间限制</strong>：$512\\texttt{MB}$</p>\n"},{"title":"下载","format":"html","require":["katex"],"content":"\n\n<p><a href=\"/download.php?type=problem&amp;id=466\">样例数据下载</a></p>\n\n"}]}