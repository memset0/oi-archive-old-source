{"title":"【UR #15】奥林匹克数据结构","time_limit":1000,"memory_limit":1024,"url":"http://uoj.ac/problem/227","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n<p>各位观众，各位观众，您现在收看的是第 666 届跳蚤奥运会的比赛现场。在刚刚的环城马拉松比赛中，天才跳高小将“最强跳蚤”靠着“最强跳蚤跳跳跳”和经验丰富的伏特跳蚤国王大战了三天三夜，最后战成 $233:233$ 平。考虑到迟迟不能决出胜者，比赛组委会决定临时更换比赛项目，而被选中的则是在跳蚤大陆流行已久的运动项目——维护数据结构。</p>\n<p>维护数据结构可是个大麻烦！首先我来介绍一下数据结构比赛的规则，你有一个长度为 $n$ 的<strong>排列</strong> $a$，比赛分为 $q$ 轮，第 $i$ 轮选手将会得到长度为 $m_i$ 的<strong>排列</strong> $b_i$，对于一个 $x$（$1 \\le x \\le n - m_i + 1$)，它被称为合法的仅当序列 $a_x, a_{x + 1}, \\cdots, a_{x + m_i - 1}$ 与序列 $b$ <strong>相似</strong>，现在你需要统计合法的 $x$ 的数量。</p>\n<p>两个序列长度为 $m$ 的序列 $u$ 和 $v$ 被称为<strong>相似</strong>的，当且仅当对于任意 $1 \\le i &lt; j \\le n$，要么 $u_i &lt; u_j, v_i &lt; v_j$，要么 $u_i &gt; u_j, v_i &gt; v_j$。</p>\n<p>你看，现在所有的序列都已经给出了，选手们已经开始着手计算了。这看上去将会是一场非常激烈的比赛啊。</p>\n<p>观众朋友们也可以和选手同台竞技，最早给出答案的观众可以获得小高铁一列哦。</p>\n"},{"title":"输入格式","format":"html","require":["katex"],"content":"\n\n<p>第一行一个只可能是 $0$ 或者 $1$ 的自然数 $\\mathrm{type}$，含义在下面解释。</p>\n<p>接下来一行一个正整数 $n, q$。</p>\n<p>接下来一行 $n$ 个正整数，表示排列 $a$。</p>\n<p>接下来 $q$ 行，其中第 $i$ 行的第一个整数为 $m_i$，接下来 $m_i$ 个正整数，表示排列 $b_i$。</p>\n<p><strong>注意给出的 $b_i$ 可能是经过加密的，如果 $\\mathrm{type} = 1$，那么假设上一个询问的答案为 $\\mathrm{ans}$（若为第一个询问则 $\\mathrm{ans} = 0$），则应该进行变换 $c_{i, (j + \\mathrm{ans} - 1) \\bmod m_i + 1} = b_{i, j}$ 得到 $c_i$ 并将 $c_i$ 作为这次的询问序列。</strong></p>\n"},{"title":"输出格式","format":"html","require":["katex"],"content":"\n\n<p>输出 $q$ 行，每行一个整数表示每个询问对应的合法的 $x$ 的数量。</p>\n"},{"title":"样例一","format":"html","require":["katex"],"content":"\n\n<h4>input</h4>\n<pre>1\n5 3\n1 5 2 4 3\n1 1\n2 2 1\n3 2 1 3\n\n</pre>\n\n<h4>output</h4>\n<pre>5\n2\n2\n\n</pre>\n\n<h4>explanation</h4>\n<p>实际上的三个询问序列分别是：\n\\begin{equation}\n\\{1\\}, \\{1, 2\\}, \\{1, 3, 2\\}\n\\end{equation}</p>\n<p>对于第一个询问，由于长度为 $1$，所有长度为 $1$ 的区间都和询问序列相似。</p>\n<p>对于后两个询问，$x$ 可以为 $1, 3$。</p>\n"},{"title":"样例二","format":"html","require":["katex"],"content":"\n\n<p>见样例数据下载。</p>\n"},{"title":"样例三","format":"html","require":["katex"],"content":"\n\n<p>见样例数据下载。</p>\n"},{"title":"限制与约定","format":"html","require":["katex"],"content":"\n\n<div class=\"table-responsive\">\n<table class=\"table table-bordered table-text-center table-vertical-middle\"><thead><tr><th>测试点编号</th>\n<th>$n$</th>\n<th>$q$</th>\n<th>$\\sum{m_i}$</th>\n<th>限制与约定</th>\n</tr></thead><tbody><tr><td>1</td><td rowspan=\"4\">$\\le 2000$</td><td rowspan=\"6\">$\\le 50$</td><td rowspan=\"4\">$\\le 10000$</td><td rowspan=\"12\">$\\mathrm{type} = 0$</td></tr><tr><td>2</td></tr><tr><td>3</td></tr><tr><td>4</td></tr><tr><td>5</td><td rowspan=\"8\">$\\le 100000$</td><td rowspan=\"8\">$\\le 500000$</td></tr><tr><td>6</td></tr><tr><td>7</td><td rowspan=\"14\">$\\le 500000$</td></tr><tr><td>8</td></tr><tr><td>9</td></tr><tr><td>10</td></tr><tr><td>11</td></tr><tr><td>12</td></tr><tr><td>13</td><td rowspan=\"8\">$\\le 100000$</td><td rowspan=\"8\">$\\le 500000$</td><td rowspan=\"4\">$m_i \\le 25$</td></tr><tr><td>14</td></tr><tr><td>15</td></tr><tr><td>16</td></tr><tr><td>17</td><td rowspan=\"4\">无</td>\n</tr><tr><td>18</td></tr><tr><td>19</td></tr><tr><td>20</td></tr></tbody></table></div>\n\n<p>在所有数据中，满足 $1 \\le n \\le 100000, \\sum{m_i} \\le 500000, 1 \\le m_i \\le n$, $a$ 和 $b_i$ 均为排列。</p>\n<p><strong>时间限制：</strong>$1\\texttt{s}$</p>\n<p><strong>空间限制：</strong>$1\\texttt{GB}$</p>\n"},{"title":"下载","format":"html","require":["katex"],"content":"\n\n<p><a href=\"/download.php?type=problem&amp;id=227\">样例数据下载</a></p>\n\n"}]}