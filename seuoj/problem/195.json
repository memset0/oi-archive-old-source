{"title":"引爆炸弹","time_limit":1000,"memory_limit":256,"url":"https://oj.seucpc.club/problem/195","statement":[{"title":"# 题目描述","format":"markdown","require":["katex"],"content":"\n众所周知，《Besiege》是一款中世纪攻城游戏。由于非常的硬核，许多技术不佳又脑洞太大的同学常常被人吐槽，大神玩的是《围攻》，自己玩的是《围观》。\r\n\r\n炸弹是《Besiege》中威力最强的武器，但是炸弹的触发却是一个概率事件。小 Q 在《公爵的堡垒》一关中，在 $n$ 个不同地点各设置了一颗炸弹，其中第 $i$ 颗炸弹自发爆炸的概率是 $P_i$。\r\n\r\n为了提高一部分炸弹爆炸的概率，小 Q 决定给每颗炸弹加上一根导火索，指向第 $TO_i$ 颗炸弹。也就是说当第 $i$ 颗炸弹爆炸时，会有 $Q_i$ 的概率引燃导火索，将第 $TO_i$ 颗炸弹引爆。\r\n\r\n分别求最终每一颗炸弹爆炸的概率。\n"},{"title":"# 输入格式","format":"markdown","require":["katex"],"content":"\n第一行一个整数 $n(2 \\leq n \\leq 10^5)$ 表示有炸弹数目。\r\n\r\n接下来 $n$ 行，每行两个整数 $x_i,\\ y_i(1 \\leq x_i < y_i \\leq 10^8)$，表示 $P_i = \\frac{x_i}{y_i}$。\r\n\r\n接下来一行 $n$ 个正整数 $TO_i(1 \\leq TO_i \\leq n，TO_i =\\not i)$，表示第i颗炸弹爆炸时有可能触发第 $TO_i$ 颗炸弹。\r\n\r\n接下来 $n$ 行，每行两个整数 $a_i,\\ b_i(1 \\leq a_i < b_i \\leq 10^8)$，表示 $Q_i = \\frac{x_i}{y_i}$。\n"},{"title":"# 输出格式","format":"markdown","require":["katex"],"content":"\n共一行，包含 $n$ 个整数。\r\n\r\n其中第 $i$ 个数表示第 $i$ 颗炸弹最终爆炸的概率。\r\n\r\n为防止精度误差，请将答案对 $10^9+7$ 取模。也就是说如果答案的最简分数形式为 $\\frac{X}Y$，请输出一个整数 $p$，要求满足 $0 \\leq p < 10^9+7$，且 $pY ≡ X (mod\\ 10^9+7)$。\n"},{"title":"# 样例","format":"markdown","require":["katex"],"content":"\n#### 样例输入1\r\n\r\n```plain\r\n3\r\n1 2\r\n1 2\r\n1 2\r\n2 3 1\r\n1 2\r\n1 2\r\n1 2\r\n```\r\n\r\n#### 样例输出1\r\n\r\n```plain\r\n906250007 906250007 906250007\r\n```\r\n\r\n#### 样例输入2\r\n\r\n```plain\r\n2\r\n1 2\r\n1 2\r\n2 1\r\n1 3\r\n2 3\r\n```\r\n\r\n#### 样例输出2\r\n\r\n```plain\r\n666666672 583333338\r\n```\r\n\r\n#### 样例解释2\r\n\r\n第一颗炸弹自发爆炸的概率是 $\\frac12$，没爆炸但被第二颗触发的概率是 $\\frac12 \\times \\frac12 \\times \\frac23$。\r\n\r\n所以，第一颗炸弹爆炸的概率是 $\\frac12 + \\frac12 \\times \\frac12 \\times \\frac23 = \\frac23$。\r\n\r\n第二颗炸弹爆炸的概率是 $\\frac12 + \\frac12 \\times \\frac12 \\times \\frac13 = \\frac7{12}$。\n"}]}