{"title":"Ginkgo Tree","time_limit":2000,"memory_limit":512,"url":"https://acm.uestc.edu.cn/problem/ginkgo-tree/description","statement":[{"title":"# Content","format":"markdown","require":["katex"],"content":"\nGinkgo attracts a huge number of visitors to come to the Park of Electronic Science and Technology of China, though it's a kind of REALLY smelly tree. Kanade takes the responsibility of managing the main ginkgo tree, making the tree beautiful but not malodorous.\n\nThe main ginkgo tree in PESTC, Shahe is quite weird. Kanade knows that the tree consists of $n$ nodes and $n-1$ edges. The root of the tree is node $1$. Each node has a beauty value, indicating its smelly level. When the beauty value of one node changes, all the nodes in its subtree whose  distance to the node is a Fibonacci number changes the same. Formally, if the beauty value of node $x$ adds $y$, all the nodes $z$ in the subtree of $x$ which $d(x,z)\\in f$ adds $y$. Where, $f$ refers to the set of Fibonacci numbers, $d(x,y)$ refers to the edge number of the shortest path from $x$ to $y$.\n\nSometimes Kanade will trim the tree, so she wants to know the sum of beauty value which holds $d(x,z)\\in f$, where $z$ is a node in the subtree of $x$. But Kanade think it a really troublesome work. She's not actually going to trim the trees.\n\nKanade is busy with writing the report of Machine Learning and Its Application. Please help her.\n"},{"title":"# Standard Input","format":"markdown","require":["katex"],"content":"\nThe first line of the input contains two integer $n,m$, indicating the number of nodes and query.\n\nThe second line contains $n$ integer $a_i$. The $i$ - th number indicates the beauty value of node $i$ at the beginning.\n\nThe third line contains $n-1$ integer $p_i$. The $i$ - th number indicates the parent of $i+1$.\n\nThe next $m$ lines, contains two or three integers, formatted as follows:\n\n- $\\texttt{1 x y}$: all the nodes in the subtree of $x$ which hold $d(x,i)\\in f$ adds y;\n- $\\texttt{2 x}$: output the sum of beauty value of the nodes in the subtree of $x$ which hold $d(x,i)\\in f$.\n"},{"title":"# Standard Output","format":"markdown","require":["katex"],"content":"\nFor all query of type $2$, output an integer in a line, indicating the answer.\n"},{"title":"# Samples","format":"markdown","require":["katex"],"content":"\n<style>\n        table,table tr th, table tr td { border:1px solid #0094ff; }\n        table { width: 200px; min-height: 25px; line-height: 25px; text-align: center; border-collapse: collapse;}   \n    </style>\n<table>\n\t<tr>\n\t\t<td>Input</td>\n\t\t<td>Output</td>\n\t</tr>\n<tr><td>6 5\n1 1 4 5 1 4\n5 2 1 4 2\n1 1 4\n2 1\n1 2 2\n1 5 -3\n2 4</td><td>24\n21</td></tr></table>\n\n"},{"title":"# Constraints","format":"markdown","require":["katex"],"content":"\n$2\\le n\\le 2\\times 10^5,1\\le m\\le 2\\times 10^5, 1\\le p_i,x\\le n,1\\le |a_i|,|y|\\le 10^6$, and the $p_i$ can construct a tree.\n"}]}