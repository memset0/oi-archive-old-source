{"title":"Food and Productivity","time_limit":1000,"memory_limit":64,"url":"https://acm.uestc.edu.cn/problem/food-and-productivity/description","statement":[{"title":"Content","format":"markdown","require":["katex"],"content":"\nIn the Game Civilization X, the world is made up of square-shaped `tiles`, forming a rectangle on the world map. For a tile located at row $X$ and column $Y$, we give it a coordinate, say ($X$, $Y$).\n\nAs you can see, different tiles have different `terrain-types`, so they may have different amount of Resources. In this problem, we only consider two of them: Food and Productivity.\n\nAn important step in the Game is building cities. After you choose a tile to build a city, the Food amount in that tile will increase by $A$, and the Productivity amount will increase by $B$, no other tiles will be changed.\n\nYou decide to build your first city on the map, as an experienced player, you will choose the best tile on the map, here is how you make up your mind:\n\nFor each tile ($X$, $Y$), you set up an `Influence Range` of that tile. Each tile ($x\\_i$, $y\\_i$) is said to be within the range if the following equation holds:\n$$max(\\left | X - x\\_i \\right |, \\left | Y - y\\_i \\right |) \\leq R$$\n\nAfter checking all the tiles within that range, you will get two values: the sum of all those tiles' Food amount, and the sum of all those tiles' Productivity. Among those two values, the final score for tile ($X$, $Y$) will be the smaller one. \n\nWhen choosing tiles, you just choose the tile with the highest score to build your city.\n\nYou are given a map with size $N\\times M$, and you wonder, for different values of $A$ and $B$, what is the highest score for your first city?\n"},{"title":"Standard Input","format":"markdown","require":["katex"],"content":"\nThe first line has a number $T$ ($T\\leq 10$) , indicating the number of test cases.\n\nFor each test case, first line has four numbers $N$, $M$, $R$ and $Q$ ($1 \\leq N$, $M \\leq 500$, $0\\leq 2\\times R + 1 \\leq min(N,M)$, $Q \\leq 200000$), which is the size of the map.\n\nThen come $N$ lines each with $M$ numbers, they are the original $Food$ ($0 < Food \\leq 3$) amount for each tile.\n\nThen come $N$ lines each with $M$ numbers, they are the original $Productivity$ ($0 < Productivity \\leq 3$) amount for each tile.\n\nThen come $Q$ lines each with two numbers $A$ and $B$ ($0 \\leq A$, $B\\leq 10^6$). Each is a query for you to answer. Those queries will not affect each other.\n"},{"title":"Standard Output","format":"markdown","require":["katex"],"content":"\nFor test case $X$, output `Case #X: ` first, in a single line.\n\nThen output $Q$ lines, each with an answer.\n\nThere should be a blank line **``BETWEEN``** each test case.\n"},{"title":"Samples","format":"markdown","require":["katex"],"content":"\n<style>\n        table,table tr th, table tr td { border:1px solid #0094ff; }\n        table { width: 200px; min-height: 25px; line-height: 25px; text-align: center; border-collapse: collapse;}   \n    </style>\n<table>\n\t<tr>\n\t\t<td>Input</td>\n\t\t<td>Output</td>\n\t</tr>\n<tr><td>1\n3 3 0 2\n1 2 1\n1 1 1\n1 1 1\n1 1 1\n1 2 1\n1 1 1\n1 2\n2 1</td><td>Case #1:\n3\n3</td></tr></table>\n\n"}]}