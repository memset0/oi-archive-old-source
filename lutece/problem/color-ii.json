{"title":"Color II","time_limit":1000,"memory_limit":64,"url":"https://acm.uestc.edu.cn/problem/color-ii/description","statement":[{"title":"# Content","format":"markdown","require":["katex"],"content":"\nZT loves to paint on papers. One day, he wants to paint every cell on the board whose size is $N \\times M$ with black and white. However, the painted board should meet this condition: for every $2 \\times 2$ block, there are exactly $W$ white cells and $4 - W$ black cells. To make this problem more interesting, some cells on board have already been colored. How many different boards can ZT paint?\n\nNote that two boards are different if at least one corresponding cell's color is different.\n"},{"title":"# Standard Input","format":"markdown","require":["katex"],"content":"\nThere are multiple test cases. The first line of the input will be an integer $T$ ($T\\leq 50$) indicating the number of test cases.\n\nFor each test case there are three integers $N$, $M$, $K$ ($2 \\leq N, M \\leq 100000$, $0 \\leq K \\leq 100000$) in a single line, representing the size of board and the number of colored cells. For the following $K$ lines, each line contains two integers $R\\_i$, $C\\_i$ and a character $S\\_i$. It means the cell in the $R\\_i^{th}$ row and $C\\_i^{th}$ column has been colored in $S\\_i$. $1 \\leq R\\_i \\leq N$, $1 \\leq C\\_i \\leq M$, $S\\_i$ is `W` or `B` indicating this cell is colored in white or black.\n"},{"title":"# Standard Output","format":"markdown","require":["katex"],"content":"\nFor each test case, print `Case #t: ` first, in which $t$ is the number of the test case starting from $1$. Then output five integers indicating the number of different colored boards when $W = 0, W = 1, W = 2, W = 3, W = 4$. The result should be modulo by $20120407$.\n"},{"title":"# Samples","format":"markdown","require":["katex"],"content":"\n<style>\n        table,table tr th, table tr td { border:1px solid #0094ff; }\n        table { width: 200px; min-height: 25px; line-height: 25px; text-align: center; border-collapse: collapse;}   \n    </style>\n<table>\n\t<tr>\n\t\t<td>Input</td>\n\t\t<td>Output</td>\n\t</tr>\n<tr><td>1\n3 3 2\n1 1 B\n2 2 W</td><td>Case #1: 0 1 4 3 0</td></tr></table>\n\n"},{"title":"# Note","format":"markdown","require":["katex"],"content":"\nThe first sample is like this\n```\nB..\n.W.\n...\n```\n"}]}