{"title":"The LCIS on the Tree","time_limit":2000,"memory_limit":64,"url":"https://acm.uestc.edu.cn/problem/the-lcis-on-the-tree/description","statement":[{"title":"Content","format":"markdown","require":["katex"],"content":"\nFor a sequence $S\\_1,S\\_2,\\cdots ,S\\_N$, and a pair of integers ($i$, $j$), if $1 \\leq i \\leq j \\leq N$ and $S\\_i < S\\_{i+1} < S\\_{i+2} <\\cdots < S\\_{j-1} < S\\_j$, then the sequence $S\\_i,S\\_{i+1},\\cdots ,S\\_j$ is a `CIS` (Continuous Increasing Subsequence). The longest `CIS` of a sequence is called the `LCIS` (Longest Continuous Increasing Subsequence).\n\nNow we consider a tree rooted at node $1$. Nodes have values. We have $Q$ queries, each with two nodes $u$ and $v$. You have to find the shortest path from $u$ to $v$. And write down each nodes' value on the path, from $u$ to $v$, inclusive. Then you will get a sequence, and please show us the length of its `LCIS`.\n"},{"title":"Standard Input","format":"markdown","require":["katex"],"content":"\nThe first line has a number $T$ ($T\\leq 10$) , indicating the number of test cases.\n\nFor each test case, the first line is a number $N$ ($N \\leq 10^5$), the number of nodes in the tree.\n\nThe second line comes with $N$ numbers $v\\_1,v\\_2,v\\_3\\cdots ,v\\_N$, describing the value of node $1$ to node $N$.  ($1 \\leq v\\_i \\leq 10^9$)\n\nThe third line comes with $N-1$ numbers $p\\_2,p\\_3,p\\_4\\cdots ,p\\_N$, describing the father nodes of node $2$ to node $N$. Node $1$ is the root and will have no father.\n\nThen comes a number $Q$, it is the number of queries. ($Q \\leq 10^5$)\n\nFor next $Q$ lines, each with two numbers $u$ and $v$. As described above.\n"},{"title":"Standard Output","format":"markdown","require":["katex"],"content":"\nFor test case $X$, output `Case #X: ` at the first line.\n\nThen output $Q$ lines, each with an answer to the query.\n\nThere should be a blank line **`BETWEEN`** each test case.\n"},{"title":"Samples","format":"markdown","require":["katex"],"content":"\n<style>\n        table,table tr th, table tr td { border:1px solid #0094ff; }\n        table { width: 200px; min-height: 25px; line-height: 25px; text-align: center; border-collapse: collapse;}   \n    </style>\n<table>\n\t<tr>\n\t\t<td>Input</td>\n\t\t<td>Output</td>\n\t</tr>\n<tr><td>1\n5\n1 2 3 4 5\n1 1 3 3\n3\n1 5\n4 5\n2 5</td><td>Case #1:\n3\n2\n3</td></tr></table>\n\n"}]}