{"title":"max air city","time_limit":3000,"memory_limit":64,"url":"https://acm.uestc.edu.cn/problem/max-air-city/description","statement":[{"title":"# Content","format":"markdown","require":["katex"],"content":"\nMAX AIR CITY is an illusory city.Matters every day in this bustling city is happening. MAX AIR CITY is made up of $n$ regions (conveniently numbered from $1$ to $n$) but unfortunately is connected by unidirectional roads, however, to overcome the shortages, there can be multiple roads between any two regions.\n\nToday, YAN leaves Tian all of a sudden because Tian has made a serious mistake. Tian is eager to find YAN. \n\nHe has to go to $L$ different regions to collect information in order to make a decision how should he take the next step.\n\nNow, Tian has a list which indicates the regions he will reach. But he is not sure the order of visiting. \n\nSo once he has got to a region, he has to return home to analyse the next place to go to. Be careful that it takes time \n$t[i]$ to prepare his leaving(such as have a meal,the call of nature). In other words, to travel from region $i$ to any other adjacent city $j$, preparation would cost him $t[i]$ of time to , and then time $w(i, j)$ on the road.\n\nTian wants to find YAN as soon as possible even any piece of message about her, so he wants to use the least time to collect information. Luckily ,you are a good programmer and he is eager to ask for your help to calculate the minimum time that it may take him to find his YAN.\n"},{"title":"# Standard Input","format":"markdown","require":["katex"],"content":"\nThe first line of the input contains an integer $T$ indicating the number of cases.\n\nEach case contains $M+3$ lines. The first line contains $4$ integers $N$ $M$ $S$ $L$ separated by blank. $N$ ($2\\leq N\\leq 50000$) \nis the number of regions. $M$ ($1\\leq M\\leq 500000$) is the number of roads. $S$ indicates which region Tian’s home is in. \n\n$L$ is number of regions that Tian has to reach. The second line is $L$ integers indicating the number of these regions. \n\nThen a line with $N$ integers indicating the time that must be cost to prepare $t[i]$ ($0\\leq t[i]\\leq 10^9$) .\n \nThe following $M$ lines each contains $3$ integers $u$ $v$ $w$ separated by a blank indicate that there is a road from $u$ to $v$, \nand it would cost time $w$. \n\nAll data will fit in a $64$-bit integer.\n"},{"title":"# Standard Output","format":"markdown","require":["katex"],"content":"\nFor each test case, output one line with an integer indicating the minimum time. Note that if Tian can’t \nvisit all the regions or he can’t return home after any visiting, then output “Tumblerful” (without quotation).\n"},{"title":"# Samples","format":"markdown","require":["katex"],"content":"\n<style>\n        table,table tr th, table tr td { border:1px solid #0094ff; }\n        table { width: 200px; min-height: 25px; line-height: 25px; text-align: center; border-collapse: collapse;}   \n    </style>\n<table>\n\t<tr>\n\t\t<td>Input</td>\n\t\t<td>Output</td>\n\t</tr>\n<tr><td>2\n3 4 1 2\n2 3\n5 5 5\n1 2 3\n2 3 5\n3 1 7\n1 3 4\n2 1 1 1\n2\n2 3\n1 2 3</td><td>51\nTumblerful</td></tr></table>\n\n"},{"title":"# Note","format":"markdown","require":["katex"],"content":"\n1. For the first case, Tian begins from his home at region $1$, spend $5$ minutes to prepare. Then spend $3$ minutes \non the road from region $1$ to region $2$.Then he finished visiting and return ,spend $5$ minutes in region $2$ to prepare, \nvia road $2\\rightarrow 3$ get to region $3$ and spend $5$ minutes for preparation. Via road $3\\rightarrow 1$ he return home. The next place \nis region $3$. So he started at region $1$ spending $5$ minutes to prepare and then via road $1\\rightarrow 3\\rightarrow 1$ to finish his work \nof collecting information. The total time is $(5)+3+(5)+5+(5)+7+(5)+4+(5)+7=51$,the number in the brackets indicate the time for preparation.\n2. Huge input datas , scanf is recommended.\n"}]}