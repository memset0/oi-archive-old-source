{"title":"Fish orz","time_limit":2000,"memory_limit":256,"url":"https://acm.uestc.edu.cn/problem/fish-orz/description","statement":[{"title":"Content","format":"markdown","require":["katex"],"content":"\nAlice is given a tree, in which each edge has a length and each node has a color either white or black. A tree is a graph in which there are exactly $n - 1$ edges and it is possible to go from any node to any other node by following some sequence of edges. \n\nFor convenience, the edges are labeled from $1$ to $n - 1$, and the nodes are labeled from $1$ to $n$.\n\nNow Alice is asked to make $m$ operations on the tree. There are three different kinds of operations.\n```\n0 k x : change the length of the k-th edge to x.\n1 u : change the color of node u.\n2 u : query the minimum distance between node u and a black node.\n```\nAs is known to everyone of you, Bob loves Alice very much. Could you tell Bob the answers to help Bob leave a good impression on Alice.\n"},{"title":"Standard Input","format":"markdown","require":["katex"],"content":"\nThe first line contains a single integer $n$, indicating the number of nodes in the tree.\n\nThere are $n$ integers in the second line. The $i\\_{th}$ integer $c\\_i$ denotes the initial colour of the node $i$. $0$ is white, and $1$ is black.\n\nEach of the following $n - 1$ lines contains $3$ integers $a\\_i, b\\_i$ and $c\\_i$, which denotes an edge between $a\\_i$ and $b\\_i$, and the length is $c\\_i$.\n\nThe following line contains a single integer $m$, indicating the number of operations.\n\nThen $m$ lines is following. There are three different kinds of operations.\n```\n0 k x : change the length of the k-th edge to x.\n1 u : change the color of node u.\n2 u : query the minimum distance between node u and a black node.\n```\nIt is guaranteed that $1 \\leq n, m \\leq 100000, 1 \\leq k < n, 1 \\leq x \\leq 10000, 1 \\leq u \\leq n$.\n"},{"title":"Standard Output","format":"markdown","require":["katex"],"content":"\nFor each query operation $2$ $u$, output the answer in one line. \n\nNote that : if $u$ is a black node, the answer is $0$. if there is no black node in the tree, print `-1` instead.\n"},{"title":"Samples","format":"markdown","require":["katex"],"content":"\n<style>\n        table,table tr th, table tr td { border:1px solid #0094ff; }\n        table { width: 200px; min-height: 25px; line-height: 25px; text-align: center; border-collapse: collapse;}   \n    </style>\n<table>\n\t<tr>\n\t\t<td>Input</td>\n\t\t<td>Output</td>\n\t</tr>\n<tr><td>5\n1 0 1 0 1\n1 2 3 \n1 3 4\n2 4 5\n2 5 6\n9\n2 2\n2 4\n1 1\n2 4\n0 2 10\n2 1\n1 5\n1 3\n2 1</td><td>3\n8\n11\n9\n-1</td></tr></table>\n\n"}]}