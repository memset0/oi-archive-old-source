{"title":"第五章：熊的力量","time_limit":300,"memory_limit":512,"url":"https://acm.uestc.edu.cn/problem/di-wu-zhang-xiong-de-li-liang/description","statement":[{"title":"Content","format":"markdown","require":["katex"],"content":"\n[上一集](https://acm.uestc.edu.cn/problem/di-si-zhang-bu-yao-ting-xia-lai-a/description)\n"},{"title":"第五章：熊的力量","format":"markdown","require":["katex"],"content":"\n「咳。。。。」詹皇看了看旁边已然昏迷的兔和马。\n\n「不打了不打了，打不过你。」詹皇笑了笑，「你不是就只是想要那个小舔狗吗？我也没杀了他，还给你吧。」詹皇手轻挥，空间骤然开始波动。其中出现了一道深不见底的裂缝，而狗的一只手漏了出来。\n\n糖立马顾不得自己现在的狼狈样子，抓住了狗的手。\n\n「**这次，我不会再让你离开我。**」\n\n![OIP.jpg](/source/lutece/di-wu-zhang-xiong-de-li-liang/img/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMjAvMDYvMDQvdEliTXJMZTdtaFNEUk80LmpwZw==.jpg)\n\n詹皇微笑着坐在地上，开始讲起了自己以前的故事。\n\n「曾经，我也是一个纯真的少年，心里只想着在区域码力大会上取得好成绩。。。」\n\n![pic](/source/lutece/di-wu-zhang-xiong-de-li-liang/img/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMTEvMTcvVnNvSVd5VVpSQk9TdDU2LmpwZw==.jpg)\n\n「但是，经过某些事情之后。。。。我黑化了。。。。」（指头像黑化）\n\n![收到.png](/source/lutece/di-wu-zhang-xiong-de-li-liang/img/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMjAvMDYvMDQvOXBxOEtJZWNnNWZhRXdyLnBuZw==.png)\n\n「甚至活成了我曾经最讨厌的样子」\n\n![不准.png](/source/lutece/di-wu-zhang-xiong-de-li-liang/img/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMjAvMDYvMDQveHpQcE1pNEpLSXFHdHZRLnBuZw==.png)\n\n「但是我在你的身上看到了希望。去吧，去监狱的深处。找到把守最后一关的 forgottencsc ，我们尊称他为熊。你只有打败他，才有可能达成你的目的。」\n\n![熊.png](/source/lutece/di-wu-zhang-xiong-de-li-liang/img/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMjAvMDYvMDQvOWRhclQ3SHp1UDZRMXRZLnBuZw==.png)\n\n「我只说这么多了。。。成败与否看你自己了。我在你身上看到了我当年的影子。这几个人就由我来照顾吧。」詹皇看向糖，一幅欣然的表情。\n\n虽然糖仍然不是很相信詹皇，但是之前的结果是狗确实还好好的活着，想必詹皇并没有理由结束狗的性命。眼下唯一的选择是自己一个人去挑战熊。\n\n「我知道了，我会在救出人之后就回来找你。」\n\n----\n\n金色的码力，糖第一次看到这样澄澈的码力。但是，自己的码力也不会输。\n\n「你不应该想着要把他放出来。你绝对会后悔的。我[当年](https://acm.uestc.edu.cn/contest/27/summary)曾经独步天下，现在却只是在这守门，就是为了守住他。」 熊目视着糖，眼神平静。\n\n糖没有说话，只是兀自运起了码力。\n\n「好吧，我这么多年打退了这么多人，你也会是下一个。看你这样子也是略懂字符串。 你应该也知道 AC自动机是离线算法，那么我今天就要让他在线一回！」 熊变换双手，手中竟然出现了一个集合。集合中的字符井然有序，排列成了字符串的形状。\n\n只见那集合中的字符串进进出出，字符看似乱码，却好像又有某种规律。\n\n「听好了！我现在要你维护一个集合，支持插入和删除。」 熊大声呵斥。\n\n糖一听，便心里有了个打底的想法。\n\n「看你这样子，大概已经想到如何离线了吧。但是，今天我便要把他加密。」\n\n「加密？」糖惊讶地说。\n\n熊冷笑了一下：「我今天就要强制在线。对于每一次输入的字符串 $s$ 必须进行以下处理：」\n\n```c++\nint n = strlen(s);\nfor( int i = 0 ; i < n ; i++ )\n{\n    s[i] = (( s[i] - 'a' ) + lastans * i % 26 ) % 26 + 'a';\n}\n```\n\n其中变量 $lastans$ 为上次询问 3 的答案， $lastans$ 在最初的时候应该为 $0$。\n\n维护一个字符串多重集，支持三种操作：\n1.插入**一个**字符串\n2.删除**一个**字符串\n3.给出一个待匹配串，询问对于多重集内所有元素，所有的元素在待匹配串中匹配次数乘元素串长的和。\n\n糖一听，便有了打算。\n"},{"title":"Standard Input","format":"markdown","require":["katex"],"content":"\n第一行有 $1$ 个数 $n$ ，代表接下来输入的字符串数量。\n第二行到第 $n+1$ 行，每行先输入一个数 $op$ ，代表操作种类。接下来输入一个字符串 $s$。\n"},{"title":"Standard Output","format":"markdown","require":["katex"],"content":"\n对于每个询问 3 输出一行一个数代表答案对 $10^9+7$ 取模之后的值。\n"},{"title":"Samples","format":"markdown","require":["katex"],"content":"\n<style>\n        table,table tr th, table tr td { border:1px solid #0094ff; }\n        table { width: 200px; min-height: 25px; line-height: 25px; text-align: center; border-collapse: collapse;}   \n    </style>\n<table>\n\t<tr>\n\t\t<td>Input</td>\n\t\t<td>Output</td>\n\t</tr>\n<tr><td>7\n1 ab\n1 abb\n1 aabb\n3 aabb\n2 arja\n2 asj\n3 asiar\n</td><td>9\n4\n</td></tr><tr><td>10\n1 sugar\n1 sugari\n1 sugarii\n1 sugariii\n1 sugariv\n3 sugariiisugari\n2 sjktz\n1 sjktzf\n1 sjktzf\n3 sjktzfuty\n</td><td>37\n25\n</td></tr></table>\n\n"},{"title":"Constraints","format":"markdown","require":["katex"],"content":"\n$n\\leq 3\\times10^5,\\sum |s| \\leq 3\\times10^5$\n输入保证对于每个操作 $2$ ，在多重集中至少存在一个相同的字符串 $s$ 。\n"},{"title":"Note","format":"markdown","require":["katex"],"content":"\n第一个样例的原输入为：\n7\n1 ab\n1 abb\n1 aabb\n3 aabb\n2 aabb\n2 abb\n3 ababb\n\n第二个样例的原输入为：\n10\n1 sugar\n1 sugari\n1 sugarii\n1 sugariii\n1 sugariv\n3 sugariiisugari\n2 sugar\n1 sugari\n1 sugari\n3 sugariisi\n"}]}