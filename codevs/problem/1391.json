{"title":"伊吹萃香","time_limit":1000,"memory_limit":125,"url":"http://www.joyoi.cn/problem/codevs-1391","statement":[{"title":"","format":"html_final","require":["katex"],"content":"\n<div class=\"panel panel-default\">\n<div class=\"area-title\">\n<span>\n题目描述\n<small>Description</small>\n</span></div>\n<div class=\"panel-body\">\n\n<p>在幻想乡，伊吹萃香是能够控制物体密度的鬼王。因为能够控制密度，所以萃香能够制造白洞和黑洞，并可以随时改变它们。某一天萃香闲着无聊，在妖怪之山上设置了一些白洞或黑洞，由于引力的影响，给妖怪们带来了很大的麻烦。于是他们决定找出一条消耗体力最少的路，来方便进出。已知妖怪之山上有N个路口(编号1..N)，每个路口都被萃香设置了一定质量白洞或者黑洞。原本在各个路口之间有M条单向路，走过每一条路需要消耗一定量的体力以及1个单位的时间。由于白洞和黑洞的存在，走过每条路需要消耗的体力也就产生了变化，假设一条道路两端路口黑白洞的质量差为delta：</p>\n<p>1. 从有白洞的路口走向有黑洞的路口，消耗的体力值减少delta，若该条路径消耗的体力值变为负数的话，取为0。</p>\n<p>2. 从有黑洞的路口走向有白洞的路口，消耗的体力值增加delta。</p>\n<p>3. 如果路口两端均为白洞或黑洞，消耗的体力值无变化。</p>\n<p>由于光是放置黑洞白洞不足以体现萃香的强大，所以她决定每过1个单位时间，就把所有路口的白洞改成黑洞，黑洞改成白洞。当然在走的过程中你可以选择在一个路口上停留1个单位的时间，如果当前路口为白洞，则不消耗体力，否则消耗s[i]的体力。现在请你计算从路口1走到路口N最小的体力消耗。保证一定存在道路从路口1到路口N。</p>\n\n</div>\n</div>\n\n<div class=\"panel panel-default\">\n<div class=\"area-title\">\n<span>\n输入描述\n<small>Input Description</small>\n</span></div>\n<div class=\"panel-body\">\n<p>第1行：2个正整数N, M</p>\n<p>第2行：N个整数，第i个数为0表示第i个路口开始时为白洞，1表示黑洞</p>\n<p>第3行：N个整数，第i个数表示第i个路口设置的白洞或黑洞的质量w[i]</p>\n<p>第4行：N个整数，第i个数表示在第i个路口停留消耗的体力s[i]</p>\n<p>第5..M+4行：每行3个整数，u, v, k，表示在没有影响的情况下，从路口u走到路口v需要消耗k的体力。</p>\n\n</div>\n</div>\n<div  class=\"panel panel-default\">\n<div class=\"area-title\">\n<span>\n输出描述\n<small>Output Description</small>\n</span></div>\n<div class=\"panel-body\">\n\n<p>第1行：1个整数，表示消耗的最小体力</p>\n\n</div>\n</div>\n\n\n<div class=\"panel panel-default\">\n<div class=\"area-title\">\n<span>\n样例输入\n<small>Sample Input</small>\n</span></div>\n<div class=\"panel-body\">\n<p>4 5</p>\n<p>1 0 1 0</p>\n<p>10 10 100 10</p>\n<p>5 20 15 10</p>\n<p>1 2 30</p>\n<p>2 3 40</p>\n<p>1 3 20</p>\n<p>1 4 200</p>\n<p>3 4 200</p>\n\n</div>\n</div>\n\n<div class=\"panel panel-default\">\n<div class=\"area-title\">\n<span>\n样例输出\n<small>Sample Output</small>\n</span></div>\n<div class=\"panel-body\">\n<p>130</p>\n\n</div>\n</div>\n\n<div class=\"panel panel-default\">\n<div class=\"area-title\">\n<span>\n数据范围及提示\n<small>Data Size & Hint</small>\n</span></div>\n<div class=\"panel-body\">\n<p>对于30%的数据：1 &lt;= N &lt;= 100, 1 &lt;= M &lt;= 500</p>\n<p>对于60%的数据：1 &lt;= N &lt;= 1,000, 1 &lt;= M &lt;= 5,000</p>\n<p>对于100%的数据：1 &lt;= N &lt;= 5,000, 1 &lt;= M &lt;= 30,000</p>\n<p>其中20%的数据为1 &lt;= N &lt;= 3000的链</p>\n<p>1 &lt;= u,v &lt;= N, 1 &lt;= k,w[i],s[i] &lt;= 200</p>\n<p>按照1 -&gt; 3 -&gt; 4的路线。</p>\n</div>\n</div>\n"}]}