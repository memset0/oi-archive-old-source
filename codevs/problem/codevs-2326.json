{"title":"洗牌","time_limit":1000,"memory_limit":125,"url":"http://www.joyoi.cn/problem/codevs-2326","statement":[{"title":"","format":"html_final","require":["katex"],"content":"\n<div class=\"panel panel-default\">\n<div class=\"area-title\">\n<span>\n题目描述\n<small>Description</small>\n</span></div>\n<div class=\"panel-body\">\n\n<p>小春最近很清闲，面对书桌上的 N 张牌，他决定给每张牌染色。目前小春只有 3 种颜色：红色(r)，蓝色(b)，绿色(g)。他询问 Sun有多少种染色方案， Sun很快给出答案。进一步，小春要求染出 Sr张红色，Sb张蓝色，Sg张绿色，他又询问有多少种方案，Sun稍微想了一会儿又给出正确答案。 <br>最后小春发明了 m种不同的洗牌法，这里他又问 Sun有多少种不同的染色方法。两种染色方法相同当且仅当其中一种可以通过任意的洗牌法（即，可以使用多种洗牌法，而每种方法可以使用多次）洗成另一种。Sun 发现这个问题有点难度，决定交给你。答案可能很大，只需求出答案除以 p 的余数（p 为质数）。</p>\n\n</div>\n</div>\n\n<div class=\"panel panel-default\">\n<div class=\"area-title\">\n<span>\n输入描述\n<small>Input Description</small>\n</span></div>\n<div class=\"panel-body\">\n<p>第一行输入 5 个整数：Sr,Sb,Sg,m,p(m&lt;=60,m+1&lt;p&lt;100)。n=Sr+Sb+Sg。接下来 m 行，每行描述一种洗牌法，每行有 n 个用空格隔开的整数 X1X2...Xn，恰为 1 到 n 的一个排列，表示使用这种洗牌法，第 i位变为原来的 Xi位的牌。输入数据保证任意多次洗牌都可用这 m种洗牌法中的一种代替，且对每种洗牌法，都存在一种洗牌法使得能回到原状态。 <br><br></p>\n\n</div>\n</div>\n<div  class=\"panel panel-default\">\n<div class=\"area-title\">\n<span>\n输出描述\n<small>Output Description</small>\n</span></div>\n<div class=\"panel-body\">\n\n<p>不同的染法总数除以 p的余数。</p>\n\n</div>\n</div>\n\n\n<div class=\"panel panel-default\">\n<div class=\"area-title\">\n<span>\n样例输入\n<small>Sample Input</small>\n</span></div>\n<div class=\"panel-body\">\n<p>1 1 1 2 7 </p>\n<p>2 3 1 <br>3 1 2</p>\n\n</div>\n</div>\n\n<div class=\"panel panel-default\">\n<div class=\"area-title\">\n<span>\n样例输出\n<small>Sample Output</small>\n</span></div>\n<div class=\"panel-body\">\n<p>2 </p>\n\n</div>\n</div>\n\n<div class=\"panel panel-default\">\n<div class=\"area-title\">\n<span>\n数据范围及提示\n<small>Data Size & Hint</small>\n</span></div>\n<div class=\"panel-body\">\n<p>20%数据满足 Sr+Sb+Sg&lt;=20；100%数据满足 Max{Sr,Sb,Sg}&lt;=20。</p>\n</div>\n</div>\n"}]}