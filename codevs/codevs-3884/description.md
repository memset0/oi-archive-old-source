<div class="panel panel-default">
<div class="area-title">
<span>
题目描述
<small>Description</small>
</span></div>
<div class="panel-body">

<p>      每天HR都会随机宠幸自己的妹纸，当然，HR为了不选到一些他不喜欢的妹纸，他决定把随机和选择结合在一起。</p><p>      HR会评出妹子的萌值，颜值，粘人值，以此来评出愉悦值，HR那超越常人的思想认为愉悦值=萌值的颜值次方mod(或者%)粘人值。然后随机选择一段区间，在这段区间里找出愉悦值最高的妹纸来宠幸。</p><p>      他找到了你这个单身狗，并说只要你帮他找出来，他就给你介绍一个妹纸。</p>

</div>
</div>

<div class="panel panel-default">
<div class="area-title">
<span>
输入描述
<small>Input Description</small>
</span></div>
<div class="panel-body">
<p>第1行一个整数n，表示有后宫妹纸（n&lt;=500000，卧槽好多）</p><p>第2到n+1行有a,b,c（b&lt;=100000）三个整数，代表妹纸的萌值，颜值和粘人值。</p><p>第n+2行有一个整数m（m&lt;=1000000）</p><p>第n+3到n+m+3行每行两个整数l,r代表两个区间。</p>

</div>
</div>
<div  class="panel panel-default">
<div class="area-title">
<span>
输出描述
<small>Output Description</small>
</span></div>
<div class="panel-body">

<p>m行每行一个整数，代表HR要宠幸的妹纸的愉悦值。</p>

</div>
</div>


<div class="panel panel-default">
<div class="area-title">
<span>
样例输入
<small>Sample Input</small>
</span></div>
<div class="panel-body">
<p>5<br></p><p>1 2 3</p><p>2 3 4</p><p>3 4 5</p><p>4 5 6</p><p>5 6 7</p><p>3</p><p>1 3</p><p>1 4</p><p>2 5</p><p><br></p><p><br></p><p><br></p>

</div>
</div>

<div class="panel panel-default">
<div class="area-title">
<span>
样例输出
<small>Sample Output</small>
</span></div>
<div class="panel-body">
<p>1<br></p><p>4</p><p>4</p>

</div>
</div>

<div class="panel panel-default">
<div class="area-title">
<span>
数据范围及提示
<small>Data Size & Hint</small>
</span></div>
<div class="panel-body">
<p>数据炒鸡大哟<br></p>
</div>
</div>