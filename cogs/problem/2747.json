{"title":"凯伦和超市","time_limit":2000,"memory_limit":512,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vyyxyVWqW","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n在回家的路上，凯伦决定停在超市买些杂货。\n</p>\n<p>\n她需要买很多商品，但由于她是学生，她的预算还是相当有限的。其实她只能花最高b美元。\n</p>\n<p>\n超市里有n种商品，第i种商品价格为c[i]美元。当然，每种商品只能买一次。最近，超市一直在努力增加业务，作为忠实客户的凯伦，获得了n张优惠券，如果凯伦买了第i件商品，她可以用第i张优惠券来降低d[i]的价格。当然，如果不买相应的商品就无法使用优惠券。\n</p>\n<p>\n然而，优惠券有一定限制：对于所有i≥2，为了使用第i张优惠券，凯伦也必须使用第xi张优惠券（这可能意味着使用更多的优惠券来满足该优惠券的要求）。凯伦想知道，用她的钱最多可以买多少商品。\n</p>\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n第一行输入包含两个整数n和b（1≤n≤5000,1≤b≤10^9），商店中的货物数量和凯伦的钱数。\n</p>\n<p>\n接下来的n行描述以下项：\n</p>\n<p>\n其中第i行开始是两个整数分别为次c[i]和d[i](1&lt;=d[i]&lt;c[i]&lt;=10^9)，表示第i个商品的价钱和用第i张优惠券买这个商品可以减少的价钱，如果i&gt;=2，接下来是另一个整数x[i](1&lt;=x[i]&lt;i)，表示第x[i]张优惠券应该先被使用。\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n输出一行，一个整数，即凯伦能买到的最大的商品数。\n</p>\n<h3>\n【样例1】\n</h3>\n<pre><p>\ninput\n</p>\n\n<p>\n6 16\n</p>\n\n<p>\n10 9\n</p>\n\n<p>\n10 5 1\n</p>\n\n<p>\n12 2 1\n</p>\n\n<p>\n20 18 3\n</p>\n\n<p>\n10 2 3\n</p>\n\n<p>\n2 1 5\n</p>\n\n<p>\noutput\n</p>\n\n<p>\n4\n</p>\n</pre>\n<h3>\n【样例2】\n</h3>\n<pre><p>\ninput\n</p>\n\n<p>\n5 10\n</p>\n\n<p>\n3 1\n</p>\n\n<p>\n3 1 1\n</p>\n\n<p>\n3 1 2\n</p>\n\n<p>\n3 1 3\n</p>\n\n<p>\n3 1 4\n</p>\n\n<p>\noutput\n</p>\n\n<p>\n5\n</p>\n</pre>\n<h3>\n【提示】\n</h3>\n<p>\n在此键入。\n</p>\n<h3>\n【来源】\n</h3>\n<p>\n在此键入。\n</p>\n\n"}]}