{"title":"[HZOI 2015] 质数序列 PrimeSeq","time_limit":3000,"memory_limit":512,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vyiXQVkak","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n给出一个长度为n序列,维护一种操作和查询,若操作为Modify x y,则将在x位置上的数乘y,若为Query l r p,则输出l到r区间全部数的乘积中个小于等于p的质因子的幂次之和,如l到r的乘积为24,即为2^3*3^1,若p=1,则结果为0,若p=2,则结果为3.\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n第一行两个数n,m分别为序列的长度和操作的次数,接下来1行,n个数为初始序列的每个数,接下来m行,若操作为Modify,则后有两个数x,y,若为Query,则后面有三个数l,r,q.\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n对应所有的Query操作,输出对应的结果,每行一个.\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre><p>\n3 2\n</p>\n\n<p>\n24 24 3\n</p>\n\n<p>\nModify 3 8\n</p>\n\n<p>\nQuery 1 3 2\n</p>\n</pre>\n<h3>\n【样例输出】\n</h3>\n<pre>9</pre>\n<h3>\n【提示】\n</h3>\n<p>\n样例说明:\n</p>\n<p>\n 对第三个数乘8后为24,1到3的乘积分解质因数为2^9*3^3,那么小于等于2的质因子只有2,幂次为9故结果为9.\n</p>\n<p>\n数据范围约定:\n</p>\n<p>\n 对于20%的数据,n&lt;=10,m&lt;=10,询问的乘积不会超过10^5.\n</p>\n<p>\n 对于另外40%的数据,n&lt;=100000,m&lt;=50000,询问的乘积不会超过64位整形.\n</p>\n<p>\n 对于剩余的数据,n&lt;=100000,m&lt;=200000,询问的乘积不会超过10^10000\n</p>\n<p>\n 对于全部数据保证不会出现超过400的质因子.\n</p>\n<h3>\n【来源】\n</h3>\n<p>\nby stdafx\n</p>\n\n"}]}