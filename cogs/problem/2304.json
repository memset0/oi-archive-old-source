{"title":"[HZOI 2015]简单的最近公共祖先","time_limit":2000,"memory_limit":256,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vxzSxVjaq","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<p>\n题目描述：\n</p>\n<p>\n给定一棵有根树，树根为1\n</p>\n<p>\n一开始树上所有节点都是白色的，要求你维护以下操作：\n</p>\n<p>\n1、C 将树上所有黑色节点变成白色\n</p>\n<p>\n2、M u 将u节点染黑\n</p>\n<p>\n3、Q u 查询u和所有黑色节点的所有LCA的深度最大的点的编号\n</p>\n<p>\nLCA定义为两个点的最近公共祖先\n</p>\n<p>\n<br/>\n</p>\n<p>\n输入格式：\n</p>\n<p>\n第一行输入n，m表示节点总数和操作总数\n</p>\n<p>\n以下n-1行每行u，v描述树上的一条边的两个端点\n</p>\n<p>\n以下m行每行描述一个询问如题所示\n</p>\n<p>\nn,m&lt;=2000000\n</p>\n<p>\n<br/>\n</p>\n<p>\n输出格式：\n</p>\n<p>\n对于每个Q询问输出相应的答案\n</p>\n<p>\n如果没有LCA的话输出-1\n</p>\n<p>\n<br/>\n</p>\n<p>\n输入样例：\n</p>\n<p>\n<br/>\n</p>\n<p>\n10 10\n</p>\n<p>\n1 2\n</p>\n<p>\n1 3\n</p>\n<p>\n2 4\n</p>\n<p>\n3 5\n</p>\n<p>\n4 6\n</p>\n<p>\n3 7\n</p>\n<p>\n4 8\n</p>\n<p>\n7 9\n</p>\n<p>\n8 10\n</p>\n<p>\nM 9\n</p>\n<p>\nM 9\n</p>\n<p>\nM 6\n</p>\n<p>\nQ 10\n</p>\n<p>\nQ 5\n</p>\n<p>\nM 9\n</p>\n<p>\nC\n</p>\n<p>\nQ 6\n</p>\n<p>\nM 4\n</p>\n<p>\nM 5\n</p>\n<p>\n<br/>\n</p>\n<p>\n输出样例：\n</p>\n<p>\n4\n</p>\n<p>\n3\n</p>\n<p>\n-1\n</p>\n<p>\n<br/>\n</p>\n<p>\n提示：\n</p>\n<p>\n注意输入数据较大，推荐使用读入优化\n</p>\n<p>\n由于cojs评测机的问题，可能会爆栈，所以请在main函数的开头加入如下程序：\n</p>\n<p>\n<br/>\n</p>\n<p>\nint __size__=128&lt;&lt;20;\n</p>\n<p>\nchar *__p__=(char*)malloc(__size__)+__size__;\n</p>\n<p>\n__asm__(&#34;movl %0, %%esp\\n&#34;::&#34;r&#34;(__p__));\n</p>\n<p>\n注意上述代码会占用你128MB的空间，请自行修改，测试数据大约开到70MB就可以了\n</p>\n<p>\n本题开了标程两倍的时限，而且是黑白树系列的某道题的加强版，原做法是难以通过的\n</p>\n<p>\n本题的做法是本人自己想出来的，如果有更好的做法，欢迎与我联系\n</p>\n<p>\n本来想强制在线的，但是为了更好的算法的出现就没有强制 强制在线\n</p>\n\n"}]}