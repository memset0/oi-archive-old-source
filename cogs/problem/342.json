{"title":"[NOI2006] 网络收费","time_limit":3000,"memory_limit":128,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=pxQQmzjqV","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【问题描述】\n</h3>\n<p>\n网络已经成为当今世界不可或缺的一部分。每天都有数以亿计的人使用网络进行学习、科研、娱乐等活动。然而，不可忽视的一点就是网络本身有着 庞大的运行费用。所以，向使用网络的人进行适当的收费是必须的，也是合理的。 MY 市NS 中学就有着这样一个教育网络。网络中的用户一共有2^N 个，编号依次为1, 2, 3, …, 2^N。这些用户之间是用路由点和网线组成的。用户、路由点与网线共同构成一个满二叉树结构。树中的每一个叶子结点都是一个用户，每一个非叶子结点（灰 色）都是一个路由点，而每一条边都是一条网线（见下图，用户结点中的数字为其编号）。\n</p>\n<p>\n<img height=\"304\" alt=\"Image:Networkcost1.png\" width=\"533\" src=\"../../../../mw/images/4/47/Networkcost1.png\"/> \n</p>\n<p>\nMY 网络公司的网络收费方式比较奇特，称为“ 配对收费 ”。即对于每两个用户i, j (1≤i &lt; j ≤2^N ) 进行收费。由于用户可以自行选择两种付费方式A、B中的一种，所以网络公司向学校收取的费用与每一位用户的付费方式有关。该费用等于每两位不同用户配对产 生费用之和。\n</p>\n<p>\n为了描述方便，首先定义这棵网络树上的一些概念：\n</p>\n<ul>\n<li>\n祖先：根结点没有祖先，非根结点的祖先包括它的父亲以及它的父亲的祖先；\n</li>\n<li>\n管辖叶结点：叶结点本身不管辖任何叶结点，非叶结点管辖它的左儿子所管辖的叶结点与它的右儿子所管辖的叶结点；\n</li>\n<li>\n距离：在树上连接两个点之间的用边最少的路径所含的边数。\n</li>\n</ul>\n<p>\n对于任两个用户i, j (1≤i<j≤2^n )，首先在树上找到与它们距离最近的公共祖先：路由点p，然后观察p=\"\" 所管辖的叶结点（即用户）中选择付费方式a=\"\" 与b的人数，分别记为na=\"\" 与nb，接着按照网络管理条例第x=\"\" 章第y=\"\" 条第z=\"\" 款进行收费（如下表），其中fi,=\"\" j=\"\" 为i=\"\" 和j=\"\" 之间的流量，且为已知量。<=\"\" p=\"\"></j≤2^n>\n</p>\n<p>\n<img height=\"237\" alt=\"Image:Networkcost2.png\" width=\"628\" src=\"../../../../mw/images/0/02/Networkcost2.png\"/> \n</p>\n<p>\n由于最终所付费用与付费方式有关，所以NS 中学的用户希望能够自行改变自己的付费方式以减少总付费。然而，由于网络公司已经将每个用户注册时所选择的付费方式记录在案，所以对于用户i，如果他/她 想改变付费方式（由A 改为B 或由B 改为A），就必须支付Ci 元给网络公司以修改档案（修改付费方式记录）。\n</p>\n<p>\n现在的问题是，给定每个用户注册时所选择的付费方式以及Ci，试求这些用户应该如何选择自己的付费方式以使得NS 中学支付给网络公司的总费用最少（更改付费方式费用+配对收费的费用）。\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n输入文件中第一行有一个正整数N。\n</p>\n<p>\n第二行有2^N 个整数，依次表示1 号，2 号，…，2^N 号用户注册时的付费方式，每一个数字若为0，则表示对应用户的初始付费方式为A，否则该数字为1，表示付费方式为B。\n</p>\n<p>\n第三行有2^N 个整数，表示每一个用户修改付费方式需要支付的费用，依次为C1, C2, …,CM 。( M=2^N )\n</p>\n<p>\n以下2^N-1 行描述给定的两两用户之间的流量表F，总第(i + 3)行第j 列的整数为F[i, j+i] 。（1≤i&lt;2^N，1≤j≤2^N – i） 所有变量的含义可以参见题目描述。\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n你的程序只需要向输出文件输出一个整数，表示NS 中学支付给网络公司的最小总费用。（单位：元）\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre>2\n1 0 1 0\n2 2 10 9\n10 1 2\n2 1\n3\n</pre>\n<h3>\n【样例输出】\n</h3>\n<pre>8\n</pre>\n<h3>\n【样例说明】\n</h3>\n<p>\n将1 号用户的付费方式由B 改为A，NS 中学支付给网络公司的费用达到最小。\n</p>\n<h3>\n【评分方法】\n</h3>\n<p>\n本题没有部分分，你的程序的输出只有和我们的答案完全一致才能获得满分，否则不得分。\n</p>\n<h3>\n【数据规模和约定】\n</h3>\n<ul>\n<li>\n40%的数据中N≤4；\n</li>\n<li>\n80%的数据中N≤7；\n</li>\n<li>\n100%的数据中N≤10，0≤F[i, j]≤500，0≤Ci≤500 000。\n</li>\n</ul>\n\n"}]}