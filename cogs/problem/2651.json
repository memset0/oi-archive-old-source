{"title":"新史「新幻想史 -现代史-」","time_limit":2000,"memory_limit":256,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=viNzmVegk","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<p>\n<span style=\"color:#E53333;font-size:32px;\">题目解释：</span> \n</p>\n<p>\n<span style=\"color:#E53333;font-size:32px;\">所有整数都是正整数</span> \n</p>\n<p>\n<span style=\"color:#E53333;font-size:32px;\">新添一组大样例</span> \n</p>\n<p>\n<span style=\"color:#e53333;\"><span style=\"font-size:32px;\">题目最下面的咒语使用似乎会ce，请勿使用</span></span> \n</p>\n<p>\n<span style=\"color:#e53333;\"><span style=\"font-size:32px;\">已添加一句话题意</span></span> \n</p>\n<p>\n<span style=\"color:#e53333;\"><span style=\"font-size:32px;\">第i个时刻开始的时候会继承第i-1个时刻的状态</span></span> \n</p>\n<p>\n<span style=\"color:#e53333;\"><span style=\"font-size:32px;\">为了使题意更加容易理解，样例已更新</span></span> \n</p>\n<h3>\n【题目描述】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n慧音也想要退治妖怪！\n</p>\n<p>\n在某次异变中，慧音要退治排成一列的n个妖怪，作为&#34;吞食历史的半兽&#34;，慧音会使用符卡&#34;新史「新幻想史 -现代史-」&#34;修改过去的历史来让一段区间内的妖怪力量减少，同时因为历史被改变了，所以会有另一段区间的妖怪力量增强（一个妖怪的力量改变后，这个效果会一直持续到后面的时刻）。为了让修改历史的效果最稳定，慧音还想知道在过去的某个时刻一段区间中所有妖怪的妖力和是多少，每个时刻慧音只会发出一条指令。\n</p>\n<p>\n战斗持续了m个时刻，由于慧音还要集中精力发射<del>头槌</del>弹幕，所以她请你来帮忙解决她的询问。\n</p>\n<p>\n（没有进行任何操作的时刻为0时刻\n</p>\n<p>\n关于时间线的说明：\n</p>\n<p>\n如果有以下操作：询问1-&gt;修改-&gt;询问2，询问的目标时刻相等，修改的目标时刻小于等于询问的目标时刻，则询问1不会受到修改的影响，而询问2会\n</p>\n<p>\n如果有以下操作：询问1-&gt;修改-&gt;询问2，询问的目标时刻相等，修改的目标时刻大于询问的目标时刻，则两个询问都不会受到修改的影响\n</p>\n<p>\n特别提醒：\n</p>\n<p>\n比赛进行中请尽量不要进行有关时间线或世界线的伦理思考\n</p>\n<p>\n一句话题意：\n</p>\n<p>\n有一个长度为n的整数序列，共m个时刻，在每个时刻都有一个操作，如果是询问操作则询问指定时刻一段区间的和，如果是修改操作则使修改指定时刻到当前时刻的所有时刻一段区间全部增加一个数，另一段区间全部减少一个数\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n第一行两个整数n,m，意义如上\n</p>\n<p>\n接下来一行n个整数，第i个整数ai表示第i个妖怪的妖力\n</p>\n<p>\n接下来m行，第i行表示第i个时刻的指令，首先一个字符c，如果c为&#39;Q&#39;，接下来三个用空格隔开的整数x,y,z，表示询问第z个时刻区间[x,y]中所有妖怪的妖力和，如果c为&#39;M&#39;，接下来七个整数x,y,z,l,r,v,t，表示在第t个时刻，区间[x,y]中所有妖怪的妖力减少了z，区间[l,r]中所有妖怪妖力增加了v\n</p>\n<p>\n输入数据中一行中的所有整数和字符用空格隔开\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n对于每个M操作，输出一行一个值表示查询的结果\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例输入1】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n5 5\n</p>\n<p>\n1 2 3 4 5\n</p>\n<p>\nQ 1 3 0\n</p>\n<p>\nM 1 2 1 2 3 2 1\n</p>\n<p>\nQ 1 3 0\n</p>\n<p>\nQ 1 3 1\n</p>\n<p>\nQ 1 3 3\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例输出1】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n6\n</p>\n<p>\n6\n</p>\n<p>\n8\n</p>\n<p>\n8\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例输入2】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n12 12\n</p>\n<p>\n20755 32646 15599 16925 29509 29411 31544 19290 25477 30085 4973 21417\n</p>\n<p>\nM 8 11 32373 4 7 2615 1\n</p>\n<p>\nQ 7 7 0\n</p>\n<p>\nM 8 10 32317 12 12 1710 3\n</p>\n<p>\nM 4 5 28846 2 7 6548 4\n</p>\n<p>\nQ 9 11 4\n</p>\n<p>\nQ 12 12 4\n</p>\n<p>\nQ 5 11 2\n</p>\n<p>\nM 6 10 32331 6 7 1272 8\n</p>\n<p>\nM 2 11 17117 4 9 19679 9\n</p>\n<p>\nM 4 5 21667 4 5 13394 5\n</p>\n<p>\nM 8 10 11508 9 11 30783 11\n</p>\n<p>\nQ 8 9 6\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例输出2】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n31544\n</p>\n<p>\n-101218\n</p>\n<p>\n23127\n</p>\n<p>\n48642\n</p>\n<p>\n-84613\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例解释】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n第1个时刻，慧音询问第0个时刻[1,3]这个区间的妖力和，显然答案为6\n</p>\n<p>\n第2个时刻，慧音使第1个时刻[1,2]的妖力减少1，[2,3]的妖力增加2\n</p>\n<p>\n现在第1个时刻和第2个时刻的妖力序列都是0 3 5 4 5，而第0个时刻的妖力序列依旧是1 2 3 4 5\n</p>\n<p>\n之后的两次询问就是在第0个时刻[1,3]的妖力和和第1个时刻[1,3]的妖力和，显然答案分别为6和8\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【数据范围】\n</h3>\n<p>\n<br/>\n</p>\n<p style=\"font-family:serif;font-size:16px;\">\n<br/>\n</p>\n<table class=\"ke-zeroborder\" style=\"border-collapse:collapse;width:235pt;\" width=\"313\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">\n<tbody>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" width=\"72\" height=\"24\">\n数据标号\n</td>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" width=\"72\">\nn,m\n</td>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" width=\"72\">\nai,v,z\n</td>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" width=\"97\">\nex\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n1\n</td>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\">\n&lt;=50\n</td>\n<td rowspan=\"20\" class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\">\n&lt;=10^5\n</td>\n<td rowspan=\"6\" class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\">\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n2\n</td>\n<td rowspan=\"5\" class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\">\n&lt;=500\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n3\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n4\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n5\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n6\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n7\n</td>\n<td rowspan=\"8\" class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\">\n&lt;=5000\n</td>\n<td rowspan=\"2\" class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\">\n只有Q操作\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n8\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n9\n</td>\n<td rowspan=\"6\" class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\">\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n10\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n11\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n12\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n13\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n14\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n15\n</td>\n<td rowspan=\"6\" class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\">\n&lt;=50000\n</td>\n<td rowspan=\"2\" class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\">\n只有Q操作\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n16\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n17\n</td>\n<td rowspan=\"4\" class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\">\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n18\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n19\n</td>\n</tr>\n<tr>\n<td class=\"xl63\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" height=\"24\">\n20\n</td>\n</tr>\n<tr>\n<td colspan=\"4\" class=\"xl64\" style=\"font-family:&#34;border:1px dotted #AAAAAA;\" width=\"313\" height=\"42\">\n对于所有数据，保证查询和修改的目标时刻在进行操作的时刻或进行操作的时刻之前；数据有梯度\n</td>\n</tr>\n</tbody>\n</table>\n<p>\n<br/>\n</p>\n<h3>\n【ex】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n\n"}]}