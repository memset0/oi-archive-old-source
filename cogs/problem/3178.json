{"title":"搞操作","time_limit":1000,"memory_limit":512,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vXzNNjkWU","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n<strong> </strong> \n</p>\n<p>\n<strong>小 D 擅长搞操作。</strong> \n</p>\n<p>\n<strong>对于一个序列 A（下标从 0 编号），小 D 可以做如下操作获得序列 B：</strong> \n</p>\n<p>\n<strong>• B 是一个空序列。</strong> \n</p>\n<p>\n<strong>• 从 0 至 length(A) - 1 枚举 i，从 0 至 length(A) - i - 1 枚举 j。</strong> \n</p>\n<p>\n<strong>• 对于枚举的每一个 (i, j)，依次将 max$ A_k$ (<strong>k=j-i+j)</strong>加入 B 的末尾。</strong> \n</p>\n<p>\n<strong>小 D 太喜欢操作了，于是按照同样的方法由 B 操作出了序列 C。</strong> \n</p>\n<p>\n<strong>小 D 想知道 ∑$C_i$<strong><strong>(i=0-</strong>length(C)-1)</strong>，对 $10^9$ + $7 $取模。</strong> \n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n第一行，正整数 n，代表 A 的长度。\n</p>\n<p>\n第二行， n 个正整数，代表序列 A。\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n输出一行，一个整数，代表取模后的答案。\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre>3\n3 2 1\n</pre>\n<h3>\n【样例输出】\n</h3>\n<pre>58\n</pre>\n<h3>\n【提示】\n</h3>\n<p>\n保证$ n$ ≤ $2 $∗ $10^5$， $1$ ≤ $A_i$ ≤$ 10^6$。\n</p>\n\n"}]}