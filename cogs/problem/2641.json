{"title":"风铃","time_limit":1000,"memory_limit":32,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vJmXJVeqk","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n你准备给弟弟Ike买一件礼物，但是，Ike挑选礼物的方式很特别：他只喜欢那些能按照他的特有方式排成有序的东西。\n</p>\n<p>\n你准备给Ike买一个风铃。风铃是一种多层的装饰品，一般挂在天花板上。每个风铃都包含一些由竖直的线连起来的水平杆。每根杆的两端都有线连接，下面或者挂着另一根水平杆，或者挂着一个玩具。下面是一个风铃的例子：\n</p>\n<p>\n<br/>\n</p>\n<p>\n<img alt=\"\" src=\"/upload/image/20170329/20170329183846_55396.jpg\"/> \n</p>\n<p>\n<br/>\n</p>\n<p>\n为使你的弟弟满意，你需要选一个满足下面两个条件的风铃：\n</p>\n<p>\n(1) 所有的玩具都在同一层(也就是说，每个玩具到天花板之间的杆的个数是一样的)或至多相差一层。\n</p>\n<p>\n(2) 对于两个相差一层的玩具，左边的玩具比右边的玩具要更靠下一点。\n</p>\n<p>\n风铃可以按照下面的规则重新排列：任选一根杆，将杆两端的线“交换”。也就是解开一根杆左右两端的线，然后将它们分别绑到杆的另一端。注意这个操作不会改变下面的杆上线的排列顺序。\n</p>\n<p>\n由于你正在参加信息学奥林匹克的训练，所以你决定设计一个算法，判断能否通过重新排列，将一个给定的风铃变为Ike喜欢的样子。\n</p>\n<p>\n考虑上面的例子，上图中的风铃满足条件(1)，却不满足条件(2)——最左边的那个玩具比它右边的要高。\n</p>\n<p>\n但是，我们可以通过下面的步骤把这个风铃变成一个Ike喜欢的形式：\n</p>\n<p>\n1. 第一步，将杆1的左右两端交换，这使得杆2和杆3的位置互换，交换的结果如下图所示：\n</p>\n<img alt=\"\" src=\"/upload/image/20170329/20170329183932_46659.jpg\"/> \n<p>\n<br/>\n</p>\n<p>\n2. 第二步，也是最后一步，将杆2的左右两端交换，这使得杆4到了左边，原来在左边的玩具到了右边，交换的结果如下图所示：\n</p>\n<p>\n<img alt=\"\" src=\"/upload/image/20170329/20170329184010_26889.jpg\"/> \n</p>\n<p>\n<br/>\n</p>\n<p>\n现在这个风铃就满足Ike的条件了。\n</p>\n<p>\n你的任务是：给定一个风铃的描述，求出最少需要多少次交换才能使这个风铃满足Ike的条件(如果可能的话)。\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n输入的第一行包含一个整数n (1≤ n ≤ 1 00 000)，表示风铃中有多少根杆。\n</p>\n<p>\n接下来的n行描述杆的连接信息。这部分的第i行包含两个由空格分隔的整数li和ri，描述杆i的左右两端悬挂的东西。如果挂的是一个玩具，则对应的值为-1，否则为挂在下面的杆的编号。\n</p>\n<p>\n如果杆i下面挂有其它杆，则这些杆的编号将严格大于i。杆1位于风铃的顶部。\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n输出仅包含一个整数。表示最少需要多少次交换能使风铃满足Ike的条件。如果不可能满足，输出-1。\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre>6\n2 3\n-1 4\n5 6\n-1 -1\n-1 -1\n-1 -1\n</pre>\n<h3>\n【样例输出】\n</h3>\n   2\n<h3>\n【提示】\n</h3>\n<p>\n无\n</p>\n<h3>\n【来源】\n</h3>\n<p>\nAPIO2007\n</p>\n\n"}]}