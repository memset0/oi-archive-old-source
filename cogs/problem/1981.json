{"title":"[SDOI 2015] 序列统计","time_limit":3000,"memory_limit":256,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vSmSSkPUk","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n小C有一个集合S，里面的元素都是小于M的非负整数。他用程序编写了一个数列生成器，可以生成一个长度为N的数列，数列中的每个数都属于集合S。\n</p>\n<p>\n小C用这个生成器生成了许多这样的数列。但是小C有一个问题需要你的帮助：给定整数x，求所有可以生成出的，且满足数列中所有数的乘积mod M的值等于x的不同的数列的有多少个。小C认为，两个数列{Ai}和{Bi}不同，当且仅当至少存在一个整数i，满足Ai≠Bi。另外，小C认为这个问题的答案可能很大，因此他只需要你帮助他求出答案mod 1004535809的值就可以了。\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n一行，四个整数，N、M、x、|S|，其中|S|为集合S中元素个数。\n</p>\n<p>\n第二行，|S|个整数，表示集合S中的所有元素。\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n一行，一个整数，表示你求出的权值和mod 1004535809的值。\n</p>\n<h3>\n【样例输入】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n4 3 1 2\n</p>\n<p>\n1 2\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例输出】\n</h3>\n<p>\n8\n</p>\n<h3>\n【提示】\n</h3>\n<p>\n对于10%的数据，1&lt;=N&lt;=1000；\n</p>\n<p>\n对于30%的数据，3&lt;=M&lt;=100；\n</p>\n<p>\n对于60%的数据，3&lt;=M&lt;=800；\n</p>\n<p>\n对于全部的数据，1&lt;=N&lt;=10^9，3&lt;=M&lt;=8000，M为质数，<strong>1</strong>&lt;=x&lt;=M-1，输入数据保证集合S中元素不重复。\n</p>\n\n"}]}