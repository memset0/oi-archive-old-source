{"title":"[HZOI 2015]论西行妖的生长过程","time_limit":1000,"memory_limit":1,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vSzmNVjjP","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n<img src=\"/upload/image/20160613/20160613164744_40043.jpg\" alt=\"\"/> \n</p>\n<p>\n<br/>\n</p>\n<p>\n西行妖是一个得了厌世症的SX歌圣留下的遗产，\n</p>\n<p>\n西行妖是一棵美丽的樱花树，它有一种让人前来自杀的能力。。。。。。\n</p>\n<p>\n许多人自杀于树下，这东西祸国殃民。。。。。。\n</p>\n<p>\n作为妖怪贤者的八云紫当然不想要这种事情发生，这严重影响了世界的和谐\n</p>\n<p>\n然后，有一个叫西行寺幽幽子的人拥有与西行妖同样的能力，这十分危险，所以被世人厌弃，同时她也十分痛恨拥有这种能力的自己(苦命的孩子啊。。。。。。)\n</p>\n<p>\n所以，八云紫与幽幽子达成了共识:让八云紫利用幽幽子体能强大的死亡力量来封印西行妖。。。。。。\n</p>\n<p>\n然后，封印成功了，然而，-_-|||幽幽子也领便当了。。。。。。\n</p>\n<p>\n不过，幽幽子并没有死绝，她成了亡灵!\n</p>\n<p>\n然而,西行妖太过强大，它并没有被完全封印\n</p>\n<p>\n它在悄然生长\n</p>\n<p>\n千年之后，八云紫注意到了西行妖在悄悄生长\n</p>\n<p>\n然后很担心它会不会死灰复燃\n</p>\n<p>\n于是，八云紫随手打开了一条隙间把你揪了出来\n</p>\n<p>\n她让你模拟出西行妖生长的过程，不会的话就把你隙间掉!\n</p>\n<p>\n保命要紧啊!\n</p>\n<p>\n以下是八云紫给你的关于西行妖的一些资料，以及你要完成的任务:\n</p>\n<p>\n西行妖是一棵树，联通且没有环(你有见过一棵长出来环的树么QAQ)西行妖是在生长的，每次新长出一个节点，最后它会长成一棵n+1个节点的树，我们把这n+1个节点编号为0到n。\n</p>\n<p>\n西行妖一开始只有一个根节点0，而且第i号节点会在第i-1号节点长出后长出(1&lt;=i&lt;=n)\n</p>\n<p>\n每次八云紫会告诉你一些节点，设它们的个数为num，设它们分别是A1，A2...Anum(0&lt;=Aj&lt;i,1&lt;=j&lt;=num)，那么i号节点会在所有的Aj(1&lt;=j&lt;=num)的公共LCA处长出\n</p>\n<p>\n你需要按顺序构造出这棵树\n</p>\n<p>\n造好树后，更大的麻烦在等着你\n</p>\n<p>\n由于，西行寺幽幽子引发的春雪异变，西行妖的一些节点弥漫着春度，所以，又有m个询问，每次八云紫会告诉你一些节点，设它们的个数为NUM，设它们分别是B1，B2...BNUM(0&lt;=Bj&lt;i,1&lt;=j&lt;=NUM)，她说这些节点到根的路径上所有的点都弥漫着春度，然后她问你一共有多少个节点弥漫着春度，你必须回答，否则死路一条。\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n第一行，一个正整数n，表示西行妖有0到n一共n+1个节点\n</p>\n<p>\n第二行到第n+1行，每行会有一个正整数num，之后有num个数，表示八云紫告诉你的num个节点，第i个节点会在所有这些节点的公共LCA处长出\n</p>\n<p>\n第n+2行一个数m，表示八云紫接下来有m个询问\n</p>\n<p>\n第n+3到第n+m+2行，每行会有一个正整数NUM，之后有NUM个数，表示八云紫告诉你的NUM个节点，其中每个节点到根的路径上的所有节点都弥漫着春度，你需要输出一共有多少个节点弥漫着春度。(注意:所有询问相互独立!)\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n一共有m行，分别回答八云紫的m次询问\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre><p>\n5\n</p>\n\n<p>\n1 0\n</p>\n\n<p>\n1 0\n</p>\n\n<p>\n2 2 0\n</p>\n\n<p>\n3 2 0 1\n</p>\n\n<p>\n2 3 3\n</p>\n\n<p>\n3\n</p>\n\n<p>\n4 1 0 3 2\n</p>\n\n<p>\n6 2 5 5 1 1 4\n</p>\n\n<p>\n6 2 5 4 2 5 5\n</p>\n</pre>\n<h3>\n【样例输出】\n</h3>\n<pre><p>\n4\n</p>\n\n<p>\n6\n</p>\n\n<p>\n5\n</p>\n</pre>\n<h3>\n【提示】\n</h3>\n<p>\n1&lt;=n,m&lt;=5000\n</p>\n<h3>\n【来源】\n</h3>\n<p>\n神利·代目\n</p>\n\n"}]}