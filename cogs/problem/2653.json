{"title":"源符「厌川的翡翠」","time_limit":2000,"memory_limit":256,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vNxQSVegj","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n\n<p>\n<span style=\"color:#E53333;font-size:32px;\">题目更新： </span> \n</p>\n<p>\n<span style=\"color:#E53333;font-size:32px;\">现在第13,14,15,16组数据满足m=n-1</span> \n</p>\n<p>\n<span style=\"color:#e53333;\"><span style=\"font-size:32px;\">所有整数都是正整数</span></span> \n</p>\n<p>\n<span style=\"color:#e53333;\"><span style=\"font-size:32px;\">第7,8,9,10,11,12组数据的范围更改为：n,t&lt;=40, m&lt;=50</span></span> \n</p>\n<p>\n<span style=\"color:#e53333;\"><span style=\"font-size:32px;\">已添加一句话题意</span></span> \n</p>\n<p>\n<span style=\"color:#e53333;\"><span style=\"font-size:32px;\">已将样例2更换为更强的样例</span></span> \n</p>\n<p>\n<span style=\"color:#E53333;font-size:18px;\"><span style=\"color:#000000;font-size:24px;\"><br/>\n</span></span> \n</p>\n<p>\n<span style=\"color:#E53333;font-size:18px;\"><span style=\"color:#000000;font-size:24px;\">请不要在代码或评论中添加任何可能引起时间以</span><span style=\"color:#E53333;font-size:24px;\"><strong>秒</strong></span><span style=\"color:#000000;font-size:24px;\">为单位变化的内容</span></span> \n</p>\n<h3>\n【题目描述】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n诹访子和神奈子需要合力帮助早苗！\n</p>\n<p>\n早苗作为神社的风祝，有时也需要解决异变，但在一次异变中早苗遇到了非常强大的敌人，需要诹访子和神奈子的援助。诹访子打算使用符卡&#34;源符「厌川的翡翠」&#34;来帮助早苗，同时神奈子会使用藤蔓来增加诹访子符卡的威力。\n</p>\n<p>\n符卡&#34;源符「厌川的翡翠」&#34;会放出n个翡翠，神奈子则会操纵m条藤蔓连接这些翡翠，一些翡翠可能会被藤蔓连接成一个环，但是没有两个翡翠连成的环中有相同的藤蔓，所有的翡翠都能通过藤蔓连接到其它翡翠。在战斗中诹访子可以任意将翡翠的硬度调节为[1,t]中的整数，如果第i个翡翠的硬度为j，则整个符卡会获得v[i][j]的不稳定系数，而且符卡的威力和用藤蔓连接的两个翡翠硬度的差值有关。\n</p>\n<p>\n由于诹访子并不擅长数学，早苗又要与敌人交战，所以她请你来帮她找到一个最小的整数c，满足存在一种给翡翠设置硬度的方案，使得没有两个被藤蔓连接的翡翠硬度的差值大于c且所有翡翠的不稳定系数之和不大于w。\n</p>\n<p>\n一句话题意：\n</p>\n<p>\n给个仙人掌，仙人掌上每个点都能填入[1,t]中的整数，第i个点填j会获得收益v[i][j]，求一个最小的c，使得存在一种填数的方案，满足没有两个用边相邻的点填的数差值超过c且所有点的收益和不超过w\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n第一行四个整数n,m,w,t，意义如上\n</p>\n<p>\n接下来m行，每行三个整数l和r，表示第l个铁轮和第r个翡翠用藤蔓连接在一起\n</p>\n<p>\n接下来一个n行t列的整数矩阵，第i行第j列的数表示第i个翡翠硬度为j所获得的不稳定系数\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n如果敌人太强了诹访子和神奈子联手都无法战胜，输出-1\n</p>\n<p>\n否则一行一个整数c，意义如上\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例输入1】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n5 5 5 2\n</p>\n<p>\n1 2\n</p>\n<p>\n1 4\n</p>\n<p>\n3 4\n</p>\n<p>\n4 5\n</p>\n<p>\n3 5\n</p>\n<p>\n1 2\n</p>\n<p>\n2 1\n</p>\n<p>\n1 2\n</p>\n<p>\n2 1\n</p>\n<p>\n1 2\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例输出1】\n</h3>\n<p>\n1\n</p>\n<h3>\n【样例输入2】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n10 11 20 10\n</p>\n<p>\n1 2\n</p>\n<p>\n1 3\n</p>\n<p>\n3 4\n</p>\n<p>\n2 5\n</p>\n<p>\n3 6\n</p>\n<p>\n6 7\n</p>\n<p>\n3 8\n</p>\n<p>\n1 9\n</p>\n<p>\n1 10\n</p>\n<p>\n1 8\n</p>\n<p>\n1 5\n</p>\n<p>\n7 2 3 9 9 10 10 4 4 7\n</p>\n<p>\n1 7 1 9 3 1 1 2 4 6\n</p>\n<p>\n1 2 10 3 5 10 3 5 5 4\n</p>\n<p>\n1 9 3 8 4 4 2 2 3 2\n</p>\n<p>\n2 4 1 10 7 7 8 3 8 7\n</p>\n<p>\n9 3 8 3 2 10 7 3 10 1\n</p>\n<p>\n3 3 7 7 4 9 3 7 10 5\n</p>\n<p>\n9 5 8 7 1 3 2 10 5 8\n</p>\n<p>\n9 10 10 10 4 6 2 9 4 9\n</p>\n<p>\n7 10 8 10 2 1 4 3 9 10 \n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例输出2】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n3\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【数据范围】\n</h3>\n<p>\n</p><table style=\"border-collapse:collapse;width:450pt;\" class=\"ke-zeroborder\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"600\">\n<tbody>\n<tr>\n<td class=\"xl63\" height=\"26\" width=\"72\">\n数据标号\n</td>\n<td class=\"xl63\" width=\"72\">\nn\n</td>\n<td class=\"xl63\" width=\"72\">\nm\n</td>\n<td class=\"xl63\" width=\"97\">\nt\n</td>\n<td class=\"xl63\" width=\"143\">\nw\n</td>\n<td class=\"xl63\" width=\"72\">\nv\n</td>\n<td class=\"xl81\" width=\"72\">\nex\n</td>\n</tr>\n<tr>\n<td class=\"xl64\" height=\"26\" width=\"72\">\n1\n</td>\n<td colspan=\"3\" rowspan=\"2\" class=\"xl66\" style=\"border:1.0pt solid darkgray;\" width=\"241\">\n \n                   &lt;=5\n</td>\n<td rowspan=\"20\" class=\"xl72\" style=\"border:1.0pt solid darkgray;\" width=\"143\">\n&lt;=100000\n</td>\n<td rowspan=\"20\" class=\"xl75\" width=\"72\">\n&lt;=5000000\n</td>\n<td>\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl65\" height=\"26\" width=\"72\">\n2\n</td>\n<td>\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl64\" height=\"26\" width=\"72\">\n3\n</td>\n<td colspan=\"3\" rowspan=\"4\" class=\"xl66\" style=\"border:1.0pt solid darkgray;\" width=\"241\">\n&lt;=10\n</td>\n<td>\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl65\" height=\"26\" width=\"72\">\n4\n</td>\n<td>\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl64\" height=\"26\" width=\"72\">\n5\n</td>\n<td>\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl65\" height=\"26\" width=\"72\">\n6\n</td>\n<td>\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl64\" height=\"26\" width=\"72\">\n7\n</td>\n<td colspan=\"3\" rowspan=\"6\" class=\"xl66\" style=\"border:1.0pt solid darkgray;\" width=\"241\">\nn,t&lt;=40, m&lt;=50\n</td>\n<td>\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl65\" height=\"26\" width=\"72\">\n8\n</td>\n<td>\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl64\" height=\"26\" width=\"72\">\n9\n</td>\n<td>\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl65\" height=\"26\" width=\"72\">\n10\n</td>\n<td>\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl64\" height=\"26\" width=\"72\">\n11\n</td>\n<td>\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl65\" height=\"26\" width=\"72\">\n12\n</td>\n<td>\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl64\" height=\"26\" width=\"72\">\n13\n</td>\n<td rowspan=\"8\" class=\"xl72\" style=\"border:1.0pt solid darkgray;\" width=\"72\">\n&lt;=150\n</td>\n<td rowspan=\"8\" class=\"xl72\" style=\"border:1.0pt solid darkgray;\" width=\"72\">\n&lt;=200\n</td>\n<td rowspan=\"8\" class=\"xl72\" style=\"border:1.0pt solid darkgray;\" width=\"97\">\n&lt;=150\n</td>\n<td rowspan=\"4\" class=\"xl82\">\nm=n-1\n</td>\n</tr>\n<tr>\n<td class=\"xl65\" height=\"26\" width=\"72\">\n14\n</td>\n</tr>\n<tr>\n<td class=\"xl64\" height=\"26\" width=\"72\">\n15\n</td>\n</tr>\n<tr>\n<td class=\"xl65\" height=\"26\" width=\"72\">\n16\n</td>\n</tr>\n<tr>\n<td class=\"xl64\" height=\"26\" width=\"72\">\n17\n</td>\n<td>\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl65\" height=\"26\" width=\"72\">\n18\n</td>\n<td>\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl64\" height=\"26\" width=\"72\">\n19\n</td>\n<td>\n<br/>\n</td>\n</tr>\n<tr>\n<td class=\"xl65\" height=\"26\" width=\"72\">\n20\n</td>\n<td>\n<br/>\n</td>\n</tr>\n</tbody>\n</table>\n<p></p>\n<h3>\n【ex】\n</h3>\n<p>\n还有诹访子和神奈子联合起来都打不过的人(妖怪/神……)？\n</p>\n<p>\n正邪啊，谁自机谁最强<img src=\"/upload/image/20170409/20170409070522_23627.jpg\" alt=\"\"/> \n</p>\n<p>\n<br/>\n</p>\n<p>\n吓得我都去玩  <span style=\"font-size:32px;\"><strong>弹幕天邪鬼</strong></span>  了↓↓↓\n</p>\n<p>\n<img src=\"/upload/image/20170409/20170409074038_61496.jpg\" alt=\"\"/> \n</p>\n\n"}]}