{"title":"线性递推式","time_limit":1000,"memory_limit":128,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=pzSQXJeqV","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n\n【问题描述】<br/>\n动态规划 DP 的实现形式之一是递推，因此递推在 OI 中十分重要。在某信息学的分支学科中， LC 学会了如何求一阶线性递推数列。由于他现在正在学习主干学科，因此希望知道求出 $N$ 阶线性递推数列。为此，他了解到了以下的内容：<br/>\n一个 $N$ 阶线性递推式是这样的式子：<br/>\n\\[ f_i=a_0f_{i-n}+a_1f_{i-(n-1)}+\\cdots+a_{n-1}f_{i-1}+a_n \\]<br/>\n也就是说，这个数列的每一项都是由他之前连续 $N$ 项加权相加所得。其中还包括一个常数 $a_n$ 。<br/>\n例如，当 $N=2$, $a_0=a_1=1$, $a_2=0$ 时，这个式子就是我们熟悉的斐波那契数列。当然，作为这界条件， $f_0, f_1,...,f_{n-1}$ 都是已知的。<br/>\nLC 对这如何去求这个式子一筹莫展，因此请你来帮助他。你的任务就是对于一个给定的 $N$ 阶线性递推式，求出它的第 $K$ 项是多少。<br/>\n【输入文件】<br/>\n第一行两个整数： $N$ ， $K$ ，其中 $N$ 表示这个式子是 $N$ 阶线性递推式， $K$ 表示你需要求得那一项。<br/>\n第二行有 $N+1$ 个整数： $A_0, A_1,…, A_n$ ，表示这个递推式的系数。<br/>\n第三行有 $N$ 个整数： $F_0, F_1, ...,  F_{n-1}$ ，表示数列的初始值。<br/>\n【输出文件】<br/>\n只有一行，其中只有一个整数，表示这个数列第 $K$ 项的值。由于数据较大，你只需输出结果$\\mod 9973$的值。<br/>\n【样例输入】<br/>\n2 10<br/>\n1 1 0<br/>\n0 1<br/>\n【样例输出】<br/>\n55<br/>\n【数据范围】<br/>\n对于 50% 的数据： $N \\le K\\le 10^6$<br/>\n对于 100% 的数据：<br/>\n $N\\le K\\le 10^8$<br/>\n$1\\le A_i , F_i\\le 10^4$<br/>\n【提示】<br/>\n矩阵($Matrix$)是一个$n·m$（$n$行$m$列）的数组。例如[0 1]就是一个$1·2$的矩阵。<br/>\n矩阵乘法这样定义：<br/>\n    如果$\\boldsymbol{A}=n\\times m$，$\\boldsymbol{B}=m\\times t$，设矩阵$\\boldsymbol{C}=\\boldsymbol{A}\\times\\boldsymbol{B}$，则$c_{i,j}=\\sum a_{i,k}\\cdot b_{k,j}$，其中$\\boldsymbol{C}=n\\times t$。<br/>\n例如，对于斐波那契数可以列出这个递推公式：<br/>\n<p>\n\\[ [f_i\\quad f_{i+1}] = [f_{i-1}\\quad f_i] \\times \\left[\\begin{array}{cc} 0 &amp; 1 \\\\ 1 &amp; 1\\end{array}\\right] \\]\n</p>\n<p>\n<br/>\n</p>\n\n"}]}