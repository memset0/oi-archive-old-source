{"title":"Phi And MST","time_limit":1000,"memory_limit":256,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=viiSJVjeW","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n给你一个完全图，有n个节点，标号为1..n  \n</p>\n<p>\n每个点的权值就是自己的标号  \n</p>\n<p>\n查询图中最小生成树有多少个，这个的最小生成树必须满足父亲节点的标号小于自己,边的权值是连接的两个点的标号的gcd  \n</p>\n<p>\n有4个操作  \n</p>\n<p>\nD u v 删除边(u,v)，保证有边相连。  \n</p>\n<p>\nQ 查询最小生成树有多少个  \n</p>\n<p>\nS 查询当前的最小生成树权值和为多少  \n</p>\n<p>\nA 加一个节点，标号为当前最大的节点的标号+1，并且将他和每个节点连接一条边  \n</p>\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n<p>\n第一行两个数n,m  \n</p>\n<p>\n然后m行表示操作数  \n</p>\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre>无</pre>\n<h3>\n【样例输出】\n</h3>\n<pre>无</pre>\n<h3>\n【提示】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n0% n&lt;=10 m&lt;=10 并且只有查询操作  \n</p>\n<p>\n20% n&lt;=1000 m&lt;=1000 并且只有查询操作和加点操作  \n</p>\n<p>\n60% n&lt;=30000 m&lt;=30000 保证图的连通性，并且每个节点被删除的边的个数不会超过sqrt(i)个,Q操作不超过20次  \n</p>\n<p>\n100% n&lt;=500000 m&lt;=500000 保证图的连通性，并且每个节点i被删除的边的个数不会超过sqrt(i)个，最后一次操作是查询  \n</p>\n<p>\n答案 mod 100000007  \n</p>\n<p>\n删除的节点的标号必然&gt;=1000  \n</p>\n<p>\n<br/>\n</p>\n<h3>\n【来源】\n</h3>\n<p>\n改编自某题\n</p>\n\n"}]}