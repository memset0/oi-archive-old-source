{"title":"传送门树","time_limit":1000,"memory_limit":256,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vmQSNVUVg","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n有1棵n 个节点的树，节点编号为1 到n，i 号节点的权值为Wi。这棵树有些奇怪，它的每1个\n</p>\n<p>\n叶子节点都有一个传送门可在到达根节点(即每个叶子节点与根节点之间有1条边权为0 的边)。\n</p>\n<p>\n我们称这样的树为传送门树，根节点编号为1。我们需要最小化从u 到v 的路径(每条边只能经过1次) 上的节点权值之和，\n</p>\n<p>\n并且在最小化节点权值之和的同时求这个路径上可能的最大权值。\n</p>\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n第一行两个整数n 和q，n 表示节点个数，q 表示询问个数。\n</p>\n<p>\n第二行n - 1 个整数Ai，表示i + 1 号节点的父亲为Ai\n</p>\n<p>\n第三行n 个整数Wi 表第i 号节点的权值为Wi\n</p>\n<p>\n接下来q 行，每行两个整数u，v，表示1组询问\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n对于每组询问输出两个整数x; y\n</p>\n<p>\nx 表示u 到v 的权值和最小的路径的权值和，y 表示这条路径上点权最大值。如果有多个相同权值和的路径，输出那个点权最大值最大的。\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre><p>\n5 1\n</p>\n\n<p>\n1 2 3 4\n</p>\n\n<p>\n413 127 263 869 960\n</p>\n\n<p>\n1 5\n</p>\n</pre>\n<h3>\n【样例输出】\n</h3>\n<pre>1373 960</pre>\n<h3>\n【数据范围】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n• 对于30% 的数据，n &lt;=\u0014 300，q \u0014&lt;= 1000\n</p>\n<p>\n• 对于50% 的数据，n \u0014&lt;= 2000，q \u0014&lt;= 10000\n</p>\n<p>\n• 对于100% 的数据，n \u0014&lt;= 100000，q &lt;=\u0014 100000\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【来源】\n</h3>\n<p>\nqbxt 2017.10.2 t3\n</p>\n\n"}]}