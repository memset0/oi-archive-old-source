{"title":"[HZOI 2016]在路上","time_limit":10000,"memory_limit":512,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vJxmmVqkW","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n小F想从宿舍去机房。但是在去机房的路上他还需要顺便拜访其他地点，比如去图书馆借书，比如去食堂吃饭。经过这些地点的顺序不是随意的，比如小F不希望在去教室放完东西之后才去图书馆借书(因为他要把借到的书放到教室)。由于小F的时间比较紧，他希望在满足以上限制的同时，所走过的路长度最短。\n</p>\n<p>\n学校是一个有n个点m条边的无向连通图，地点自1至n依次编号，道路亦然。没有从某个地点直接到它自己的道路，两个地点之间最多只有一条道路直接相连。每条道路都有一个固定长度。在中途，小F想要经过k(k&lt;=n-2)个地点。宿舍编号为1，机房编号为n,而小F想要经过的K个地点编号依次为2,3,…,k+1。\n</p>\n<p>\n对于样例来说，小F想要经过地点2,3,4,5，并且在2停留的时候在3之前，而在4,5停留的时候在3之后。那么最短的走路方案是1-2-4-3-4-5-8，总长度为19。注意小F为了从地点2到地点4可以路过地点3,但不在地点3停留。这样就不违反小F的要求了。并且由于小F想要走最短的路径，因此这个方案正是小F需要的。\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n第一行包含3个整数n(2&lt;=n&lt;=20000),m(1&lt;=m&lt;=200000),k(0&lt;=k&lt;=20),意义如上所述。以下m行，每行包含3个整数x，y，z，(1&lt;=x，y&lt;=n，0&lt;z&lt;=1000)；\n</p>\n<p>\n接下来一行，包含一个整数q，表示有q个限制条件(0&lt;=q&lt;n)。以下q行，每行两个整数f，l(1&lt;=l，f&lt;=n)，表示在f停留的时候要在l之前。\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n只包含一行，包含一个整数，表示最短的走路距离。\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre>8 15 4\n1 2 3\n1 3 4\n1 4 4\n1 6 2\n1 7 3\n2 3 6\n2 4 2\n2 5 2\n3 4 3\n3 6 3\n3 8 6\n4 5 2\n4 8 6\n5 7 4\n5 8 6\n3\n2 3\n3 4\n3 5\n</pre>\n<h3>\n【样例输出】\n</h3>\n<pre>19</pre>\n<h3>\n【提示】\n</h3>\n<p>\n没啥提示\n</p>\n<h3>\n【来源】\n</h3>\n<p>\nHZOI 2016\n</p>\n\n"}]}