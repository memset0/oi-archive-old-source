{"title":"[HZOI 2015]QAQ的LIS树 II","time_limit":1000,"memory_limit":512,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vXzQxVjWP","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\nQAQ喜欢玩LIS，他觉得在树上的LIS非常的有趣\n</p>\n<p>\n但是上一道题目已经耗尽了他所有的魔法值，所以他并不能人为对点权进行修改了\n</p>\n<p>\nsad story。。\n</p>\n<p>\n不过没有关系，QAQ是个非常爱玩的小孩子，他又提出了这样的一个问题：\n</p>\n<p>\nQAQ有一棵树，节点总数为n，编号为0-&gt;n-1,树根为0\n</p>\n<p>\n要求支持以下操作：\n</p>\n<p>\n1、M u v 把u点的点权+v\n</p>\n<p>\n2、S 查询最大的一棵子树，满足子树中所有的点到子树的根的路径都是一个上升序列\n</p>\n<p>\n对于每次询问，QAQ想知道满足条件的子树最大是多少\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n第一行输入n表示节点总数\n</p>\n<p>\n之后有n-1个数，第i个数表示第i个节点的父亲\n</p>\n<p>\n输入m表示操作总数\n</p>\n<p>\n以下m行每行一个操作如题意所示\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n对于每个询问输出对应的答案\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre><p>\n10\n</p>\n\n<p>\n0 0 2 1 0 2 4 3 3\n</p>\n\n<p>\n20\n</p>\n\n<p>\nM 8 4\n</p>\n\n<p>\nS\n</p>\n\n<p>\nS\n</p>\n\n<p>\nS\n</p>\n\n<p>\nM 9 3\n</p>\n\n<p>\nM 4 3\n</p>\n\n<p>\nS\n</p>\n\n<p>\nS\n</p>\n\n<p>\nM 9 4\n</p>\n\n<p>\nS\n</p>\n\n<p>\nS\n</p>\n\n<p>\nM 7 4\n</p>\n\n<p>\nS\n</p>\n\n<p>\nM 0 1\n</p>\n\n<p>\nM 8 4\n</p>\n\n<p>\nS\n</p>\n\n<p>\nM 7 4\n</p>\n\n<p>\nS\n</p>\n\n<p>\nM 7 4\n</p>\n\n<p>\nM 2 1<span style=\"font-family:monospace;\"></span> \n</p>\n</pre>\n<h3>\n【样例输出】\n</h3>\n<pre><p>\n1\n</p>\n\n<p>\n1\n</p>\n\n<p>\n1\n</p>\n\n<p>\n2\n</p>\n\n<p>\n2\n</p>\n\n<p>\n2\n</p>\n\n<p>\n2\n</p>\n\n<p>\n1\n</p>\n\n<p>\n1\n</p>\n\n<p>\n1\n</p>\n</pre>\n<h3>\n【提示】\n</h3>\n<p>\n有30%的数据，n&lt;=1000,m&lt;=2000\n</p>\n<p>\n另外有20%的数据，树是随机的\n</p>\n<p>\n另外有20%的数据，树是一条链\n</p>\n<p>\n另外有10%的数据，所有非根节点的父亲都是根\n</p>\n<p>\n对于100%的数据，n&lt;=50000，m&lt;=100000，v&lt;=100000\n</p>\n\n"}]}