{"title":"[HZOI 2016]剩蛋节的礼物","time_limit":1000,"memory_limit":256,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=viJSxVgWP","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n剩蛋节到了，小兔子朱迪得到了来自尼克的礼物：大象冰淇凌！\n</p>\n<p>\n朱迪当然很开心，因为二人第一次见面就是在大象的冰淇凌店（只不过当时朱迪被尼克骗了。）\n</p>\n<p>\n于是朱迪决定也送礼物回赠尼克。朱迪的家人知道了这件事，他们也想送一份礼物给尼克，于是朱迪决定将一家人的礼物全部打包在一起送给尼克。\n</p>\n<p>\n然而，要知道朱迪家有众多的小兔子（为朱迪的父母点个赞），所以礼物非常多。\n</p>\n<p>\n现在朱迪不得不用n辆卡车来搬运这些礼物，于是朱迪的兄弟姐妹们都积极的帮朱迪将礼物装在卡车上，每次，一只小兔子会将在[l,r]的卡车上每辆卡车放a个礼物,总共m只小兔子。\n</p>\n<p>\n接下来，在完成装车工作后，要运到尼克的住处\n</p>\n<p>\n这时，麻烦又来了：卡车在运送路上会自由组队，但路上会通过一些桥，一些连续的卡车会同时通过一座桥，很可能会超载！\n</p>\n<p>\n所以，朱迪需要询问同时通过一座桥的一些连续的卡车总共载了多少礼物。\n</p>\n<p>\n同时，由于卡车司机很粗心，有时有一辆卡车会丢失一些礼物，不过卡车司机都很诚实，他们会立即告诉朱迪他们丢了多少东西。\n</p>\n<p>\n另外，由于朱迪的兔缘很好，一路上也会有一些小动物在一辆卡车上放一些礼物，司机也会立刻告诉朱迪。\n</p>\n<p>\n由于动物城分为很多个城区，所以，每到一个城区检查站，朱迪都要上报每辆卡车上装了多少礼物。\n</p>\n<p>\n这实在太麻烦了，所以朱迪决定请树懒-闪电来帮忙（没错，就是你！）。\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n输入两个数n,m,意义如上述。（n&lt;=1,000,000,m&lt;=1,000,000)\n</p>\n<p>\n接下来为十五个数：a,b,c,M1,l0,d,e,f,M2,r0,g,h,i,M3,v0\n</p>\n<p>\n表示第i只小兔子的礼物将会装载[li,ri]上，并且每辆车会装vi个\n</p>\n<p>\n其中vi=(g*v[i-1]*v[i-1]+h*v[i-1]+i)%M3\n</p>\n<p>\nli=(a*l[i-1]*l[i-1]+b*l[i-1]+c)%M1+1\n</p>\n<p>\nri=(d*r[i-1]*r[i-1]+e*r[i-1]+f)%M2+1\n</p>\n<p>\n（假如li&gt;ri那么请交换li和ri）\n</p>\n<p>\n<br/>\n</p>\n<p>\n接下来一个数T，表示发生了T个事件:(T&lt;=1,000,000)\n</p>\n<p>\n接下来T行，会有三种情况：\n</p>\n<p>\n1 num l r 表示查询在第num个小兔子装完礼物后l到r之间的卡车上共有多少礼物。\n</p>\n<p>\n2 x a 表示有小动物在第x辆卡车上放了a件礼物。\n</p>\n<p>\n3 x a 表示第x辆卡车丢失了a件礼物。\n</p>\n<p>\n4 l r 表示查询l到r之间的卡车上现在有多少礼物。\n</p>\n<p>\n5 表示到了一个城区检查站，需要得知每一辆卡车上有多少礼物（本操作出现次数不超过5次）\n</p>\n<p>\n为了减少你的输出量，第5种操作只需要输出所有卡车上的礼物个数的乘积（mod 1e9+7）。\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n每行一个数对应一个询问。\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre><p>\n3 3\n</p>\n\n<p>\n3 10 8 1 5 1 3 10 3 6 2 6 7 3 7\n</p>\n\n<p>\n10\n</p>\n\n<p>\n3 1 73\n</p>\n\n<p>\n3 2 9\n</p>\n\n<p>\n1 2 1 1\n</p>\n\n<p>\n4 2 3\n</p>\n\n<p>\n1 2 2 3\n</p>\n\n<p>\n4 2 2\n</p>\n\n<p>\n2 1 92\n</p>\n\n<p>\n2 2 62\n</p>\n\n<p>\n3 1 90\n</p>\n\n<p>\n4 2 3\n</p>\n</pre>\n<h3>\n【样例输出】\n</h3>\n<pre><p>\n1\n</p>\n\n<p>\n-7\n</p>\n\n<p>\n2\n</p>\n\n<p>\n-8\n</p>\n\n<p>\n55\n</p>\n</pre>\n<h3>\n【提示】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n数据保证任何时候卡车上的礼物总数不超过C++的int的范围，但有可能会出现负数的情况（因为在动物城，任何事情都有可能实现！）\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【来源】\n</h3>\n<p>\n一只名字很长的蒟蒻。\n</p>\n\n"}]}