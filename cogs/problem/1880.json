{"title":"[国家集训队2011]画圈圈","time_limit":1000,"memory_limit":512,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vJSJykUUa","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n\n<div class=\"content\">\n<!--begin main-->\n<!-- InstanceBeginEditable name=\"content\" -->\n<h3>\n【试题来源】\n</h3>\n<div id=\"psrc\" style=\"margin-top:20px;display:block;\">\n<div class=\"pdcont\">\n2011中国国家集训队命题答辩\n</div>\n</div>\n<div id=\"pinputs\" style=\"display:none;\">\n<div class=\"pdsec\">\n输入数据\n</div>\n<div class=\"pdcont\">\n<span class=\"notice\"> 这是一道提交答案的试题，下面给出了该题的输入数据：</span> \n</div>\n<div id=\"inputlist\" class=\"pddata\">\n</div>\n</div>\n<div id=\"pcont1\" style=\"margin-top:20px;display:block;\">\n<h3>\n【问题描述】\n</h3>\n<div class=\"pdcont\">\n有N行M列的点组成一个点阵。你通过用水平和竖直的线段连接一些相邻的点画若干闭合的回路，将所有的点连接起来，组成一个图形。连的线被视为是内部和外部的界限。其中，有一些点（用*和#表示）不用被连接，且用*表示的点在必须在图形内部，用#表示的点必须在图形外部。<br/>\n例如：（用＋表示点，－和｜表示线，ｘ表示图形内部）<br/>\n<img src=\"/upload/image/20141216/20141216144250_39470.png\" alt=\"\"/><br/>\n以及<br/>\n<img src=\"/upload/image/20141216/20141216144307_61835.png\" alt=\"\"/>注意：这个点是在外部！<br/>\n你要写一个程序来计算一共有多少种连线的方法。我们只关心它模一个大质数123456791的余数。\n</div>\n<h3>\n【输入格式】\n</h3>\n<div class=\"pdcont\">\n输入的第一行包含两个正整数，分别表示行数N和列数M。<br/>\n接下来N行，每行M个字符表示点的情况（用.*#来表示三种点）。<br/>\n50%的数据满足：<br/>\n总的方法数小于220000<br/>\n100%的数据满足：<br/>\nM≤12，N≤20\n</div>\n<h3>\n【输出格式】\n</h3>\n<div class=\"pdcont\">\n输出一个整数，表示总方法数模123456791的余数。\n</div>\n<h3>\n【样例输入】\n</h3>\n<div class=\"pddata\">\n5 6<br/>\n......<br/>\n....*.<br/>\n..#...<br/>\n......<br/>\n......\n</div>\n<h3>\n【样例输出】\n</h3>\n<div class=\"pddata\">\n117\n</div>\n</div>\n<div id=\"pcont2\" style=\"margin-top:20px;display:none;\">\n<p style=\"margin:13pt 0cm;\" class=\"NOI0\">\n<span style=\"font-family:黑体;mso-ascii-font-family:Arial;\"><strong><span style=\"font-size:small;\">【问题描述】</span></strong></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-size:small;\"><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">有</span><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">N</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">行</span><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">M</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">列的点组成一个点阵。你通过用水平和竖直的线段连接一些相邻的点画<u>若干闭合的回路</u>，将所有的点连接起来，组成一个图形。连的线被视为是内部和外部的界限。其中，有一些点（用</span><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">*</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">和</span><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">#</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">表示）不用被连接，且用</span><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">*</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">表示的点在必须在图形内部，用</span><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">#</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">表示的点必须在图形外部。</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">例如：（用＋表示点，－和｜表示线，ｘ表示图形内部）</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">＋－＋－＋－＋－＋－＋ </span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">｜ｘｘｘｘｘｘｘｘｘ｜ </span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">＋ｘ＋－＋－＋ｘ﹡ｘ＋ </span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">｜ｘ｜　　　｜ｘｘｘ｜</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">＋－＋　＃　＋ｘ＋－＋ </span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\"> ｜ｘ｜</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">＋－＋－＋　＋ｘ＋－＋ </span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">｜ｘｘｘ｜　｜ｘｘｘ｜</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">＋－＋－＋　＋－＋－＋</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">以及</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">＋－＋－＋－＋－＋</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">｜ｘｘｘｘｘｘｘ｜</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">＋ｘ＋－＋－＋ｘ＋</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">｜ｘ｜　　　｜ｘ｜</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">＋ｘ＋　＃　＋ｘ＋　　　注意：这个点是在外部！</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">｜ｘ｜　　　｜ｘ｜</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">＋ｘ＋－＋－＋ｘ＋</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">｜ｘｘｘｘｘｘｘ｜</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\"><span style=\"font-size:small;\">＋－＋－＋－＋－＋</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-size:small;\"><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">你要写一个程序来计算一共有多少种连线的方法。我们只关心它模一个大质数</span><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">123456791</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">的余数。</span></span> \n</p>\n<p style=\"margin:13pt 0cm;\" class=\"NOI0\">\n<span style=\"font-family:黑体;mso-ascii-font-family:Arial;\"><strong><span style=\"font-size:small;\">【输入格式】</span></strong></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-size:small;\"><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">输入的第一行包含两个正整数，分别表示行数</span><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">N</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">和列数</span><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">M</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">。</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-size:small;\"><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">接下来</span><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">N</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">行，每行</span><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">M</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">个字符表示点的情况（用</span><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">.*#</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">来表示三种点）。</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-size:small;\"><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">50%</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">的数据满足：</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-size:small;\"><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">总的方法数小于</span><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">220000</span></span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-size:small;\"><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">100%</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">的数据满足：</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-size:small;\"><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">M</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">≤</span><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">12</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">，</span><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">N</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">≤</span><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">20</span></span></span> \n</p>\n<p style=\"margin:13pt 0cm;\" class=\"NOI0\">\n<span style=\"font-family:黑体;mso-ascii-font-family:Arial;\"><strong><span style=\"font-size:small;\">【输出格式】</span></strong></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI\">\n<span style=\"font-size:small;\"><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">输出一个整数，表示总方法数模</span><span lang=\"EN-US\"><span style=\"font-family:&#39;Times New Roman&#39;;\">123456791</span></span><span style=\"font-family:宋体;mso-ascii-font-family:&#39;Times New Roman&#39;;mso-hansi-font-family:&#39;Times New Roman&#39;;\">的余数。</span></span> \n</p>\n<p style=\"margin:13pt 0cm;\" class=\"NOI0\">\n<span style=\"font-family:黑体;mso-ascii-font-family:Arial;\"><strong><span style=\"font-size:small;\">【样例输入】</span></strong></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI1\">\n<span lang=\"EN-US\"><span style=\"font-size:small;font-family:&#39;Courier New&#39;;\">5 6</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI1\">\n<span lang=\"EN-US\"><span style=\"font-size:small;font-family:&#39;Courier New&#39;;\">......</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI1\">\n<span lang=\"EN-US\"><span style=\"font-size:small;font-family:&#39;Courier New&#39;;\">....*.</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI1\">\n<span lang=\"EN-US\"><span style=\"font-size:small;font-family:&#39;Courier New&#39;;\">..#...</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI1\">\n<span lang=\"EN-US\"><span style=\"font-size:small;font-family:&#39;Courier New&#39;;\">......</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI1\">\n<span lang=\"EN-US\"><span style=\"font-size:small;font-family:&#39;Courier New&#39;;\">......</span></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI1\">\n<span lang=\"EN-US\"><!--?xml:namespace prefix = o ns = \"urn:schemas-microsoft-com:office:office\" /--><o:p><span style=\"font-size:small;font-family:&#39;Courier New&#39;;\"> </span></o:p></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI1\">\n<span lang=\"EN-US\"><o:p><span style=\"font-size:small;font-family:&#39;Courier New&#39;;\"> </span></o:p></span> \n</p>\n<p style=\"margin:13pt 0cm;\" class=\"NOI0\">\n<span style=\"font-family:黑体;mso-ascii-font-family:Arial;\"><strong><span style=\"font-size:small;\">【样例输出】</span></strong></span> \n</p>\n<p style=\"margin:0cm 0cm 0pt;\" class=\"NOI1\">\n<span lang=\"EN-US\"><span style=\"font-size:small;font-family:&#39;Courier New&#39;;\">117</span></span> \n</p>\n</div>\n</div>\n\n"}]}