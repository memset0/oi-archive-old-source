{"title":"[HZOI 2016] 暗之链锁 II","time_limit":1000,"memory_limit":128,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vmzyNVqjW","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n传说中的暗之链锁被人们称为Dark。Dark是人类内心的黑暗的产物，古今中外的勇者们都试图打倒它。经过研究，你发现Dark呈现无向图的结构，图中有n个节点和两类边，一类边被称为主要边，而另一类被称为附加边。Dark有n–1条主要边，并且Dark的任意两个节点之间都存在一条只由主要边构成的路径。另外，Dark还有m条附加边。\n</p>\n<p>\n你的任务是把Dark斩为不连通的两部分。一开始Dark的附加边都处于无敌状态，你只能选择一条主要边切断。一旦你切断了一条主要边，Dark就会进入防御模式，主要边会变为无敌的而附加边可以被切断。但是你的能力只能再切断Dark的k条附加边。现在你想要知道，一共有多少种方案可以击败Dark。注意，就算你切断一条主要边和不足k条附加边之后就已经把Dark斩为两截，你也需要再切够k条附加边才算击败了Dark。\n</p>\n<p>\n由于方案数可能很大，你只需要输出方案数模1000000007($10^9+7$)的值。\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n第一行包含三个整数n,m,k。\n</p>\n<p>\n之后n–1行，每行包括两个整数x和y，表示x和y之间有一条主要边。\n</p>\n<p>\n之后m行以同样的格式给出附加边。\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n输出一个整数表示答案。\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre>5 3 2\n1 2\n4 5\n3 2\n1 4\n1 3\n5 2\n3 4</pre>\n<h3>\n【样例输出】\n</h3>\n<pre>4</pre>\n<h3>\n【样例解释】\n</h3>\n<p>\n可能的方案为\n</p>\n<p>\n(4,5)+(1,3)+(2,5)\n</p>\n<p>\n(4,5)+(2,5)+(3,4)\n</p>\n<p>\n(1,4)+(2,5)+(3,4)\n</p>\n<p>\n(2,3)+(1,3)+(3,4)\n</p>\n<p>\n(每种方案第一个是主要边，其余是附加边)\n</p>\n<h3>\n【数据范围】\n</h3>\n<p>\n对于20%的数据，n≤1000，m≤1000。\n</p>\n<p>\n对于另20%的数据，k≤2。\n</p>\n<p>\n对于100%的数据，n≤100000，m≤200000，0≤k≤m。\n</p>\n<p>\n数据不保证不出现重边和自环。\n</p>\n<h3>\n【提示】\n</h3>\n<p>\n没啥提示\n</p>\n<h3>\n【来源】\n</h3>\n<p>\nHZOI 2016\n</p>\n\n"}]}