{"title":"[CF 520C]DNA Alignment","time_limit":1000,"memory_limit":256,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vzJmJkPke","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n    对于两个长度均为N的字符串s, t，定义：\n</p>\n<p>\n    $h(s, t)$为两个字符串中字符相同的位置个数,\n</p>\n<p>\n    <img src=\"http://espresso.codeforces.com/3185549447bcef14eee362fe5c14adf50d614ba9.png\" alt=\"\"/> \n</p>\n<p>\n    其中$shift(s, i)$表示将字符串s循环左移得到的字符串。\n</p>\n<p>\n    例如：ρ(&#34;AGC&#34;, &#34;CGT&#34;) =  h(&#34;AGC&#34;, &#34;CGT&#34;) + h(&#34;AGC&#34;, &#34;GTC&#34;) + h(&#34;AGC&#34;, &#34;TCG&#34;) +  h(&#34;GCA&#34;, &#34;CGT&#34;) + h(&#34;GCA&#34;, &#34;GTC&#34;) + h(&#34;GCA&#34;, &#34;TCG&#34;) +  h(&#34;CAG&#34;, &#34;CGT&#34;) + h(&#34;CAG&#34;, &#34;GTC&#34;) + h(&#34;CAG&#34;, &#34;TCG&#34;) =  1 + 1 + 0 + 0 + 1 + 1 + 1 + 0 + 1 = 6.\n</p>\n<p>\n    现在，你有一个长度为N 的DNA串S。你希望求出所有使得$\\rho(S, T)$取最大值的DNA串T 的个数。换句话说，你要求出满足<img src=\"http://espresso.codeforces.com/8689349142c7afec51741bca879d960cce9678c8.png\" alt=\"\"/>的长度为N 的DNA串T 的个数。其中DNA串表示所有字符均为A,G,C,T的字符串。\n</p>\n<p>\n    由于这个答案可能很大，你只需输出这个数除以$10^9 + 7$的余数。\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n第一行是一个正整数N，表示DNA串的长度。\n</p>\n<p>\n第二行是一个长度为N 的DNA串S。\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n一行一个整数。\n</p>\n<h3>\n【样例输入1】\n</h3>\n<pre>1\nC\n</pre>\n<h3>\n【样例输出1】\n</h3>\n<pre>1</pre>\n<h3>\n【样例输入2】\n</h3>\n<pre>2\nCG\n</pre>\n<h3>\n【样例输出2】\n</h3>\n<pre>4</pre>\n<h3>\n【样例输入3】\n</h3>\n<pre>3\nTTT\n</pre>\n<h3>\n【样例输出3】\n</h3>\n<pre>1</pre>\n<h3>\n【数据范围与提示】\n</h3>\n<p>\n$1 \\leq N \\leq 10^5$\n</p>\n<p>\n字符串中只包含A,G,C,T.\n</p>\n<p>\nNOTE：\n</p>\n<p>\n    \n</p>\n<p>\nPlease note that if for two distinct strings t1 and t2 values ρ(s, t1) и ρ(s, t2) are maximum among all possible t,\n</p>\n<p>\nthen both strings must be taken into account in the answer even if one\n</p>\n<p>\nof them can be obtained by a circular shift of another one.\n</p>\n<p>\nIn the first sample, there is ρ(&#34;C&#34;, &#34;C&#34;) = 1, for the remaining strings t of length 1 the value of ρ(s, t) is 0.\n</p>\n<p>\nIn the second sample, ρ(&#34;AG&#34;, &#34;AG&#34;) = ρ(&#34;AG&#34;, &#34;GA&#34;) = ρ(&#34;AG&#34;, &#34;AA&#34;) = ρ(&#34;AG&#34;, &#34;GG&#34;) = 4.\n</p>\n<p>\nIn the third sample, ρ(&#34;TTT&#34;, &#34;TTT&#34;) = 27\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【来源】\n</h3>\n<p>\nCF #295 div1 A\n</p>\n\n"}]}