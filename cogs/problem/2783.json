{"title":"Alone","time_limit":1000,"memory_limit":256,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vyyiSVWUj","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\nHA的MK 以前曾经同时与一些傻二哈交♂往♂，傻二哈们之间的关系成一棵树。\n</p>\n<p>\n一开始每个傻二哈对他都有一个好感度。因为 MK 太神犇了，所以很多傻二哈给他出了一些题目，\n</p>\n<p>\n他每 AC 一道 编号为WCG的傻二哈 出给他的题目会导致以 WCG为根的子树中除了 WCG 以外所有的傻二哈对他的好♂感♂度\n</p>\n<p>\n下降。\n</p>\n<p>\n操作 1: MK AC 了 WCG 出的题目导致以 WCG为根的子树中除了 WCG 以外所有的傻二哈对他的好♂感♂度下\n</p>\n<p>\n降。\n</p>\n<p>\n操作 2: MK 想要知道以 WCG 为根的子树中除了 WCG 以外还有几个对他好感度&gt;0 的。\n</p>\n<p>\n树根处的傻二哈编号为 0，它对 MK 的好♂感♂度♂可以看做是无限的\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n第一行一个整数 N。\n</p>\n<p>\n代表有 N+1 个傻二哈，编号分别是 0~N。\n</p>\n<p>\n接下来 N 行每行两个整数，第一个整数表示编号为 i 的傻二哈的好♂感♂度♂ H，第二个整数表示第\n</p>\n<p>\ni 个傻二哈在树上的父亲 Fi。（保证傻二哈 i 的父亲的编号小于 i）。\n</p>\n<p>\n接下来一行一个整数 Q。\n</p>\n<p>\n接下来 Q 行，每行一个操作。\n</p>\n<p>\n第一类操作读入三个参数{1,Ai,Xi}表示 QY 使以 Ai 为根的子树中除了 Ai 以外所有的傻二哈\n</p>\n<p>\n对他的好感度下降 Xi。\n</p>\n<p>\n第二类操作读入两个参数{2,Ai}表示询问以 Ai 为根的子树中除了 Ai 以外有几个傻二哈对 MK\n</p>\n<p>\n的好感度&gt;0。\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n对于每一个第二类操作，输出一行一个整数，表示所询问的答案。\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre>4\n1 0\n2 0\n2 2\n1 2\n4\n1 2 1\n2 2\n1 0 1\n2 0\n</pre>\n<h3>\n【样例输出】\n</h3>\n<pre>1\n1\n</pre>\n<h3>\n【提示】\n</h3>\n<p>\n对于 30%的数据，满足 1&lt;=N&lt;=1000，1&lt;=Q&lt;=1000。\n</p>\n<p>\n对于另外 20%的数据，保证数据纯随机生成。\n</p>\n<p>\n对于 100%的数据，满足 1&lt;=N&lt;=10^5，1&lt;=Q&lt;=10^5，0&lt;=Ai&lt;=N，1&lt;=Hi&lt;=10^9，1&lt;=Xi&lt;=10^4，\n</p>\n<p>\n0&lt;=Fi&lt;i。\n</p>\n<h3>\n【来源】\n</h3>\n<p>\n在此键入。\n</p>\n\n"}]}