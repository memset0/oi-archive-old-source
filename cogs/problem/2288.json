{"title":"[HZOI 2015]疯狂的魔法树","time_limit":2000,"memory_limit":512,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vSNiSVVUU","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n给定一棵有根树，树根为1\n</p>\n<p>\n每个点有点权\n</p>\n<p>\n要求你维护以下操作：<br/>\n1、Q u a b  查询u子树中权值在a-b之间的点的个数\n</p>\n<p>\n2、M u v   把u节点点权更改为v\n</p>\n<p>\n3、C u v   把u子树所有点权值+v\n</p>\n<p>\n4、W u v   把u子树所有点权值都变成v\n</p>\n<p>\n5、A u v   增加一个新点，编号是当前节点总数+1，其父亲是u，权值为v\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n第一行n，m 表示节点总数和操作总数\n</p>\n<p>\n以下n个正整数表示每个点的点权\n</p>\n<p>\n以下n-1行每行两个数u，v描述一条边的两个端点\n</p>\n<p>\n以下m行每行一个操作 如题意所示\n</p>\n<p>\n保证a&lt;=b，n，m&lt;=80000\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n对于每个Q输出相应的答案\n</p>\n<h3>\n【样例输入】\n</h3>\n<p>\n输入：\n</p>\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n<p>\n20 20\n</p>\n<p>\n11 14 20 7 17 19 11 18 13 6 19 10 6 11 20 2 8 5 13 15\n</p>\n<p>\n2 1\n</p>\n<p>\n3 2\n</p>\n<p>\n4 2\n</p>\n<p>\n5 3\n</p>\n<p>\n6 2\n</p>\n<p>\n7 2\n</p>\n<p>\n8 3\n</p>\n<p>\n9 2\n</p>\n<p>\n10 2\n</p>\n<p>\n11 3\n</p>\n<p>\n12 3\n</p>\n<p>\n13 5\n</p>\n<p>\n14 2\n</p>\n<p>\n15 4\n</p>\n<p>\n16 7\n</p>\n<p>\n17 16\n</p>\n<p>\n18 15\n</p>\n<p>\n19 18\n</p>\n<p>\n20 15\n</p>\n<p>\nW 20 20\n</p>\n<p>\nA 13 19\n</p>\n<p>\nQ 18 12 17\n</p>\n<p>\nW 19 4\n</p>\n<p>\nW 21 1\n</p>\n<p>\nW 5 5\n</p>\n<p>\nC 9 6\n</p>\n<p>\nQ 15 3 19\n</p>\n<p>\nW 12 19\n</p>\n<p>\nC 12 5\n</p>\n<p>\nW 12 7\n</p>\n<p>\nW 10 16\n</p>\n<p>\nC 6 9\n</p>\n<p>\nW 4 2\n</p>\n<p>\nW 12 8\n</p>\n<p>\nW 14 10\n</p>\n<p>\nQ 10 2 9\n</p>\n<p>\nW 1 21\n</p>\n<p>\nW 19 9\n</p>\n<p>\nC 13 1\n</p>\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例输出】\n</h3>\n<pre><p>\n1\n</p>\n\n<p>\n2\n</p>\n\n<p>\n0\n</p>\n</pre>\n<h3>\n【提示】\n</h3>\n<p>\n为了卡住暴力，前5个测试点的树形态是随机的\n</p>\n<p>\n而后5个测试点设某个点为i，则其父亲的编号在[i-20,i-1]之间\n</p>\n\n"}]}