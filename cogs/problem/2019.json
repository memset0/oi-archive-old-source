{"title":"[NOI2015]软件包管理器","time_limit":1000,"memory_limit":512,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vXmyQVakP","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n你决定设计你自己的软件包管理器。不可避免的，你要解决软件包之间的依赖关系。如果A依赖B，那么安装A之前需安装B，卸载B之前须卸载A。0号软件包不依赖任何软件包。依赖关系不存在环(包括自环)。\n</p>\n<p>\n你的任务是，求出每次安装、删除操作会改变多少个包的状态。\n</p>\n<p>\n<strong><u>安装一个已安装的软件包，或者卸载一个未安装的软件包，都不会改变任何软件包的安装状态，即在此情况下，改变安装状态的软件包数为0</u></strong> \n</p>\n<p>\n<strong><u>每次操作不仅需要计算安装软件包数，还作为操作影响后来的安装/删除<br/>\n</u></strong> \n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n第一行一个整数n,表示软件包的总数。\n</p>\n<p>\n随后n-1个整数$a_1,a_2,...a_{n-1}$，表示第i个软件包依赖第$a_i$个软件包\n</p>\n<p>\n接下来一行一个整数q,表示询问数\n</p>\n<p>\n之后q行，每行一个询问，询问分为两种\n</p>\n<p>\n$install$ $x：表示安装x$\n</p>\n<p>\n$uninstall$ $x：表示卸载x$\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\nq行，每行一个整数，为第i步操作改变安装状态的软件包数\n</p>\n<p>\n【样例输入1】\n</p>\n<p>\n7\n</p>\n<p>\n0 0 0 1 1 5\n</p>\n<p>\n5\n</p>\n<p>\ninstall 5\n</p>\n<p>\ninstall 6\n</p>\n<p>\nuninstall 1\n</p>\n<p>\ninstall 4\n</p>\n<p>\nuninstall 0\n</p>\n<p>\n【样例输出1】\n</p>\n<p>\n3\n</p>\n<p>\n1\n</p>\n<p>\n3\n</p>\n<p>\n2\n</p>\n<p>\n3\n</p>\n<p>\n【样例说明1】：<img alt=\"\" src=\"/upload/image/20150730/20150730170635_69367.png\"/> \n</p>\n<p>\n一开始所有的软件包都处于未安装状态。\n</p>\n<p>\n安装5号软件包，需安装0,1,5三个软件包\n</p>\n<p>\n之后安装6号软件包，只需安装6号软件包。此时安装了0,1,5,6四个软件包。\n</p>\n<p>\n卸载1号软件包需要卸载1,5,6三个软件包，此时只有0号软件包还处于安装状态\n</p>\n<p>\n之后安装4号软件包，需安装1,4两个软件包。此时0,1,4处于安装状态\n</p>\n<p>\n最后，卸载0号软件包会卸载所有的软件包\n</p>\n<p>\n【样例输入2】\n</p>\n<p>\n10\n</p>\n<p>\n0 1 2 1 3 0 0 3 2\n</p>\n<p>\n10\n</p>\n<p>\ninstall 0\n</p>\n<p>\ninstall 3\n</p>\n<p>\nuninstall 2\n</p>\n<p>\ninstall 7\n</p>\n<p>\ninstall 5\n</p>\n<p>\ninstall 9\n</p>\n<p>\nuninstall 9\n</p>\n<p>\ninstall 4\n</p>\n<p>\ninstall 1\n</p>\n<p>\ninstall 9\n</p>\n<p>\n【样例输出2】\n</p>\n<p>\n1\n</p>\n<p>\n3\n</p>\n<p>\n2\n</p>\n<p>\n1\n</p>\n<p>\n3\n</p>\n<p>\n1\n</p>\n<p>\n1\n</p>\n<p>\n1\n</p>\n<p>\n0\n</p>\n<p>\n1\n</p>\n<h3>\n【提示】\n</h3>\n<p>\n1,2:n=5000 q=5000\n</p>\n<p>\n3,4:n=100000 q=100000 没有卸载操作\n</p>\n<p>\n5,6,7,8 n=100000,q=100000 依赖关系和操作随机\n</p>\n<p>\n9-20 n=100000,q=100000 不随机\n</p>\n<h3>\n【来源】\n</h3>\n<p>\nNOI2015Day1T2\n</p>\n\n"}]}