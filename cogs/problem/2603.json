{"title":"[HZOI 2016]颓废元","time_limit":1000,"memory_limit":128,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vSSymVeaj","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n<br/>\n</p>\n<p>\nJJ博士最近发现，人们寒假颓废与一种名字叫做“颓废元”的化学物质有关。这种化学物质作用于人的脑子中，通过人的神经网络到达人的大脑。\n</p>\n<p>\nJJ博士开始尝试利用手术解决颓废问题，而解决方案就是切除有关神经。\n</p>\n<p>\n当然了，由于有关神经都在人脑中，所以要尽量选择伤害最小的方式来切除，否则做完手术之后你可能会“脑子里少根弦”。\n</p>\n<p>\n为了完成这一计划，JJ博士需要你的帮助。\n</p>\n<p>\n作为博士的8号助手，你平时很少有机会能展示自我（活都被前7号抢了），所以你要抓住机会，展现自我。\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n一个整数n，表示有n个突触（你可以理解为多条神经元供用一个突触），其中1号为“颓废元”产生的地方，n号为“颓废元”作用的地方。\n</p>\n<p>\n一个整数m，表示共有m个神经元。\n</p>\n<p>\n接下来m行，每行两个1到n的整数x,y,z，表示x到y有一个神经元，最多能传载z单位的“颓废元”。\n</p>\n<p>\n接下来一个整数T，表示将会有T组询问。\n</p>\n<p>\n每行两个整数ope 和 x，\n</p>\n<p>\n若ope==1，则询问切掉第x个神经元能存在于一种最小代价切割方案中。\n</p>\n<p>\n若ope==2，则询问若要以最小代价阻断“颓废元”的传播，第x个神经元是否一定要切除。\n</p>\n<p>\n最后，虽然JJ博士没有询问，但是你为了说明自己很优秀，表现自己的能力很强，你需要告诉他若不切除，到达大脑的“颓废元”数目是多少。\n</p>\n<p>\n同时，你还要告诉JJ博士一种最小代价的切除方案。\n</p>\n<p>\n什么是最小代价呢？显然切除较细的（传载“颓废元”数目较小的）的代价比切除较粗的代价小，在很多种方案代价相同时，选择字典序最小的方案。\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\nT行，每行对应一个答案1或者0。\n</p>\n<p>\n1行，表示若不切除，到达大脑的“颓废元”数目是多少\n</p>\n<p>\n1行，表示最小代价的切除方案，每个数之间用一个空格隔开。\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre><p>\n7\n</p>\n\n<p>\n7\n</p>\n\n<p>\n1 2 10\n</p>\n\n<p>\n2 3 1\n</p>\n\n<p>\n3 4 1\n</p>\n\n<p>\n4 7 10\n</p>\n\n<p>\n1 5 10\n</p>\n\n<p>\n5 6 1\n</p>\n\n<p>\n6 7 10\n</p>\n\n<p>\n5\n</p>\n\n<p>\n1 2\n</p>\n\n<p>\n1 3\n</p>\n\n<p>\n1 6\n</p>\n\n<p>\n2 6\n</p>\n\n<p>\n2 2\n</p>\n</pre>\n<h3>\n【样例输出】\n</h3>\n<pre><p>\n1\n</p>\n\n<p>\n1\n</p>\n\n<p>\n1\n</p>\n\n<p>\n1\n</p>\n\n<p>\n0\n</p>\n\n<p>\n2\n</p>\n\n<p>\n2 6\n</p>\n</pre>\n<h3>\n【提示】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n对于24%的数据，n&lt;=20,m&lt;=400,T&lt;=2\n</p>\n<p>\n对于60%的数据，50%左右的神经元的z等于1\n</p>\n<p>\n对于100%的数据，n&lt;=400,m&lt;=4000,T&lt;=8000，0&lt;z&lt;=m\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【来源】\n</h3>\n<p>\n一只名字很长的蒟蒻\n</p>\n\n"}]}