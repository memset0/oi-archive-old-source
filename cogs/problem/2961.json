{"title":"[SYOI 2018] 简单的线段树","time_limit":1000,"memory_limit":256,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vSSySVPek","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n<br/>\n</p>\n<p class=\"p1\">\n<span class=\"s1\">线段树的结构非常简单，它简单到只支持两类操作，修改和查询。<span class=\"Apple-tab-span\"> </span> </span> \n</p>\n<p class=\"p1\">\n<span class=\"s1\"><span class=\"Apple-tab-span\"> </span>HA实验有一棵线段树，调皮的HtBest想对它进行一些操作，并实时查看他的状态。HtBest会对线段树进行以下三种操作：</span> \n</p>\n<p class=\"p1\">\n<span class=\"s1\">1.让线段树维护的区间中[l,r]全部加上一个正整数<span class=\"Apple-converted-space\"> </span> </span> \n</p>\n<p class=\"p1\">\n<span class=\"s1\">2.让线段树维护的区间中[l,r]全部乘以一个正整数<span class=\"Apple-converted-space\"> </span> </span> \n</p>\n<p class=\"p1\">\n<span class=\"s1\">3.HtBest希望知道区间[l,r]的数值之和</span> \n</p>\n<p class=\"p1\">\n<span class=\"s1\"><span class=\"Apple-tab-span\"> </span>由于答案可能很大，你只需要输出答案模p后的值。(线段树初始值全为0)</span> \n</p>\n<br/>\n<h3>\n【输入格式】\n</h3>\n<p>\n<br/>\n</p>\n<p class=\"p1\">\n<span class=\"s1\">第一行包含三个正整数n(维护的最大区间)m(操作个数)和p(需要模的值)。接下来有n行，每行描述一个操作，有以下三种形式：“1 l r v” 表示为[l,r]中的每个数都加上v，“2 l r v”表示为[l,r]中的每个数都乘以v，“3 l r”表示查询[l,r]的数值之和。</span> \n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n<br/>\n</p>\n<p class=\"p1\">\n<span class=\"s1\">对于每个询问操作，输出一个整数占一行，表示询问的答案。</span> \n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例输入1】\n</h3>\n<pre>3 3 5\n2 2 2 2\n1 1 1 1\n3 1 2\t\t\t\n</pre>\n<h3>\n【样例输出1】\n</h3>\n<pre>1</pre>\n<h3>\n【样例输入2】\n</h3>\n<pre>3 3 5\n2 2 3 2\n1 1 3 5\n3 1 2\n</pre>\n<h3>\n【样例输出2】\n</h3>\n<pre>0</pre>\n<h3>\n【样例输入3】\n</h3>\n<pre>7 7 1000\n1 3 5 8\n1 2 4 13\n2 6 7 2\n2 2 4 1\n3 1 4\n3 4 6\n2 1 4 6\n</pre>\n<h3>\n【样例输出3】\n</h3>\n<pre>55\n29\n</pre>\n<h3>\n【提示】\n</h3>\n<p>\n对于前30%的数据，1≤n，m≤1000\n</p>\n<p>\n另有20%的数据，无操作2\n</p>\n<p>\n对于前100%的数据，1≤n，m≤100000\n</p>\n<p>\n对于所有输入数据，不超过100000000。\n</p>\n<p>\n<strong><span style=\"font-size:18px;\"></span><span style=\"color:#E53333;font-size:18px;\">暴力程序请加大数据剪枝，否则会卡评测机。</span></strong> \n</p>\n<h3>\n【来源】\n</h3>\nBy : HtBest\n\n"}]}