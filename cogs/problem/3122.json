{"title":"收集","time_limit":3000,"memory_limit":512,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vSmxSjkVV","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\nwzp 又开始了收集兵器之旅\n</p>\n<p>\nwzp 打开了一个游戏，这个游戏的地图中有 N 个村庄和 N-1 条道路，并且任何两个村庄之间有且仅有一条路径可达。游戏开始时，玩家可以任意选择一个村庄，瞬间转移到这个村庄，然后可以任意在地图的道路上行走，若走到某个村庄中有宝物，则视为找到该村庄内的宝物，直到找到所有宝物为止。\n</p>\n<p>\nwzp 想知道收集完所有宝物的时间，因此他需要知道找到所有宝物需要行走的最短路程。但是这个游戏随机性较强，有时某个村庄中会突然出现宝物，有时某个村庄内的宝物会突然消失，因此 wzp 需要不断地更新数据，但是 wzp 太懒了，不愿意自己计算，因此他向你求助。为了简化问题，我们认为最开始时所有村庄内均没有宝物.\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n第一行，两个整数 N、M，其中 M 为宝物的变动次数。接下来的 N-1 行，每行三个整数 x、y、z，表示村庄 x、y 之间有一条长度为 z 的道路。接下来的 M 行，每行一个整数 t，表示一个宝物变动的操作。若该操作前村庄 t 内没有宝物，则操作后村庄内有宝物；若该操作前村庄 t 内有宝物，则操作后村庄内没有宝物。\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\nM 行，每行一个整数，其中第 i 行的整数表示第 i 次操作之后 wzp 找到所有宝物需要行走的最短路程。\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre>4 5\n1 2 30\n2 3 50\n2 4 60\n2\n3\n4\n2\n1\n</pre>\n<h3>\n【样例输出】\n</h3>\n<pre>0\n50\n110\n110\n170\n</pre>\n<h3>\n【提示】\n</h3>\n<p>\n对于 10% 的数据，1≤N≤100,1≤M≤100\n</p>\n<p>\n对于 20% 的数据，1≤N≤1000,1≤M≤1000\n</p>\n<p>\n对于另外 15% 的数据，每个村庄最多成为两条道路的端点；\n</p>\n<p>\n对于 100% 的数据，1≤N≤100000 1≤M≤100000 1≤z≤10^9\n</p>\n\n"}]}