{"title":"Toptree","time_limit":2000,"memory_limit":256,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vQQzJVVqj","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n你被派去完成一个任务，这个任务是必须A掉一个题，题目是这样的：你需要维护一个点带权的森林，支持加边、删边的操作，并且回答一些询问。\n</p>\n<p>\n一开始，这个图是一张空图，没有边。\n</p>\n<p>\n从现在开始，用节点u表示标号为u的节点。\n</p>\n<p>\n操作共分为以下几种类型：\n</p>\n<p>\n1 u v\n</p>\n<p>\n表示在节点u与节点v之间连上一条无向边。\n</p>\n<p>\n2 u v\n</p>\n<p>\n表示删除节点u与节点v之间的无向边。\n</p>\n<p>\n3 u x\n</p>\n<p>\n将节点u的权值改为x.\n</p>\n<p>\n4 u v\n</p>\n<p>\n表示询问节点u与节点v之间的路径上的权值最小值.\n</p>\n<p>\n5 w u v\n</p>\n<p>\n表示询问以节点w为根时，节点u与节点v的最近公共祖先节点的标号。\n</p>\n<p>\n6 w u\n</p>\n<p>\n表示询问以节点w为根时，以节点u为根的子树的节点数。\n</p>\n<p>\n7 w u\n</p>\n<p>\n表示询问以节点w为根时，以节点u为根的子树权值最小值。\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n第一行两个整数n,m，表示树上的总结点数，以及总的操作次数；\n</p>\n<p>\n接下来一行n个整数，第i个整数为xi，表示节点i初始的权值；\n</p>\n<p>\n接下来m行，依次表示m次操作。\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n对于每一个操作类型为5,6,7的操作，输出一行一个整数，表示这次询问的答案。\n</p>\n<h3>\n【样例输入】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n10 30\n</p>\n<p>\n453693185 97417345 542909441 272416065 660418023 969737409 73086977 60587265 168796673 359459841\n</p>\n<p>\n1 1 2\n</p>\n<p>\n1 9 10\n</p>\n<p>\n1 5 4\n</p>\n<p>\n2 5 4\n</p>\n<p>\n1 3 9\n</p>\n<p>\n5 9 9 10\n</p>\n<p>\n6 7 7\n</p>\n<p>\n6 7 7\n</p>\n<p>\n3 1 147640321\n</p>\n<p>\n6 3 9\n</p>\n<p>\n1 5 8\n</p>\n<p>\n1 3 5\n</p>\n<p>\n6 7 7\n</p>\n<p>\n6 9 10\n</p>\n<p>\n1 5 2\n</p>\n<p>\n1 9 7\n</p>\n<p>\n7 1 1\n</p>\n<p>\n6 9 1\n</p>\n<p>\n3 9 125258561\n</p>\n<p>\n7 7 1\n</p>\n<p>\n4 5 1\n</p>\n<p>\n4 1 1\n</p>\n<p>\n2 3 5\n</p>\n<p>\n7 3 3\n</p>\n<p>\n4 3 3\n</p>\n<p>\n3 7 487083009\n</p>\n<p>\n7 1 1\n</p>\n<p>\n5 3 3 3\n</p>\n<p>\n1 3 4\n</p>\n<p>\n7 7 7\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例输出】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n9\n</p>\n<p>\n1\n</p>\n<p>\n1\n</p>\n<p>\n2\n</p>\n<p>\n1\n</p>\n<p>\n1\n</p>\n<p>\n60587265\n</p>\n<p>\n1\n</p>\n<p>\n147640321\n</p>\n<p>\n97417345\n</p>\n<p>\n147640321\n</p>\n<p>\n73086977\n</p>\n<p>\n542909441\n</p>\n<p>\n60587265\n</p>\n<p>\n3\n</p>\n<p>\n125258561\n</p>\n<h3>\n【提示】\n</h3>\n<p>\n对于测试点1,2,3,4,5,6，保证n,m≤1000;\n对于测试点7,8,9,10,11,12，保证只有操作1,2,3,4,5;\n对于测试点13,14,15,16,保证没有操作7；\n对于全部数据，1≤n,m≤100,000,保证所有操作均合法，且所有出现过的权值x均互不相同，且1≤x≤10^9。\n</p>\n<h3>\n【来源】\n</h3>\n<p>\n在此键入。\n</p>\n\n"}]}