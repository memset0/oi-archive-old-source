{"title":"[Codeforces 828E] DNA进化","time_limit":2000,"memory_limit":512,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vNmmxVWek","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n 所有人都知道DNA链是由核苷酸组成的。有四种核苷酸：&#34;A&#34;, &#34;T&#34;, &#34;G&#34;, &#34;C&#34;。一个DNA链是核苷酸的序列。科学家决定追踪一个稀有物种的进化，起初它们的DNA链是字符串ｓ。\n</p>\n<p>\n 这个物种的进化被描述为DNA的一个变化序列。每一个变化都是一些核苷酸的改变，例如在DNA链“AAGC”中可以发生下列变化：第二个核苷酸可以变为“T”所以最终的DNA链是“ATGC”。\n</p>\n<p>\n科学家知道DNA链的一些片段能被某些未知的感染源影响。他们能用一个核苷酸序列来代表感染源。科学家对是否有一些变化是由这些感染源引起的很感兴趣。因此他们有时想知道一些感染源对一些DNA片段的影响的值。这种值按如下计算：\n</p>\n<p>\n<span><strong> <img src=\"/upload/image/20170724/20170724220026_27867.png\" alt=\"\"/> 把感染源表示为一个字符串ｅ，并让科学家对DNA链中从ｌ到ｒ的片段感兴趣，包括端点。</strong></span> \n</p>\n<p>\n<span><strong>  <img src=\"/upload/image/20170724/20170724220047_24039.png\" alt=\"\"/> 字符串eee... 的前缀（也就是由无限多个重复的字符串ｅ组成的字符串）被写在字符串ｓ从ｌ到ｒ下面，包括端点。</strong></span> \n</p>\n<p>\n <img src=\"/upload/image/20170724/20170724220127_36358.png\" alt=\"\"/> <strong>这种影响的值是字符串ｓ中与写在它下面的字母相同的字母的个数。</strong> \n</p>\n<p>\n 作为一个开发者，Innokenty对生物学也很感兴趣，所以科学家找他帮忙。 Innokenty在忙于为“ＶＫ杯”做准备，所以他决定把这个问题委托给参赛者。快来帮助科学家吧！\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n第一行是字符串ｓ<img src=\"/upload/image/20170724/20170724220315_22884.png\" alt=\"\"/>。它只包含大写英文字母&#34;A&#34;, &#34;T&#34;, &#34;G&#34; 和&#34;C&#34;。\n</p>\n<p>\n下一行是一个整数ｑ（１＜＝ｑ＜＝１０＾５），代表研究事件的个数。\n</p>\n<p>\n接下来是ｑ行，每行描述一个研究事件，包含以下其中一个形式：\n</p>\n<p>\n<img src=\"/upload/image/20170724/20170724220646_32099.png\" alt=\"\"/> <strong>１ ｘ　ｃ</strong>；ｘ是一个整数<img src=\"/upload/image/20170724/20170724220547_67165.png\" alt=\"\"/>，ｃ是&#34;A&#34;, &#34;T&#34;, &#34;G&#34; 或&#34;C&#34;；意思是DNA中有一个变化：位置ｘ的核苷酸现在是ｃ。\n</p>\n<p>\n<img src=\"/upload/image/20170724/20170724220654_89653.png\" alt=\"\"/> <strong>２　ｌ　ｒ　ｅ</strong>；ｌ，ｒ是整数<img src=\"/upload/image/20170724/20170724220754_72336.png\" alt=\"\"/>，ｅ值由&#34;A&#34;, &#34;T&#34;, &#34;G&#34; 和&#34;C&#34;组成的一个字符串<img src=\"/upload/image/20170724/20170724220811_57292.png\" alt=\"\"/>，；意思是科学家对感染源ｅ对于从ｌ到ｒ的DNA片段的影响的值感兴趣，包括端点。\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n对于科学家的每一次询问（第二种类型的事件）输出一个整数在一个单独的行中，代表感染源对DNA片段的影响的值。\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例输入1】\n</h3>\n<p>\nATGCATGC\n</p>\n<p>\n4\n</p>\n<p>\n2 1 8 ATGC\n</p>\n<p>\n2 2 6 TTT\n</p>\n<p>\n1 4 T\n</p>\n<p>\n2 2 6 TA\n</p>\n<h3>\n【样例输出1】\n</h3>\n<p>\n8\n</p>\n<p>\n2\n</p>\n<p>\n4\n</p>\n<h3>\n【样例输入2】\n</h3>\n<p>\nGAGTTGTTAA\n</p>\n<p>\n6\n</p>\n<p>\n2 3 4 TATGGTG\n</p>\n<p>\n1 1 T\n</p>\n<p>\n1 6 G\n</p>\n<p>\n2 5 9 AGTAATA\n</p>\n<p>\n1 10 G\n</p>\n<p>\n2 2 6 TTGT\n</p>\n<h3>\n【样例输出2】\n</h3>\n<p>\n0\n</p>\n<p>\n3\n</p>\n<p>\n1\n</p>\n<h3>\n【来源】\n</h3>\n<p>\n<strong><u>CodeForces</u></strong> \n</p>\n<p>\n<a href=\"http://codeforces.com/contest/828/problem/E\" target=\"_blank\">http://codeforces.com/contest/828/problem/E</a> \n</p>\n\n"}]}