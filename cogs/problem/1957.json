{"title":"[HNOI2015]接水果","time_limit":6000,"memory_limit":512,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vQJimkPgW","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n风见幽香非常喜欢玩一个叫做 osu!的游戏，其中她最喜欢玩的模式就是接水果。由于她已经DT FC 了The big black,  她觉得这个游戏太简单了，于是发明了一个更加难的版本。首先有一个地图，是一棵由 n 个顶点、n-1 条边组成的树（例如图 1给出的树包含 8 个顶点、7 条边）。这颗树上有 P 个盘子，每个盘子实际上是一条路径（例如图 1 中顶点 6 到顶点 8 的路径），并且每个盘子还有一个权值。第 i 个盘子就是顶点a_i到顶点b_i的路径(由于是树，所以从a_i到b_i的路径是唯一的)，\n</p>\n<p>\n权值为c_i。接下来依次会有Q个水果掉下来，每个水果本质上也是一条路径，第i 个水果是从顶点 u_i 到顶点v_i 的路径。幽香每次需要选择一个盘子去接当前的水果：一个盘子能接住一个水果，当且仅当盘子的路径是水果的路径的子路径（例如\n</p>\n<p>\n图1中从 3到7 的路径是从1到8的路径的子路径）。这里规定:从a 到b的路径与从b到 a的路径是同一条路径。当然为了提高难度，对于第 i 个水果，你需要选择能接住它的所有盘子中，权值第 k_i 小的那个盘子，每个盘子可重复使用（没有使用次数\n</p>\n<p>\n的上限：一个盘子接完一个水果后，后面还可继续接其他水果，只要它是水果路径的子路径）。幽香认为这个游戏很难，你能轻松解决给她看吗？ \n</p>\n<p>\n<img src=\"/upload/image/20150427/20150427074828_14837.png\" alt=\"\"/> \n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n第一行三个数 n和P 和Q，表示树的大小和盘子的个数和水果的个数。\n</p>\n<p>\n接下来n-1 行，每行两个数 a、b，表示树上的a和b 之间有一条边。树中顶点按1到 n标号。\n</p>\n<p>\n接下来 P 行，每行三个数 a、b、c，表示路径为 a 到 b、权值为 c 的盘子，其中0≤c≤10^9，a不等于b。\n</p>\n<p>\n接下来Q行，每行三个数 u、v、k，表示路径为 u到 v的水果，其中 u不等于v，你需要选择第 k小的盘子，第k 小一定存在。\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n对于每个果子，输出一行表示选择的盘子的权值。\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre>10 10 10\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n9 10\n3 2 217394434\n10 7 13022269\n6 7 283254485\n6 8 333042360\n4 6 442139372\n8 3 225045590\n10 4 922205209\n10 8 808296330\n9 2 486331361\n4 9 551176338\n1 8 5\n3 8 3\n3 8 4\n1 8 3\n4 8 1\n2 3 1\n2 3 1\n2 3 1\n2 4 1\n1 4 1\n</pre>\n<h3>\n【样例输出】\n</h3>\n<pre>442139372\n333042360\n442139372\n283254485\n283254485\n217394434\n217394434\n217394434\n217394434\n217394434\n</pre>\n<h3>\n【提示】\n</h3>\n<p>\n<img src=\"/upload/image/20150427/20150427080723_36191.png\" alt=\"\"/> \n</p>\n\n"}]}