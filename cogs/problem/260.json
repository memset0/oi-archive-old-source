{"title":"[NOI 2002] 银河英雄传说","time_limit":3000,"memory_limit":128,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=pXyNNiVea","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<div>\n<h3>\n<b>【问题描述】</b> \n</h3>\n    公元五八○一年，地球居民迁移至金牛座α第二行星，在那里发表银河联邦创立宣言，同年改元为宇宙历元年，并开始向银河系深处拓展。\n</div>\n<div>\n    宇宙历七九九年，银河系的两大军事集团在巴米利恩星域爆发战争。泰山压顶集团派宇宙舰队司令莱因哈特率领十万余艘战舰出征，气吞山河集团点名将杨威利组织麾下三万艘战舰迎敌。\n</div>\n<div>\n    杨威利擅长排兵布阵，巧妙运用各种战术屡次以少胜多，难免恣生骄气。在这次决战中，他将巴米利恩星域战场划分成30000列，每列依次编号为1, 2, …, 30000。之后，他把自己的战舰也依次编号为1, 2, …, 30000，让第i号战舰处于第i列(i = 1, 2, …, 30000)，形成“一字长蛇阵”，诱敌深入。这是初始阵形。当进犯之敌到达时，杨威利会多次发布合并指令，将大部分战舰集中在某几列上，实施密集攻击。合并指令为M i j，含义为让第i号战舰所在的整个战舰队列，作为一个整体(头在前尾在后)接至第j号战舰所在的战舰队列的尾部。显然战舰队列是由处于同一列的一个或多个战舰组成的。合并指令的执行结果会使队列增大。\n</div>\n<div>\n    然而，老谋深算的莱因哈特早已在战略上取得了主动。在交战中，他可以通过庞大的情报网络随时监听杨威利的舰队调动指令。\n</div>\n<div>\n    在杨威利发布指令调动舰队的同时，莱因哈特为了及时了解当前杨威利的战舰分布情况，也会发出一些询问指令：C i j。该指令意思是，询问电脑，杨威利的第i号战舰与第j号战舰当前是否在同一列中，如果在同一列中，那么它们之间布置有多少战舰。\n</div>\n<div>\n    作为一个资深的高级程序设计员，你被要求编写程序分析杨威利的指令，以及回答莱因哈特的询问。\n</div>\n<div>\n    最终的决战已经展开，银河的历史又翻过了一页……\n</div>\n<h3>\n【输入格式】\n</h3>\n<div>\n输入文件galaxy.in的第一行有一个整数T（1&lt;=T&lt;=500,000），表示总共有T条指令。\n</div>\n<div>\n以下有T行，每行有一条指令。指令有两种格式：\n</div>\n<ol>\n<li>\nM i j ：i和j是两个整数（1&lt;=i , j&lt;=30000），表示指令涉及的战舰编号。该指令是莱因哈特窃听到的杨威利发布的舰队调动指令，并且保证第i号战舰与第j号战舰不在同一列。\n</li>\n<li>\nC i j ：i和j是两个整数（1&lt;=i , j&lt;=30000），表示指令涉及的战舰编号。该指令是莱因哈特发布的询问指令。\n</li>\n</ol>\n<h3>\n【输出格式】\n</h3>\n<div>\n输出文件为galaxy.out。你的程序应当依次对输入的每一条指令进行分析和处理：\n</div>\n<div>\n如果是杨威利发布的舰队调动指令，则表示舰队排列发生了变化，你的程序要注意到这一点，但是不要输出任何信息；\n</div>\n<div>\n如果是莱因哈特发布的询问指令，你的程序要输出一行，仅包含一个整数，表示在同一列上，第i号战舰与第j号战舰之间布置的战舰数目。如果第i号战舰与第j号战舰当前不在同一列上，则输出-1。\n</div>\n<h3>\n【样例输入】\n</h3>\n<pre>4\nM 2 3\nC 1 2\nM 2 4\nC 4 2\n</pre>\n<h3>\n样例输出\n</h3>\n<pre>-1\n1\n</pre>\n<h3>\n【样例说明】\n</h3>\n<div>\n战舰位置图：表格中阿拉伯数字表示战舰编号\n</div>\n<table width=\"480\" cellspacing=\"0\" cellpadding=\"0\" border=\"1\">\n<tbody>\n<tr>\n<th width=\"80\">\n \n</th>\n<th width=\"80\">\n第一列\n</th>\n<th width=\"80\">\n第二列\n</th>\n<th width=\"80\">\n第三列\n</th>\n<th width=\"80\">\n第四列\n</th>\n</tr>\n<tr>\n<td height=\"20\" align=\"center\">\n初始时\n</td>\n<td align=\"center\">\n1\n</td>\n<td align=\"center\">\n2\n</td>\n<td align=\"center\">\n3\n</td>\n<td align=\"center\">\n4\n</td>\n<td align=\"center\">\n……\n</td>\n</tr>\n<tr>\n<td height=\"20\" align=\"center\">\nM 2 3\n</td>\n<td align=\"center\">\n1\n</td>\n<td align=\"center\">\n3<br/>\n2\n</td>\n<td align=\"center\">\n4\n</td>\n<td align=\"center\">\n……\n</td>\n</tr>\n<tr>\n<td height=\"20\" align=\"center\">\nC 1 2\n</td>\n<td colspan=\"5\" align=\"center\">\n1号战舰与2号战舰不在同一列，因此输出-1\n</td>\n</tr>\n<tr>\n<td height=\"20\" align=\"center\">\nM 2 4\n</td>\n<td align=\"center\">\n1\n</td>\n<td align=\"center\">\n4<br/>\n3<br/>\n2\n</td>\n<td align=\"center\">\n……\n</td>\n</tr>\n<tr>\n<td height=\"20\" align=\"center\">\nC 4 2\n</td>\n<td colspan=\"5\" align=\"center\">\n4号战舰与2号战舰之间仅布置了一艘战舰，编号为3，输出1\n</td>\n</tr>\n</tbody>\n</table>\n<p>\n<br/>\n</p>\n\n"}]}