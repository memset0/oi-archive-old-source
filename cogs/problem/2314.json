{"title":"[HZOI 2015] Persistable Editor","time_limit":1000,"memory_limit":128,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vyyiSVjkq","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n维护一种可持久化的文本编辑器,支持下列操作:\n</p>\n<p>\n1 p str 在当前版本的第p个字符后插入字符串str,并作为下一版本(数据保证0&lt;=p&lt;=当前字符串的长度,且插入的字符串中只有小写字母)\n</p>\n<p>\n2 p c 在当前版本中删除从第p个字符开始的后c个字符,并作为下一版本(包含第p个字符,数据保证1&lt;=p&lt;=当前字符串的长度,且p+c-1&lt;=当前字符串的长度)\n</p>\n<p>\n3 x p c 输出第x个版本从第p个字符开始的后c个字符(包含第p个字符,数据保证1&lt;=p&lt;=第x个版本的字符串的长度,且p+c-1&lt;=第x个版本的字符串的长度)\n</p>\n<p>\n为了体现在线,你需要维护一个变量d,在3操作之后,d加上你输出字符串中字符&#39;c&#39;的数量,并且在数据中给出的操作1中的p,操作2中的p和c,操作3中的x,p,c均为加上变量d的结果,你需要把它们减去d之后运算\n</p>\n<p>\n开始时为空串,d=0,且为版本0,每进行操作1,2就会以上一版本的基础上修改形成下一版本\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n第一行一个数n,表示有n个操作\n</p>\n<p>\n下面n行,第一个数字为op,表示操作类型\n</p>\n<p>\nop=1时表示第一种操作,后面有一个数p和一个字符串str,意义同上面的描述,在操作之前,你需要将p减去d,才能得到正确的p,d的意义同上面的描述,表示你之前第三种操作输出的所有字符串中字符&#39;c&#39;的数量\n</p>\n<p>\nop=2时表示第二种操作,后面有两个数p,c,意义同上面的描述,在操作之前,你需要将p和c减去d,才能得到正确的p和c,d的意义同上面的描述,表示你之前第三种操作输出的所有字符串中字符&#39;c&#39;的数量\n</p>\n<p>\nop=3时表示第三种操作,后面有三个数x,p,c,意义同上面的描述,在操作之前,你需要将x,p和c减去d,才能得到正确的x,p和c,d的意义同上面的描述,表示你之前第三种操作输出的所有字符串中字符&#39;c&#39;的数量\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n对于每个第三种操作输出一行表示结果\n</p>\n<h3>\n【样例输入】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n6\n</p>\n<p>\n1 0 abcdefgh\n</p>\n<p>\n2 4 3\n</p>\n<p>\n3 1 2 5\n</p>\n<p>\n3 3 3 4\n</p>\n<p>\n1 4 xy\n</p>\n<p>\n3 5 4 6\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例输出】\n</h3>\n<p>\n<br/>\n</p>\n<p>\nbcdef\n</p>\n<p>\nbcg\n</p>\n<p>\nbxyc\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【提示】\n</h3>\n<p>\n对于样例解密的结果为\n</p>\n<p>\n6\n</p>\n<p>\n1 0 abcdefgh\n</p>\n<p>\n2 4 3\n</p>\n<p>\n3 1 2 5\n</p>\n<p>\n3 2 2 3\n</p>\n<p>\n1 2 xy\n</p>\n<p>\n3 3 2 4\n</p>\n<p>\n本题共20组测试数据,一个点5分,给出数据特征如下\n</p>\n<p>\n测试点编号 操作数量的规模 插入字符串的特点  插入字符串的最大长度\n</p>\n<p>\n<br/>\n</p>\n<p>\n 1      n =500        N/A            10\n</p>\n<p>\n 2      n =1000       N/A             10\n</p>\n<p>\n 3      n =10000   字符只有&#39;a&#39;,&#39;b&#39;      200\n</p>\n<p>\n 4      n =20000   字符只有&#39;a&#39;,&#39;b&#39;       200\n</p>\n<p>\n 5      n =30000   字符只有&#39;a&#39;,&#39;b&#39;       200\n</p>\n<p>\n 6      n =40000   字符只有&#39;a&#39;,&#39;b&#39;       200\n</p>\n<p>\n 7      n =50000   字符只有&#39;a&#39;,&#39;b&#39;       200\n</p>\n<p>\n 8      n =100000  字符只有&#39;a&#39;,&#39;b&#39;       200\n</p>\n<p>\n 9     n =100000  字符只有&#39;a&#39;          200\n</p>\n<p>\n 10     n =100000  字符只有&#39;c&#39;          200\n</p>\n<p>\n 11     n =10000       N/A            200\n</p>\n<p>\n 12    n =20000       N/A            200\n</p>\n<p>\n 13    n =30000       N/A            200\n</p>\n<p>\n 14    n =40000       N/A            200\n</p>\n<p>\n 15    n =50000       N/A            200\n</p>\n<p>\n 16    n =60000       N/A            200\n</p>\n<p>\n 17    n =70000       N/A            200\n</p>\n<p>\n 18    n =80000       N/A            200\n</p>\n<p>\n 19    n =90000       N/A            200\n</p>\n<p>\n 20    n =100000      N/A            200\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【来源】\n</h3>\n<p>\nby stdafx\n</p>\n<p>\nps:题目异常丑陋,凑合看吧,我只是想普及下rope和可持久化平衡树\n</p>\n<p>\npps:数据真难造,比标算还难写\n</p>\n\n"}]}