{"title":"[WC 2014] 紫荆花之恋","time_limit":20000,"memory_limit":512,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vySiNVkeP","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n强强和萌萌是一对好朋友。有一天他们在外面闲逛，突然看到前方有一棵紫荆树。这已经是紫荆花飞舞的季节了，无数的花瓣以肉眼可见的速度从紫荆树上长了出来。\n</p>\n<p>\n仔细看看的话，这棵大树实际上是一个带权树。每个时刻他会长出一个新的叶子节点。每个节点上有一个可爱的小精灵，新长出的节点上也会同时出现一个新的小精灵。小精灵是很萌但是也很脆弱的生物，每个小精灵i都有一个感受能力ri，小精灵i,j成为朋友当且仅当在树上i和j的距离dist(i,j)&lt;=ri+rj，其中dist(i,j)表示在这棵树上i和j的唯一路径上所有边的边权和。\n</p>\n<p>\n强强和萌萌很好奇每次新长出了一个叶子节点之后这棵树上总共有几对朋友。\n</p>\n<p>\n我们假定这棵树一开始为空，节点按照加入的顺序从1开始编号。由于强强非常好奇，你必须在每次出现新的节点后马上给出总共的朋友对数不能拖延哦。\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n输入文件共有n+2行。\n</p>\n<p>\n第一行包含一个正整数T，表示测试点编号。\n</p>\n<p>\n第二行包含一个正整数n，表示总共要加入的节点数。\n</p>\n<p>\n我们令加入前的总共朋友对数是last_ans，在一开始时last_ans=0。\n</p>\n<p>\n接下来n行中第i行有三个数ai,ci,ri，表示节点i的父亲节点的编号为(ai xor ( last_ans mod 10^9))，与父亲节点之间的边权为ci，节点i上小精灵的感受能力为ri。\n</p>\n<p>\n注意a1=c1=0，表示1号点是根节点。对于i&gt;=2，父亲节点的编号至少是1，至多是i-1。\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n输出文件包含n行，每行输出1个整数，表示加入第i个点之后，树上共有几对朋友。\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre>0\n5\n0 0 6\n1 2 4\n0 9 4\n0 5 5\n0 2 4</pre>\n<h3>\n【样例输出】\n</h3>\n<pre>0\n1\n2\n4\n7</pre>\n<h3>\n【提示】\n</h3>\n<p>\n<br/>\n</p>\n<pre>对于所有数据，满足1&lt;=ci&lt;=10000,ai&lt;=2*10^9,ri&lt;=10^9\n<p>\n<br/>\n\n</p>\n\n<p>\n------------------------------------------------------------\n\n            |  测试点编号  |                   约定                    |\n\n            ------------------------------------------------------------\n\n            |    1,2       |                  n&lt;=100                   |\n\n            ------------------------------------------------------------\n\n            |    3,4       |                  n&lt;=1000                  |\n\n            ------------------------------------------------------------\n\n            |  5,6,7,8     |   n&lt;=100000，节点1至多两个子节点，        |\n\n            |              |        其他节点至多一个子节点             |\n\n            ------------------------------------------------------------\n\n            |    9,10      |           n&lt;=100000，ri&lt;=10               |\n\n            ------------------------------------------------------------\n\n            |   11,12      |      n&lt;=100000，这棵树是随机生成的        |\n\n            ------------------------------------------------------------\n\n            | 13,14,15     |                 n&lt;=70000                  |\n\n            ------------------------------------------------------------\n\n            |16,17,18,19,20|                 n&lt;=100000                 |\n\n            ------------------------------------------------------------\n</p>\n</pre>\n<p>\n<br/>\n</p>\n<h3>\n【来源】\n</h3>\n<p>\n在此键入。\n</p>\n\n"}]}