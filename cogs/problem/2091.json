{"title":"[SYOI 2015] Asm.Def的打击序列","time_limit":4000,"memory_limit":256,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vQxmzVaPk","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n白色圆柱形的“蓝翔”号在虚空中逐渐变大，一声沉闷的撞击后停住不动。空气阀开始“嘶嘶”作响。\n</p>\n<p>\nAsm.Def钻出舱门，杜舰长热情地向他伸出右手，“来者可是Asm.Def？”\n</p>\n<p>\n“正是。”他趁着握手将U盘递给舰长，“这里是所有目标位置，方教授说控制太空就靠你了，否则咱的通信卫星就是一坨废物。”\n</p>\n<p>\n“没问题，就用这个，保证让它们灰飞烟灭。”杜舰长调出全息图像，是个细长的针状物体。\n</p>\n<p>\n“阿姆斯特朗回旋加速喷气式阿姆斯特朗动能弹，”舰长介绍道，“本来想用强相互作用力材料，可惜没弄成，但撞击结构关键点，普通合金也够了。”\n</p>\n<p>\n“雷达数据有误怎么办？靠信仰？”Asm.Def质疑。\n</p>\n<p>\n“放心吧，我每个月都替它交党费。”\n</p>\n<p>\n<img src=\"/upload/image/20151104/20151104055959_99283.png\" alt=\"\"/> \n</p>\n<p>\nAsm.Def需要帮忙制定打击序列。我们可以把所有目标看做一个N个点，M条边的边带权有向图，每个点都是一个目标。\n</p>\n<p>\n有两种手段：动能弹和激光。\n</p>\n<p>\nAsm.Def可以发射若干枚（也可以是零枚）动能弹。每一枚动能弹会沿图中一条简单路径或简单环飞行：\n</p>\n<p>\n简单路径形如p1-&gt;p2-&gt;…-&gt;pk，其中p1~pk互不相等，且(p1,p2)，(p2,p3)…(pk-1,pk)均为图中的有向边。这时目标p2,p3,…,pk会被摧毁，但p1未被摧毁（因为动能弹在p1处尚未充分加速）。\n</p>\n<p>\n简单环形如p1-&gt;p2-&gt;…-&gt;pk-&gt;p1，其中p1~pk互不相等，且(p1,p2)，(p2,p3)…(pk,p1)均为图中的有向边。这时目标p1,p2,…,pk都会被摧毁。\n</p>\n<p>\n一个目标至多出现在一枚动能弹的路径上（即所有动能弹的路径互不相交，包括简单路径中的p1），因为目标碎片十分危险。\n</p>\n<p>\n动能弹的费用是它飞行路径的边权之和。\n</p>\n<p>\n除了动能弹，也可以用激光摧毁一个目标，费用是C。\n</p>\n<p>\nAsm.Def希望算出摧毁所有目标的最小费用。\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n第1行3个整数：N,M,C。\n</p>\n<p>\n接下来M行，每行3个整数s,t,v，代表有一条s-&gt;t的有向边，边权为v。\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n1行1个整数，即摧毁所有目标的最小费用。\n</p>\n<h3>\n【样例输入1】\n</h3>\n<pre>4 3 10\n1 2 2\n2 3 2\n3 1 2</pre>\n<h3>\n【样例输出1】\n</h3>\n<pre>16</pre>\n<h3>\n【样例输入2】\n</h3>\n<pre>6 5 5\n1 3 2\n2 3 2\n3 4 2\n4 5 2\n4 6 2</pre>\n<h3>\n【样例输出2】\n</h3>\n<pre>21</pre>\n<h3>\n【提示】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n样例1：一枚动能弹路径为1-&gt;2-&gt;3，花费6，用激光摧毁4，花费10.\n</p>\n<p>\n样例2：一枚动能弹路径为1-&gt;3-&gt;4-&gt;5，花费6，用激光摧毁1,2,6，花费15.\n</p>\n<p>\n对于40%的数据，2&lt;=N&lt;=5，1&lt;=M&lt;=10.\n</p>\n<p>\n对于100%的数据，2&lt;=N&lt;=250，1&lt;=M&lt;=30000；s≠t；1&lt;=s,t&lt;=N；1&lt;=v,c&lt;=10000.\n</p>\n<p>\n两对城市间可能有多条路径，但不会有自环。\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【来源】\n</h3>\n<p>\n“Asm.Def战记之拉格朗日点”杯\n</p>\n\n"}]}