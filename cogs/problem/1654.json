{"title":"[BOI2001]破译密码","time_limit":0,"memory_limit":-1,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vXxySkegq","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n密码学是一种给信息编码的科技，使得只有特定的接收者才能解读它们。另一方面，密码分析学，是破译密码的科学。在这个问题中，假设你是一位密码分析学家，被雇用来破译一些在警察对当地黑手党总部的突袭中截获的加密信息。你的同行已经通过逆向工程得到了加密程序，剩下唯一要做的就是逆向分析加密算法并且猜测这些文件的密钥。与这些密文一起，警察还截获了一些明文，他们确信这些明文和密文来自相同的文章，因此在措辞，语法等方面有着相似的结构。\n</p>\n<h4>\n加密程序如下：\n</h4>\n<p>\nC语言版本：\n</p>\n<p>\n<br/>\n</p>\n<pre class=\"prettyprint lang-cpp\">/* crypto.c */\n\n#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;string.h&gt;\n\nconst int len = 10;\nconst char *let = &#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;;\n\nint main()\n{\n\tchar s1[250], s2[250];\n\tFILE *f1, *f2;\n\tunsigned char key[len];\n\tint i, k, c;\n\tchar *p;\n\n\tprintf(&#34;Input file: &#34;); gets(s1);\n\tf1 = fopen(s1, &#34;rt&#34;);\n\tprintf(&#34;Output file: &#34;); gets(s2);\n\tf2 = fopen(s2, &#34;wt&#34;);\n\tprintf(&#34;Key (%d bytes): &#34;, len);\n\tfor (i = 0; i &lt; len; ++i) scanf(&#34;%d&#34;, &amp;key[i]);\n\tk = 0;\n\twhile ((c = fgetc(f1)) != EOF) {\n\t\tp = strchr(let, toupper(c));\n\t\tif (p != NULL) {\n\t\t\ti = ((p - let) + key[k]) % strlen(let);\n\t\t\tc = let[i];\n\t\t\tk = (k + 1) % len;\n\t\t}\n\t\tfputc(c, f2);\n\t}\n\tfclose(f1);\n\tfclose(f2);\n\treturn 0;\n}\n</pre>\nPascal语言版本：\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n<pre class=\"prettyprint\">{ crypto.pas }\n\nconst\n\tlen = 10;\n\tlet = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;;\nvar\n\ts1, s2 : string;\n\tf1, f2 : text;\n\tkey : array [1..len] of byte;\n\ti, k : integer;\n\tc : char;\nbegin\n\twrite (&#39;Input file: &#39;); readln (s1);\n\tassign (f1, s1); reset (f1);\n\twrite (&#39;Output file: &#39;); readln (s2);\n\tassign (f2, s2); rewrite (f2);\n\twrite (&#39;Key (&#39;, len, &#39; bytes): &#39;);\n\tfor i := 1 to len do read (key[i]);\n\tk := 0;\n\twhile not eof (f1) do begin\n\t\twhile not eoln (f1) do begin\n\t\t\tread (f1, c);\n\t\t\ti := pos (upcase (c), let);\n\t\t\tif i &gt; 0 then begin\n\t\t\t\tk := k mod len + 1;\n\t\t\t\ti := (i - 1 + key[k]) mod length (let) + 1;\n\t\t\t\tc := let[i];\n\t\t\tend;\n\t\t\twrite (f2, c);\n\t\tend;\n\t\tif not eof (f1) then begin\n\t\t\treadln (f1);\n\t\t\twriteln (f2);\n\t\tend;\n\tend;\n\tclose (f1);\n\tclose (f2);\nend.</pre>\n<p>\n<br/>\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n由于COGS的环境限定，本题的数据格式较为特殊。\n</p>\n<p>\n有5组测试数据。第i组数据包含两个.in文件：crai.in和cra(i+5).in。其中，前者是密文，后者是来源于相同文章的一段明文（即题目描述中所说的.txt文件）。\n</p>\n<p>\n例如，第1组数据是cra1.in和cra6.in，其中cra1.in是密文，cra6.in是相同来源的明文，第3组数据是cra3.in和cra8.in，其中cra3.in是密文，等等。\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n你需要提交10个.out文件：cra1.out~cra10.out。其中,cra1.out~cra5.out是五组数据破译后的结果，cra6.out~cra10.out的内容分别与cra6.in~cra10.in完全相同。\n</p>\n<h3>\n【来源】\n</h3>\n<p>\n<a target=\"_blank\" href=\"http://www.ii.uni.wroc.pl/boi/task/crazad.phtml\">BOI2001 Crack the Code</a> \n</p>\n\n"}]}