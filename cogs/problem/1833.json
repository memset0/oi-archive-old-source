{"title":"[国家集训队2011]复杂的大门","time_limit":1000,"memory_limit":256,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vSXxxkUjj","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n<span style=\"font-size:16px;\">你去找某bm玩，到了门口才发现要打开他家的大门不是一件容易的事……</span> \n</p>\n<p>\n<span style=\"font-size:16px;\">他家的大门外有n个站台，用1到n的正整数编号。你需要对每个站台访问一定次数以后大门才能开启。站台之间有m个单向的传送门，通过传送门到达另一个站台不需要花费任何代价。而如果不通过传送门，你就需要乘坐公共汽车，并花费1单位的钱。值得庆幸的是，任意两个站台之间都有公共汽车直达。</span> \n</p>\n<p>\n<span style=\"font-size:16px;\">现在给你每个站台必须访问的次数Fi，对于站台i，你必须恰好访问Fi次（不能超过）。</span> \n</p>\n<p>\n<span style=\"font-size:16px;\">我们用u、v、w三个参数描述一个传送门，表示从站台u到站台v有一个最多可以使用w次的传送门（不一定要使用w次）。值得注意的是，对于任意一对传送门(u1,v1)和(u2,v2)，如果有u1 &lt; u2，则有v1 ≤ v2；如果有v1 &lt; v2，则有u1 ≤ u2；且u1 = u2和v1 = v2不同时成立。</span> \n</p>\n<p>\n<span style=\"font-size:16px;\">你可以从任意的站台开始，从任意的站台结束。出发去开始的站台需要花费1单位的钱。你需要求出打开大门最少需要花费多少单位的钱。</span> \n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n第一行包含两个正整数n、m，意义见题目描述。\n</p>\n<p>\n第二行包含n个正整数，第i个数表示Fi。\n</p>\n<p>\n接下来有m行，每行有三个正整数u、v、w，表示从u到v有一个可以使用w次的传送门。\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n输出一行一个整数，表示打开大门最少花费的钱数。\n</p>\n<h3>\n【样例输入】\n</h3>\n<p>\n4 3\n</p>\n<p>\n5 5 5 5\n</p>\n<p>\n1 2 1\n</p>\n<p>\n3 2 1\n</p>\n<p>\n3 4 1\n</p>\n<h3>\n【样例输出】\n</h3>\n<p>\n17\n</p>\n<h3>\n【提示】\n</h3>\n<p>\n有20%的数据满足n ≤ 10，m ≤ 50；对于所有的w、Fi，满足1 ≤ w,Fi ≤ 10；有50%的数据满足n ≤ 1000，m ≤ 10000；\n</p>\n<p>\n对于100%的数据满足1 ≤ n ≤ 10000，1 ≤ m ≤ 100000；\n</p>\n<p>\n对于所有的u、v，满足1 ≤ u, v ≤ n，u ≠ v；\n</p>\n<p>\n对于所有的w、Fi，满足1 ≤ w,Fi ≤ 50000；\n</p>\n<p>\n以上的每类数据中都存在50%的数据满足对于所有的w、Fi，有w = Fi = 1。\n</p>\n<h3>\n【来源】\n</h3>\n<p>\n集训队互测2011 陈许旻\n</p>\n\n"}]}