{"title":"交错和查询","time_limit":3000,"memory_limit":256,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vyNNiVeaa","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n\n<p>\n【题目描述】\n</p>\n<p>\n<br/>\n</p>\n<p>\n无限循环数字串S由长度为n的循环节s构成。设s为12345(n=5)，则数字串S为123451234512345…\n</p>\n<p>\n设Si为S的第i位数字，在上面的例子中，S1=1，S2=2，S6=1。\n</p>\n<p>\n设S的一个子串S[l,r]的交错和为sum(l,r)：\n</p>\n<p>\nsum(l,r) = Sl - S1+1 + Sl+2 - Sl+3 + … + (-1)r-lSr\n</p>\n<p>\n如sum(2,7) = 2 - 3 + 4 - 5 + 1 - 2 = -3\n</p>\n<p>\n<br/>\n</p>\n<p>\n现给定循环节s，要求支持两种操作：\n</p>\n<p>\n1 pos digit：\n</p>\n<p>\n修改循环节s上的某一位，即将spos改为digit。\n</p>\n<p>\n2 l r：\n</p>\n<p>\n求S[l,r]内所有子串的交错和的和，即\n</p>\n<p>\n<br/>\n</p>\n<p>\n输出ans对109+7的模。\n</p>\n<p>\n<br/>\n</p>\n<p>\n【输入格式】\n</p>\n<p>\n<br/>\n</p>\n<p>\n第一行一个整数n，表示循环节s的长度。\n</p>\n<p>\n第二行一个长度为n的数字串，表示循环节s。\n</p>\n<p>\n第三行一个整数m，表示操作次数。\n</p>\n<p>\n以下m行，每行3个整数。\n</p>\n<p>\n若第一个数为1，表示是修改操作1 pos digit。\n</p>\n<p>\n若第一个数为2，表示是询问操作2 l r。\n</p>\n<p>\n<br/>\n</p>\n<p>\n【输出格式】\n</p>\n<p>\n<br/>\n</p>\n<p>\n对于每个询问操作输出一行，表示答案。\n</p>\n<p>\n<br/>\n</p>\n<p>\n【样例输入】\n</p>\n<p>\n5\n</p>\n<p>\n12345\n</p>\n<p>\n5\n</p>\n<p>\n2 1 5\n</p>\n<p>\n2 6 10\n</p>\n<p>\n1 3 5\n</p>\n<p>\n2 1 5\n</p>\n<p>\n2 1 6\n</p>\n<p>\n【样例输出】\n</p>\n<p>\n19\n</p>\n<p>\n19\n</p>\n<p>\n25\n</p>\n<p>\n36\n</p>\n<p>\n【数据范围】\n</p>\n<p>\n<br/>\n</p>\n<p>\n对于10%的数据点，n, m &lt;= 50；\n</p>\n<p>\n对于20%的数据点，n, m &lt;= 1000；\n</p>\n<p>\n对于40%的数据点，1 &lt;= l &lt;= r &lt;= n；\n</p>\n<p>\n对于100%的数据点，n, m &lt;= 200000；1 &lt;= l &lt;= r &lt;= 1018；1 &lt;= pos &lt;= n；0 &lt;= digit &lt;= 9；\n</p>\n\n"}]}