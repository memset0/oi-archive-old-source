{"title":"[HZOI 2015] Keller与驴蛋蛋与海蜇","time_limit":4000,"memory_limit":64,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vmzSmVeee","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n<img src=\"/upload/image/20170418/20170418182832_34725.jpeg\" alt=\"\"/> \n</p>\n<p>\n众所周知，海蜇是一个有$C$个点$C$条边的无向连通图\n</p>\n<p>\n现在$Keller$想要吃海蜇，驴蛋蛋自告奋勇的去抓。\n</p>\n<p>\n抓海蜇要先到达大海，$Keller$为驴蛋蛋提供了一种交通工具，使驴蛋蛋可以在$K$维空间中任意爬行(?)\n</p>\n<p>\n一开始驴蛋蛋在原点$(0,0,0,0…0)$,每一秒钟驴蛋蛋要在某一维上向远离原点的方向移动一步。比如在$2$维空间中，驴蛋蛋只能以$(+1,0)$,$(0,+1)$的步长移动,而$(0,-1)$,$(-1,0)$和$(0,0)$的步长都是不被允许的。也就是说驴蛋蛋每秒必须使TA的某一维坐标增加1。\n</p>\n<p>\n现在驴蛋蛋想知道他在多少秒后到达点$(N,N,N,…N)$。\n</p>\n<p>\n然而$Keller$却想知道驴蛋蛋到达点$(N,N,N…N)$的方案数是多少,两种方案不同当且仅当某一秒钟驴蛋蛋的移动决策不同。\n</p>\n<p>\n$Keller$告诉驴蛋蛋,若驴蛋蛋某时刻的坐标是$(a1,a2,a3…ak)$,那么必须有$a1\\ge a2\\ge a3\\ge…\\ge ak$\n</p>\n<p>\n驴蛋蛋傻了，请你帮助驴蛋蛋做出来。\n</p>\n<p>\n答案对P取模。$P=a*2^k+1$保证$a,P$均为质数且$k\\ge 16$\n</p>\n<p>\n$P≤2*10^9,k≥16,N\\le3*10^4,2\\le K\\le 3*10^4$\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n第一行有一个整数$P$和一个整数$T$,$T$表示有$T$组测试数据$(T\\le1000)$\n</p>\n<p>\n然后接下来有$T$行,每行两个正整数$K,N$\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n每行一个整数表示$Keller$要求的答案\n</p>\n<h3>\n【样例输入】\n</h3>\n<p>\n469762049 3\n</p>\n<p>\n2 116\n</p>\n<p>\n4 69\n</p>\n<p>\n3 15\n</p>\n<h3>\n【样例输出】\n</h3>\n<p>\n291788030\n</p>\n<p>\n323538158\n</p>\n<p>\n250998049\n</p>\n<span style=\"font-family:monospace;\"></span> \n<h3>\n【提示】\n</h3>\n<p>\n前$50\\%$的数据满足$2\\le K\\le 5$\n</p>\n<h3>\n【来源】\n</h3>\n<p>\n<a href=\"http://cogs.pro/cogs/user/detail.php?uid=5061\">驴蛋蛋</a>的脑冻\n</p>\n<p>\n<br/>\n</p>\n\n"}]}