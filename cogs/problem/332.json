{"title":"[NOI2002] 机器人M号","time_limit":1000,"memory_limit":128,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=pXNyJijjV","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<p>\n【问题描述】\n</p>\n<p>\n3030年，Macsy正在火星部署一批机器人。\n</p>\n<p>\n第1秒，他把机器人1号运到了火星，机器人1号可以制造其他的机器人。\n</p>\n<p>\n第2秒，机器人1号造出了第一个机器人——机器人2号。\n</p>\n<p>\n第3秒，机器人1号造出了另一个机器人——机器人3号。\n</p>\n<p>\n之后每一秒，机器人1号都可以造出一个新的机器人。第m秒造出的机器人编号为m。我们可以称它为机器人m号，或者m号机器人。\n</p>\n<p>\n<br/>\n机器人造出来后，马上开始工作。m号机器人，每m秒会休息一次。比如3号机器人，会在第6，9，12，……秒休息，而其它时间都在工作。\n</p>\n<p>\n机器人休息时，它的记忆将会被移植到当时出生的机器人的脑中。比如6号机器人出生时，2，3号机器人正在休息，因此，6号机器人会收到第2，3号机器人的记忆副本。我们称第2，3号机器人是6号机器人的老师。\n</p>\n<p>\n如果两个机器人没有师徒关系，且没有共同的老师，则称这两个机器人的知识是互相独立的。注意：1号机器人与其他所有机器人的知识独立（因为只有1号才会造机器人），它也不是任何机器人的老师。\n</p>\n<p>\n<br/>\n一个机器人的独立数，是指所有编号比它小且与它知识互相独立的机器人的个数。比如1号机器人的独立数为0，2号机器人的独立数为1（1号机器人与它知识互 相独立），6号机器人的独立数为2（1，5号机器人与它知识互相独立，2，3号机器人都是它的老师，而4号机器人与它有共同的老师——2号机器人）。\n</p>\n<p>\n新造出来的机器人有3种不同的职业。对于编号为m的机器人，如果能把m分解成偶数个不同奇素数的积，则它是政客，例如编号15；否则，如 果m本身就是奇素数或者能把m分解成奇数个不同奇素数的积，则它是军人，例如编号 3, 编号165。其它编号的机器人都是学者，例如编号2, 编号6, 编号9。\n</p>\n<p>\n<br/>\n第m秒诞生的机器人m号，想知道它和它的老师中，所有政客的独立数之和，所有军人的独立数之和，以及所有学者的独立数之和。可机器人m号忙于工作没时间计算，你能够帮助它吗？\n</p>\n<p>\n为了方便你的计算，Macsy已经帮你做了m的素因子分解。为了输出方便，只要求输出总和除以10000的余数。\n</p>\n<p>\n<br/>\n【输入文件】\n</p>\n<p>\n输入文件的第一行是一个正整数k(1&lt;=k&lt;=1000)，k是m的不同的素因子个数。\n</p>\n<p>\n以下k行，每行两个整数，pi, ei,表示m的第i个素因子和它的指数(i = 1, 2, …, k)。p1, p2, …, pk是不同的素数，m=p1^e1 * p2^e2 * ... * pk^ek。所有素因子按照从小到大排列，即p1<p2<…<pk。输入文件中，2<=pi<10,000, 1<=\"ei&lt;=1,000,000。&lt;/p\"></p2<…<pk。输入文件中，2<=pi<10,000,>\n</p>\n<p>\n<br/>\n【输出文件】\n</p>\n<p>\n输出文件包括三行。\n</p>\n<p>\n第一行是机器人m号和它的老师中，所有政客的独立数之和除以10000的余数。\n</p>\n<p>\n第二行是机器人m号和它的老师中，所有军人的独立数之和除以10000的余数。\n</p>\n<p>\n第三行是机器人m号和它的老师中，所有学者的独立数之和除以10000的余数。\n</p>\n<p>\n<br/>\n【样例输入】\n</p>\n<pre>3\n2 1\n3 2\n5 1\n</pre>\n<p>\n【样例输出】\n</p>\n<pre>8\n6\n75\n</pre>\n<p>\n【样例说明】\n</p>\n<p>\nm=2*3*3*5=90。90号机器人有10个老师，加上它自己共11个。其中政客只有15号；军人有3号和5号；学者有8个，它们的编号分别是：2,6,9,10,18,30,45,90。\n</p>\n\n"}]}