{"title":"物质起源","time_limit":1000,"memory_limit":256,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vNmQJkPgV","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n<p>\n自然界的各种物质都是由化学元素组成的，有可能是直接的单质，也可能是化合物，也可能是由单质或化合物混合起来的混合物。\n</p>\n<p>\n最近，中国资深的化学家、诺贝尔化学奖获得者伍华兵教授，与另一位中国资深的化学家、诺贝尔化学奖获得者魏毅教授正在对物质的起源作深入的研究。前些日子，伍教授和魏教授的研究进展非常快，可是，最近，他们的研究出现了一点点问题。\n</p>\n<p>\n作为他们的好朋友，一向从事计算机科学与技术研究的Jelly教授在与他们交谈的过程中了解到了他们的困难，并发现这个问题可以用计算机来解决，在问清楚问题后，Jelly教授很高兴的对伍教授和魏教授说：“这个问题难不倒我，看我的吧，我保证在3小时内给你们编出一个很好的解决这个问题的程序。”可当Jelly教授刚从两位教授的实验室回到家，就接到中国国防部部长的紧急邀请，请他去解决一个至关重大的军事问题(什么问题？嗨，标着最高机密的，我可不敢说出来)。可Jelly教授是一个很讲诚信的人，在过去的30061986次许诺中，他按时按质按量完成了30061985次，只有一次是对方由于某种原因在Jelly教授即将完成时说不用完成了而没完成的。所以，Jelly教授一定要完成这个许诺。怎么办呢？他把任务交给了你，他忠实能干的助手，他相信你一定能完成这个程序。他如此的信任你，你可要好好干呀。\n</p>\n<p>\n他把任务写在了一些纸上，然后就匆匆的走了。\n</p>\n<p>\n你看了看他留下的那张纸，只见每张纸都写满了化学方程式，所有的纸张叠起来有人那么高(##%·……·%……)，你这个吓坏了，不过，还好，Jelly教授的字向来写得比较大。\n</p>\n<p>\n你从头到尾翻完所有的纸，发现纸上除了大小写英文字母、数字、圆括号、加号、等号外，再也没有其他的符号了。其中，每个方程式都是A1+A2+……+Ap=B1+B2+……+Bq的形式， 表示物质A1,A2,……和Ap反应，生成了物质B1,B2,……,Bq。其中A1,A2,……,Ap,B1,B2,……,Bq都是一种单质或化合物的化学式，长度不超过10个字符，p和q都不超过20。每个方程式的总长不超过100个字符。有些物质的化学式可能在现代社会的化学元素周期表里找不到，这是因为又发现了很多新元素。由于化学反应中可能有物理反应，所以可能产生新的元素。一种物质的化学式不会写成两种不同的形式。\n</p>\n<p>\n你翻呀翻，Jelly教授到底夸了什么海口呢？怎么全弄出一些方程式来了呢？你翻呀翻，翻到最后，终于看到了一行中文字：“能产生什么？”正当你迷茫之际，你忽然发现边上摆着一些化学药品。你终于明白了，问题就是用这些方程式和给定的药品可以产生哪些新的药品。\n</p>\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n<p>\n<sub></sub><sub></sub><sub></sub> \n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n输入文件的第一行包含一个数n(1≤n≤400)，表示有多少个方程式。\n</p>\n<p>\n接下来n行，每行一个方程式。\n</p>\n<p>\n再接下来的一行包含一个数m(1≤m≤500)，表示给出了多少种物质。\n</p>\n<p>\n接下来m行，每行是给出的一种物质的化学式。\n</p>\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n<p>\n输出文件的第一行包含一个数t，表示用这些方程和给出的物质可以产生多少种新的物质。\n</p>\n<p>\n在接下来的t行中，按ASCII码升序输出新物质的化学式，每行一个。\n</p>\n<p>\n<br/>\n</p>\n<p>\n<br/>\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre>4\nH2O+Na=NaOH+H2\nCl2+H2=HCl\nFe+O2=Fe3O4\nNaOH+HCl=H2O+NaCl\n3\nH2O\nNa\nCl2</pre>\n<h3>\n【样例输出】\n</h3>\n<pre>4\nH2\nHCl\nNaCl\nNaOH</pre>\n<h3>\n【提示】\n</h3>\n<p>\n在此键入。\n</p>\n<h3>\n【来源】\n</h3>\n<p>\n在此键入。\n</p>\n\n"}]}