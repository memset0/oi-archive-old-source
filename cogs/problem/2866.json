{"title":"[NOIP 2017] 逛公园","time_limit":3000,"memory_limit":512,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vxQNNVUee","statement":[{"title":"# 题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【问题描述】\n</h3>\n<p>\n策策同学特别喜欢逛公园。 公园可以看成一张N个点M条边构成的有向图，且没有自环和重边。其中1号点是公园的入口，N号点是公园的出口，每条边有一个非负权值，代表策策经过这条边所要花的时间。\n</p>\n<p>\n策策每天都会去逛公园，他总是从1号点进去，从N号点出来。\n</p>\n<p>\n策策喜欢新鲜的事物，他不希望有两天逛公园的路线完全一样，同时策策还是一个特别热爱学习的好孩子，他不希望每天在逛公园这件事上花费太多的时间。如果1号点到N号点的最短路长为d，那么策策只会喜欢长度不超过d + K的路线。\n</p>\n<p>\n策策同学想知道总共有多少条满足条件的路线，你能帮帮他吗？\n</p>\n<p>\n为避免输出过大，答案对P取模。\n</p>\n<p>\n如果有无穷多条合法的路线，请输出−1。\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n输入文件名为 park.in。\n</p>\n<p>\n第一行包含一个整数T, 代表数据组数。\n</p>\n<p>\n接下来T组数据，对于每组数据：\n</p>\n<p>\n第一行包含四个整数 N,M,K,P， 每两个整数之间用一个空格隔开。\n</p>\n<p>\n接下来M行，每行三个整数ai,bi,ci， 代表编号为ai,bi的点之间有一条权值为ci的有向边，每两个整数之间用一个空格隔开。\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n输出文件名为 park.out。\n</p>\n<p>\n输出文件包含T行，每行一个整数代表答案。\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre>2\n5 7 2 10\n1 2 1\n2 4 0\n4 5 2\n2 3 2\n3 4 1\n3 5 2\n1 5 3\n2 2 0 10\n1 2 0\n2 1 0\n</pre>\n<h3>\n【样例输出】\n</h3>\n<pre>3\n-1</pre>\n<h3>\n【提示】\n</h3>\n<p>\n对于第一组数据，最短路为 3。<br/>\n1 – 5, 1 – 2 – 4 – 5, 1 – 2 – 3 – 5 为 3 条合法路径。\n</p>\n<img alt=\"\" src=\"/upload/image/20171115/20171115093345_40503.jpg\" height=\"489\" width=\"635\"/><br/>\n\n"}]}