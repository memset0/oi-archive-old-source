{"title":"[UVa 11443] 网格里的树","time_limit":15000,"memory_limit":256,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=vmNQmkgVg","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n给你一个r行c列的网格。行被编号为0到r-1，列被编号为0到c-1.第i行第j列的点可以和点(i-1,j),(i,j-1),(i+1,j)和(i,j+1)连边，如果这些点存在。现在，网格中已经有了一些边。你可以向其中添加其他的边。你加边的方式必须使得网格中所有的点都连通，但没有环。你要计算出加边的方案总数。\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n输入包含多组数据。\n</p>\n<p>\n输入文件的第一行是一个整数T（1&lt;=T&lt;=30），即数据组数。\n</p>\n<p>\n接下来是T组数据。\n</p>\n<p>\n每组数据的第一行有3个整数r(1&lt;=r&lt;=200),c(1&lt;=c&lt;=8)和md(1&lt;=md&lt;=1000000)。\n</p>\n<p>\n接下来有2*r-1行，描述了网格和已经添加的边。\n</p>\n<p>\n每行有2*c-1个字符。\n</p>\n<p>\n下面，将这些行从0开始编号，将每行的字符也从0开始编号。\n</p>\n<p>\n偶数行的第偶数个字符将是一个&#39;.&#39;，代表一个点。\n</p>\n<p>\n偶数行的第奇数个字符是一个代表左右两点之间没有边的&#39;S&#39;，或是一个代表有边的&#39;-&#39;。\n</p>\n<p>\n奇数行的第偶数个字符是一个代表上下两点之间没有边的&#39;S&#39;，火石一个代表有边的&#39;|&#39;。\n</p>\n<p>\n奇数行的第计数个字符是一个&#39;S&#39;,代表周围四个点围成的空格。\n</p>\n<p>\n观察样例以更清楚地理解格式。\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n对每组数据，输出使所有点连通成一棵树的添边方案总数。这个数有可能很大，因此输出它模md的值。如果没有这样的添边方法，输出一行&#34;Impossible&#34;，不含引号。\n</p>\n<h3>\n【样例输入】\n</h3>\n<p>\n6\n</p>\n<p>\n2 2 1000\n</p>\n<p>\n.S.\n</p>\n<p>\nSSS\n</p>\n<p>\n.S.\n</p>\n<p>\n2 2 100\n</p>\n<p>\n.-.\n</p>\n<p>\n|S|\n</p>\n<p>\n.S.\n</p>\n<p>\n2 2 100\n</p>\n<p>\n.-.\n</p>\n<p>\n|S|\n</p>\n<p>\n.-.\n</p>\n<p>\n3 3 10000\n</p>\n<p>\n.S.S.\n</p>\n<p>\nSSSSS\n</p>\n<p>\n.S.S.\n</p>\n<p>\nSSSSS\n</p>\n<p>\n.S.S.\n</p>\n<p>\n3 3 10000\n</p>\n<p>\n.-.-.\n</p>\n<p>\nSSSSS\n</p>\n<p>\n.-.-.\n</p>\n<p>\nSSSSS\n</p>\n<p>\n.-.-.\n</p>\n<p>\n3 3 10000\n</p>\n<p>\n.S.S.\n</p>\n<p>\n|S|S|\n</p>\n<p>\n.S.S.\n</p>\n<p>\n|S|S|\n</p>\n<p>\n.S.S.\n</p>\n<h3>\n【样例输出】\n</h3>\n<p>\n4\n</p>\n<p>\n1\n</p>\n<p>\nImpossible\n</p>\n<p>\n192\n</p>\n<p>\n9\n</p>\n<p>\n9\n</p>\n<h3>\n【提示】\n</h3>\n<p>\n为了适应评测机的linux环境，对本题的数据格式进行了修改。在UVa原题中，无边的地方用空格表示，而在这里换成了字符S。\n</p>\n<h3>\n【来源】\n</h3>\n<p>\n<a href=\"http://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;category=572&amp;page=show_problem&amp;problem=2438\" target=\"_blank\">UVa11443 Tree in a Grid</a> \n</p>\n\n"}]}