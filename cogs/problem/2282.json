{"title":"[HZOI 2015]黑树白","time_limit":3000,"memory_limit":512,"url":"http://cogs.pro:8080/cogs/problem/problem.php?pid=viNxJVVUV","statement":[{"title":"题目描述","format":"html","require":["katex"],"content":"\n\n<h3>\n【题目描述】\n</h3>\n<p>\n给定一棵树，每个节点有点权，要求维护以下两个操作：\n</p>\n<p>\n1、Q u v a b 本蒟蒻施展大魔法，使得树上所有点权&gt;=a且点权&lt;=b的点变成白点，其余的点变成黑点，并查询u到v的简单路径上有多少个白点\n</p>\n<p>\n2、M u v 本蒟蒻施展小魔法，将u点的点权改为v\n</p>\n<h3>\n【输入格式】\n</h3>\n<p>\n第一行n，m 表示节点总数和操作次数\n</p>\n<p>\n以下n个正整数wi表示i点的点权\n</p>\n<p>\n以下n-1行，每行u，v描述一条边的端点\n</p>\n<p>\n以下m行，每行一个操作如题意\n</p>\n<p>\n注意：由于本蒟蒻的魔法太弱不稳定\n</p>\n<p>\n所以对于每次Q和M输入的u和v，你需要令u=(u+ans)%n+1,v=(v+ans)%n+1\n</p>\n<p>\n其中ans为上一次的答案，最开始ans=0\n</p>\n<p>\n注意只是Q和M中输入的u和v\n</p>\n<p>\nn，m&lt;=80000,任意时刻点权不会超过n\n</p>\n<h3>\n【输出格式】\n</h3>\n<p>\n对于每个Q操作，输出相应答案\n</p>\n<h3>\n【样例输入】\n</h3>\n<pre>5 5\n4 3 3 1 1\n2 1\n3 2\n4 3\n5 4\nM 2 1\nM 4 4\nM 1 4\nQ 2 4 2 3\nQ 4 2 1 5</pre>\n<h3>\n【样例输出】\n</h3>\n<pre>1\n4</pre>\n\n"}]}