# 题目描述


<h3>
【题目描述】
</h3>
<p>
QAQ喜欢玩LIS，有一天他看到这样的一道题目：
</p>
<p>
给定一棵树，求最长的路径使得路径上所有的点权连起来是一个上升序列
</p>
<p>
他思考了一下用树分治切掉了这道题目，不过QAQ觉得这样的题目非常的因缺思烃
</p>
<p>
于是就有了如下题目：
</p>
<p>
QAQ生成了一棵树，树的大小为n，节点为0-&gt;n-1，根为0
</p>
<p>
一开始所有点权都是0，有如下操作：
</p>
<p>
1、M u v QAQ施展LIS大魔法，将u点的点权+v
</p>
<p>
2、C u  QAQ施展LIS小魔法，他可以花费1点魔法值将某个点的点权+1，他现在希望u点到根节点的路径所有的点权构成一个上升序列
</p>
<p>
他需要你告诉他最少需要花费多少点魔法值才能完成这件事情
</p>
<p>
注意由于QAQ很懒而且很弱，魔法值很少，所以对于操作2他并不会去真正的更改点权，也就是2的询问对点权不会产生影响
</p>
<h3>
【输入格式】
</h3>
<p>
第一行输入n表示点数
</p>
<p>
以下n-1行，每行一个正整数，第i行的正整数表示i节点的父亲
</p>
<p>
之后输入m表示操作次数
</p>
<p>
以下m行每行一个操作如题意所示
</p>
<h3>
【输出格式】
</h3>
<p>
对于每个操作2输出答案
</p>
<h3>
【样例输入】
</h3>
<pre><p>
5
</p>

<p>
0
</p>

<p>
1
</p>

<p>
1
</p>

<p>
2
</p>

<p>
5
</p>

<p>
M 4 1572
</p>

<p>
M 4 13890
</p>

<p>
C 1
</p>

<p>
C 4
</p>

<p>
C 0
</p>
</pre>
<h3>
【样例输出】
</h3>
<pre><p>
1
</p>

<p>
46392
</p>

<p>
0
</p>
</pre>
<h3>
【提示】
</h3>
<p>
有30%的数据，n&lt;=1000,m&lt;=2000
</p>
<p>
另外有20%的数据，树是随机的
</p>
<p>
另外有20%的数据，树是一条链
</p>
<p>
另外有10%的数据，所有点的父亲都是根
</p>
<p>
对于100%的数据，n&lt;=50000,m&lt;=100000,v&lt;=2^16
</p>
<p>
出题人非常的良心，开了标程两倍左右的时限OwO
</p>
