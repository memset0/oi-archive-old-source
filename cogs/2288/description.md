# 题目描述


<h3>
【题目描述】
</h3>
<p>
给定一棵有根树，树根为1
</p>
<p>
每个点有点权
</p>
<p>
要求你维护以下操作：<br/>
1、Q u a b  查询u子树中权值在a-b之间的点的个数
</p>
<p>
2、M u v   把u节点点权更改为v
</p>
<p>
3、C u v   把u子树所有点权值+v
</p>
<p>
4、W u v   把u子树所有点权值都变成v
</p>
<p>
5、A u v   增加一个新点，编号是当前节点总数+1，其父亲是u，权值为v
</p>
<h3>
【输入格式】
</h3>
<p>
第一行n，m 表示节点总数和操作总数
</p>
<p>
以下n个正整数表示每个点的点权
</p>
<p>
以下n-1行每行两个数u，v描述一条边的两个端点
</p>
<p>
以下m行每行一个操作 如题意所示
</p>
<p>
保证a&lt;=b，n，m&lt;=80000
</p>
<h3>
【输出格式】
</h3>
<p>
对于每个Q输出相应的答案
</p>
<h3>
【样例输入】
</h3>
<p>
输入：
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
20 20
</p>
<p>
11 14 20 7 17 19 11 18 13 6 19 10 6 11 20 2 8 5 13 15
</p>
<p>
2 1
</p>
<p>
3 2
</p>
<p>
4 2
</p>
<p>
5 3
</p>
<p>
6 2
</p>
<p>
7 2
</p>
<p>
8 3
</p>
<p>
9 2
</p>
<p>
10 2
</p>
<p>
11 3
</p>
<p>
12 3
</p>
<p>
13 5
</p>
<p>
14 2
</p>
<p>
15 4
</p>
<p>
16 7
</p>
<p>
17 16
</p>
<p>
18 15
</p>
<p>
19 18
</p>
<p>
20 15
</p>
<p>
W 20 20
</p>
<p>
A 13 19
</p>
<p>
Q 18 12 17
</p>
<p>
W 19 4
</p>
<p>
W 21 1
</p>
<p>
W 5 5
</p>
<p>
C 9 6
</p>
<p>
Q 15 3 19
</p>
<p>
W 12 19
</p>
<p>
C 12 5
</p>
<p>
W 12 7
</p>
<p>
W 10 16
</p>
<p>
C 6 9
</p>
<p>
W 4 2
</p>
<p>
W 12 8
</p>
<p>
W 14 10
</p>
<p>
Q 10 2 9
</p>
<p>
W 1 21
</p>
<p>
W 19 9
</p>
<p>
C 13 1
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<h3>
【样例输出】
</h3>
<pre><p>
1
</p>

<p>
2
</p>

<p>
0
</p>
</pre>
<h3>
【提示】
</h3>
<p>
为了卡住暴力，前5个测试点的树形态是随机的
</p>
<p>
而后5个测试点设某个点为i，则其父亲的编号在[i-20,i-1]之间
</p>
