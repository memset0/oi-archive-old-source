# 题目描述


<h3>
【题目描述】
</h3>
<p>
<br/>
</p>
<p>
在两周年纪念日的旅行之后，在第三年，旅行社SPOJ又一次踏上的打折旅行的道路。
</p>
<p>
这次旅行是ICPC岛屿上进行的，一个位于太平洋上，不可思议的小岛。我们列出了N个地点（编号从1到N）供旅客游览。这N个点由N-1条边连成一个树，每条边都有一个权值，这个权值可能为负。我们可以选择两个地点作为旅行的起点和终点。
</p>
<p>
由于当地正在庆祝节日，所以某些地方会特别的拥挤（我们称这些地方为拥挤点）。旅行的组织者希望这次旅行最多访问K个拥挤点。同时，我们希望我们经过的道路的权值和最大。
</p>
<p>
<br/>
</p>
<h3>
【输入格式】
</h3>
<p>
第一行，三个整数N,K,M（1 &lt;= N &lt;= 200000, 0 &lt;= K &lt;=M, 0 &lt;= M &lt;= N）
</p>
<p>
之后的M行，每行一个拥挤点的编号。
</p>
<p>
最后的N-1行，每行三个整数u，v,l，代表u和v之间有一条权值为l的边
</p>
<h3>
【输出格式】
</h3>
<p>
一个整数，权值和最大的旅行线路
</p>
<h3>
【样例输入】
</h3>
<p>
8 2 3
</p>
<p>
3
</p>
<p>
5
</p>
<p>
7
</p>
<p>
1 3 1
</p>
<p>
2 3 10
</p>
<p>
3 4 -2
</p>
<p>
4 5 -1
</p>
<p>
5 7 6
</p>
<p>
5 6 5
</p>
<p>
4 8 3
</p>
<h3>
【样例输出】
</h3>
<p>
12
</p>
<h3>
【提示】
</h3>
<p>
在此键入。
</p>
<h3>
【来源】
</h3>
<p>
在此键入。
</p>
