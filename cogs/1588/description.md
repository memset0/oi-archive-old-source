# 题目描述


<h3>
【题目描述】
</h3>
<p>
农夫约翰有N（2&lt;=N&lt;=40000）个农场，标号1到N。M（2&lt;=M&lt;=40000）条的不同的垂直或水平的道路连结着农场，道路的长度不超过1000.这些农场的分布就像下面的地图一样，图中农场用F1..F7表示：
</p>
<p>
<img src="/upload/image/20140413/20140413210351_20586.png" alt=""/> 
</p>
<p>
每个农场最多能在东西南北四个方向连结4个不同的农场。此外，农场只处在道路的两端。道路不会交叉而且每对农场间有且仅有一条路径。邻居鲍伯要约翰来导航，但约翰丢了农场的地图，他只得从电脑的备份中修复率。每一条道路的信息如下：
</p>
<p>
    从农场23往南经距离10到达农场17
</p>
<p>
    从农场1往东经距离7到达农场17
</p>
<p>
    . . .
</p>
<p>
最近美国过度肥胖非常普遍。农夫约翰为了让他的奶牛多做运动，举办了奶牛马拉松。马拉松路线要尽量长。
</p>
<p>
奶牛们拒绝跑马拉松，因为她们悠闲的生活无法承受约翰选择的如此长的赛道。因此约翰决心找一条更合理的赛道。他打算咨询你。读入地图之后会有K个问题，每个问题包括2个整数，就是约翰感兴趣的2个农场的编号，请尽快算出这2个农场间的距离。
</p>
<h3>
【输入格式】
</h3>
<p>
第1行：两个分开的整数N和M。
</p>
<p>
第2到M+1行：每行包括4个分开的内容，F1,F2,L,D分别描述两个农场的编号，道路的长度，F1到F2的方向N,E,S,W。
</p>
<p>
第2+M行：一个整数K（1&lt;=K&lt;=10000）.
</p>
<p>
第3+M到2+M+K行：每行输入2个整数，代表2个农场。
</p>
<h3>
【输出格式】
</h3>
<p>
对每个问题，输出单独的一个整数，给出正确的距离。
</p>
<h3>
【样例输入】
</h3>
<pre>7 6
1 6 13 E
6 3 9 E
3 5 7 S
4 1 3 N
2 4 20 W
4 7 2 S
3
1 6
1 4
2 6</pre>
<h3>
【样例输出】
</h3>
<pre>13
3
36</pre>
<h3>
【提示】
</h3>
<p>
农场2到农场6有20+3+13=36的距离。
</p>
<h3>
【来源】
</h3>
<p>
Brian Dean,2004
</p>
<p>
USACO 2004 February Contest Green Problem 3 Distance Queries
</p>
<p>
Translate by: 庄乐
</p>
