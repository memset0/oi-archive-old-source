# 题目描述


<h3>
【题目描述】
</h3>
<p>
<br/>
</p>
<p>
分析师Igor正在研究文本编辑器的“文本替换”功能。他闲得无聊，想出了以下问题：
</p>
<p>
给定两个仅含大写字母&#39;A&#39;和&#39;B&#39;的英文字符串。称一对字符串(s,t)是“好”的，当且仅当：
</p>
<p>
1. s和t仅包含&#39;0&#39;和&#39;1&#39;
</p>
<p>
2. 1&lt;=|s|,|t|&lt;=n，其中|s|是s的长度
</p>
<p>
3. 如果把x和y中的所有&#39;A&#39;替换成s，所有&#39;B&#39;替换成t，那么x和y会变得一样。
</p>
<p>
例如，如果x=AAB,y=BB,n=4,那么(01,0101)是一组好字符串，因为替换后x和y都变成了“01010101”.
</p>
<p>
称一对字符串(x,y)的“自由度”是相应好字符串对(s,t)的数量。这里都是有序对，例如(0,1)和(1,0)不同。
</p>
<p>
给定两个字符串c和d，它们由&#39;A&#39;,&#39;B&#39;，&#39;?&#39;组成。&#39;?&#39;可以表示&#39;A&#39;或&#39;B&#39;，问所有情况下的自由度之和。
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<h3>
【输入格式】
</h3>
<p>
<br/>
</p>
<p>
前两行各一个字符串c,d（1&lt;=长度&lt;=3*10^5）
</p>
<p>
第三行一个正整数N，满足1&lt;=N&lt;=3*10^5.
</p>
<p>
<br/>
</p>
<h3>
【输出格式】
</h3>
<p>
一个整数，答案模10^9+7的值。
</p>
<h3>
【样例输入】
</h3>
<p>
A?
</p>
<p>
?
</p>
<p>
3
</p>
<h3>
【样例输出】
</h3>
2
<h3>
【样例输入】
</h3>
<p>
<br/>
</p>
<p>
A
</p>
<p>
B
</p>
<p>
10
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<h3>
【样例输出】
</h3>
2046
<h3>
【提示】
</h3>
<p>
<br/>
</p>
<p>
对于第一个样例，有四对可能的 (c&#39;, d&#39;).
</p>
<p>
若 (c&#39;, d&#39;) = (AA, A), 自由度为  0.
</p>
<p>
若 (c&#39;, d&#39;) = (AB, A), 自由度为 0.
</p>
<p>
若 (c&#39;, d&#39;) = (AA, B), 自由度为 2, 两种方案是 (1, 11), (0, 00) .
</p>
<p>
若 (c&#39;, d&#39;) = (AB, B), 自由度为 0.
</p>
<p>
所以总自由度为2.
</p>
<p>
对于第二个样例，长度不超过10的01串共有2^1+...+2^10=2046个，而所有好字符串对形如(s,s)，其中s是长度不超过10的01串。
</p>
<p>
<br/>
</p>
<h3>
【来源】
</h3>
<p>
CODEFORCES ROUND #414
</p>
<p>
<a href="http://codeforces.com/contest/794/problem/G" target="_blank">http://codeforces.com/contest/794/problem/G</a> 
</p>
