# 题目描述


<h3>
【题目描述】
</h3>
<p>
QAQ喜欢玩LIS，他觉得在树上的LIS非常的有趣
</p>
<p>
但是上一道题目已经耗尽了他所有的魔法值，所以他并不能人为对点权进行修改了
</p>
<p>
sad story。。
</p>
<p>
不过没有关系，QAQ是个非常爱玩的小孩子，他又提出了这样的一个问题：
</p>
<p>
QAQ有一棵树，节点总数为n，编号为0-&gt;n-1,树根为0
</p>
<p>
要求支持以下操作：
</p>
<p>
1、M u v 把u点的点权+v
</p>
<p>
2、S 查询最大的一棵子树，满足子树中所有的点到子树的根的路径都是一个上升序列
</p>
<p>
对于每次询问，QAQ想知道满足条件的子树最大是多少
</p>
<h3>
【输入格式】
</h3>
<p>
第一行输入n表示节点总数
</p>
<p>
之后有n-1个数，第i个数表示第i个节点的父亲
</p>
<p>
输入m表示操作总数
</p>
<p>
以下m行每行一个操作如题意所示
</p>
<h3>
【输出格式】
</h3>
<p>
对于每个询问输出对应的答案
</p>
<h3>
【样例输入】
</h3>
<pre><p>
10
</p>

<p>
0 0 2 1 0 2 4 3 3
</p>

<p>
20
</p>

<p>
M 8 4
</p>

<p>
S
</p>

<p>
S
</p>

<p>
S
</p>

<p>
M 9 3
</p>

<p>
M 4 3
</p>

<p>
S
</p>

<p>
S
</p>

<p>
M 9 4
</p>

<p>
S
</p>

<p>
S
</p>

<p>
M 7 4
</p>

<p>
S
</p>

<p>
M 0 1
</p>

<p>
M 8 4
</p>

<p>
S
</p>

<p>
M 7 4
</p>

<p>
S
</p>

<p>
M 7 4
</p>

<p>
M 2 1<span style="font-family:monospace;"></span> 
</p>
</pre>
<h3>
【样例输出】
</h3>
<pre><p>
1
</p>

<p>
1
</p>

<p>
1
</p>

<p>
2
</p>

<p>
2
</p>

<p>
2
</p>

<p>
2
</p>

<p>
1
</p>

<p>
1
</p>

<p>
1
</p>
</pre>
<h3>
【提示】
</h3>
<p>
有30%的数据，n&lt;=1000,m&lt;=2000
</p>
<p>
另外有20%的数据，树是随机的
</p>
<p>
另外有20%的数据，树是一条链
</p>
<p>
另外有10%的数据，所有非根节点的父亲都是根
</p>
<p>
对于100%的数据，n&lt;=50000，m&lt;=100000，v&lt;=100000
</p>
