# 题目描述


<h3>
【题目描述】
</h3>
<p>
你决定设计你自己的软件包管理器。不可避免的，你要解决软件包之间的依赖关系。如果A依赖B，那么安装A之前需安装B，卸载B之前须卸载A。0号软件包不依赖任何软件包。依赖关系不存在环(包括自环)。
</p>
<p>
你的任务是，求出每次安装、删除操作会改变多少个包的状态。
</p>
<p>
<strong><u>安装一个已安装的软件包，或者卸载一个未安装的软件包，都不会改变任何软件包的安装状态，即在此情况下，改变安装状态的软件包数为0</u></strong> 
</p>
<p>
<strong><u>每次操作不仅需要计算安装软件包数，还作为操作影响后来的安装/删除<br/>
</u></strong> 
</p>
<h3>
【输入格式】
</h3>
<p>
第一行一个整数n,表示软件包的总数。
</p>
<p>
随后n-1个整数$a_1,a_2,...a_{n-1}$，表示第i个软件包依赖第$a_i$个软件包
</p>
<p>
接下来一行一个整数q,表示询问数
</p>
<p>
之后q行，每行一个询问，询问分为两种
</p>
<p>
$install$ $x：表示安装x$
</p>
<p>
$uninstall$ $x：表示卸载x$
</p>
<h3>
【输出格式】
</h3>
<p>
q行，每行一个整数，为第i步操作改变安装状态的软件包数
</p>
<p>
【样例输入1】
</p>
<p>
7
</p>
<p>
0 0 0 1 1 5
</p>
<p>
5
</p>
<p>
install 5
</p>
<p>
install 6
</p>
<p>
uninstall 1
</p>
<p>
install 4
</p>
<p>
uninstall 0
</p>
<p>
【样例输出1】
</p>
<p>
3
</p>
<p>
1
</p>
<p>
3
</p>
<p>
2
</p>
<p>
3
</p>
<p>
【样例说明1】：<img alt="" src="/upload/image/20150730/20150730170635_69367.png"/> 
</p>
<p>
一开始所有的软件包都处于未安装状态。
</p>
<p>
安装5号软件包，需安装0,1,5三个软件包
</p>
<p>
之后安装6号软件包，只需安装6号软件包。此时安装了0,1,5,6四个软件包。
</p>
<p>
卸载1号软件包需要卸载1,5,6三个软件包，此时只有0号软件包还处于安装状态
</p>
<p>
之后安装4号软件包，需安装1,4两个软件包。此时0,1,4处于安装状态
</p>
<p>
最后，卸载0号软件包会卸载所有的软件包
</p>
<p>
【样例输入2】
</p>
<p>
10
</p>
<p>
0 1 2 1 3 0 0 3 2
</p>
<p>
10
</p>
<p>
install 0
</p>
<p>
install 3
</p>
<p>
uninstall 2
</p>
<p>
install 7
</p>
<p>
install 5
</p>
<p>
install 9
</p>
<p>
uninstall 9
</p>
<p>
install 4
</p>
<p>
install 1
</p>
<p>
install 9
</p>
<p>
【样例输出2】
</p>
<p>
1
</p>
<p>
3
</p>
<p>
2
</p>
<p>
1
</p>
<p>
3
</p>
<p>
1
</p>
<p>
1
</p>
<p>
1
</p>
<p>
0
</p>
<p>
1
</p>
<h3>
【提示】
</h3>
<p>
1,2:n=5000 q=5000
</p>
<p>
3,4:n=100000 q=100000 没有卸载操作
</p>
<p>
5,6,7,8 n=100000,q=100000 依赖关系和操作随机
</p>
<p>
9-20 n=100000,q=100000 不随机
</p>
<h3>
【来源】
</h3>
<p>
NOI2015Day1T2
</p>
