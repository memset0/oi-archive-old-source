# 题目描述


<h3>
【题目描述】
</h3>
<p>
给定一棵树，每个节点有点权，要求维护以下两个操作：
</p>
<p>
1、Q u v a b 本蒟蒻施展大魔法，使得树上所有点权&gt;=a且点权&lt;=b的点变成白点，其余的点变成黑点，并查询u到v的简单路径上有多少个白点
</p>
<p>
2、M u v 本蒟蒻施展小魔法，将u点的点权改为v
</p>
<h3>
【输入格式】
</h3>
<p>
第一行n，m 表示节点总数和操作次数
</p>
<p>
以下n个正整数wi表示i点的点权
</p>
<p>
以下n-1行，每行u，v描述一条边的端点
</p>
<p>
以下m行，每行一个操作如题意
</p>
<p>
注意：由于本蒟蒻的魔法太弱不稳定
</p>
<p>
所以对于每次Q和M输入的u和v，你需要令u=(u+ans)%n+1,v=(v+ans)%n+1
</p>
<p>
其中ans为上一次的答案，最开始ans=0
</p>
<p>
注意只是Q和M中输入的u和v
</p>
<p>
n，m&lt;=80000,任意时刻点权不会超过n
</p>
<h3>
【输出格式】
</h3>
<p>
对于每个Q操作，输出相应答案
</p>
<h3>
【样例输入】
</h3>
<pre>5 5
4 3 3 1 1
2 1
3 2
4 3
5 4
M 2 1
M 4 4
M 1 4
Q 2 4 2 3
Q 4 2 1 5</pre>
<h3>
【样例输出】
</h3>
<pre>1
4</pre>
