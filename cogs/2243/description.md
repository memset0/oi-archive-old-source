# 题目描述


<h3>
【题目描述】
</h3>
<p>
<br/>
</p>
<p>
你被派去完成一个任务，这个任务是必须A掉一个题，题目是这样的：你需要维护一个点带权的森林，支持加边、删边的操作，并且回答一些询问。
</p>
<p>
一开始，这个图是一张空图，没有边。
</p>
<p>
从现在开始，用节点u表示标号为u的节点。
</p>
<p>
操作共分为以下几种类型：
</p>
<p>
1 u v
</p>
<p>
表示在节点u与节点v之间连上一条无向边。
</p>
<p>
2 u v
</p>
<p>
表示删除节点u与节点v之间的无向边。
</p>
<p>
3 u x
</p>
<p>
将节点u的权值改为x.
</p>
<p>
4 u v
</p>
<p>
表示询问节点u与节点v之间的路径上的权值最小值.
</p>
<p>
5 w u v
</p>
<p>
表示询问以节点w为根时，节点u与节点v的最近公共祖先节点的标号。
</p>
<p>
6 w u
</p>
<p>
表示询问以节点w为根时，以节点u为根的子树的节点数。
</p>
<p>
7 w u
</p>
<p>
表示询问以节点w为根时，以节点u为根的子树权值最小值。
</p>
<p>
<br/>
</p>
<h3>
【输入格式】
</h3>
<p>
<br/>
</p>
<p>
第一行两个整数n,m，表示树上的总结点数，以及总的操作次数；
</p>
<p>
接下来一行n个整数，第i个整数为xi，表示节点i初始的权值；
</p>
<p>
接下来m行，依次表示m次操作。
</p>
<p>
<br/>
</p>
<h3>
【输出格式】
</h3>
<p>
对于每一个操作类型为5,6,7的操作，输出一行一个整数，表示这次询问的答案。
</p>
<h3>
【样例输入】
</h3>
<p>
<br/>
</p>
<p>
10 30
</p>
<p>
453693185 97417345 542909441 272416065 660418023 969737409 73086977 60587265 168796673 359459841
</p>
<p>
1 1 2
</p>
<p>
1 9 10
</p>
<p>
1 5 4
</p>
<p>
2 5 4
</p>
<p>
1 3 9
</p>
<p>
5 9 9 10
</p>
<p>
6 7 7
</p>
<p>
6 7 7
</p>
<p>
3 1 147640321
</p>
<p>
6 3 9
</p>
<p>
1 5 8
</p>
<p>
1 3 5
</p>
<p>
6 7 7
</p>
<p>
6 9 10
</p>
<p>
1 5 2
</p>
<p>
1 9 7
</p>
<p>
7 1 1
</p>
<p>
6 9 1
</p>
<p>
3 9 125258561
</p>
<p>
7 7 1
</p>
<p>
4 5 1
</p>
<p>
4 1 1
</p>
<p>
2 3 5
</p>
<p>
7 3 3
</p>
<p>
4 3 3
</p>
<p>
3 7 487083009
</p>
<p>
7 1 1
</p>
<p>
5 3 3 3
</p>
<p>
1 3 4
</p>
<p>
7 7 7
</p>
<p>
<br/>
</p>
<h3>
【样例输出】
</h3>
<p>
<br/>
</p>
<p>
9
</p>
<p>
1
</p>
<p>
1
</p>
<p>
2
</p>
<p>
1
</p>
<p>
1
</p>
<p>
60587265
</p>
<p>
1
</p>
<p>
147640321
</p>
<p>
97417345
</p>
<p>
147640321
</p>
<p>
73086977
</p>
<p>
542909441
</p>
<p>
60587265
</p>
<p>
3
</p>
<p>
125258561
</p>
<h3>
【提示】
</h3>
<p>
对于测试点1,2,3,4,5,6，保证n,m≤1000;
对于测试点7,8,9,10,11,12，保证只有操作1,2,3,4,5;
对于测试点13,14,15,16,保证没有操作7；
对于全部数据，1≤n,m≤100,000,保证所有操作均合法，且所有出现过的权值x均互不相同，且1≤x≤10^9。
</p>
<h3>
【来源】
</h3>
<p>
在此键入。
</p>
