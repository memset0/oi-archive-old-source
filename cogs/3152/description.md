# 题目描述


<h3>
【题目描述】
</h3>
<p>
后缀数组 (SA) 是一种重要的数据结构，通常使用<strong>倍增</strong>或者<strong>DC3</strong>算法实现，这超出了我们的讨论范围。在本题中，我们希望使用<strong>快排、Hash与二分</strong>实现一个简单的 $O(n log^2⁡n ) $的后缀数组求法。
</p>
<p>
详细地说，给定一个长度为 n 的字符串S（下标 0~n-1），我们可以用整数 k(0≤k&lt;n) 表示字符串S的后缀 S(k~n-1)。把字符串S的所有后缀按照字典序排列，排名为 i 的后缀记为 SA[i]。
</p>
<p>
额外地，我们考虑排名为 i 的后缀与排名为 i-1 的后缀，把二者的最长公共前缀的长度记为 Height[i]。我们的任务就是求出SA与Height这两个数组。
</p>
<h3>
【输入格式】
</h3>
<p>
一个字符串，长度不超过30万。
</p>
<h3>
【输出格式】
</h3>
<p>
第一行为数组SA，相邻两个整数用1个空格隔开。
</p>
<p>
第二行为数组Height，相邻两个整数用1个空格隔开，特别地，假设Height[1]=0。
</p>
<h3>
【样例输入】
</h3>
<pre>ponoiiipoi</pre>
<h3>
【样例输出】
</h3>
<pre>9 4 5 6 2 8 3 1 7 0
0 1 2 1 0 0 2 1 0 2
</pre>
<h3>
【提示】
</h3>
<p>
排名第一（最小）的后缀是9（S[9~9]，即字符串 i），第二的是后缀4（S[4~9]，即字符串iiipoi），第三的是后缀5（S[5~9]，即字符串iipoi）以此类推。Height[2]表示排名第2与第1的后缀的最长公共前缀，长度为1，Height[3]表示排名第3与第2的后缀的最长公共前缀，长度为2，以此类推。
</p>
<h3>
【来源】
</h3>
<p>
《算法竞赛进阶指南》
</p>
