# 题目描述


<h3>
【题目描述】
</h3>
<p>
<img src="/upload/image/20151029/20151029082300_76092.jpg" alt=""/> 
</p>
<p>
<br/>
</p>
<p>
<strong><span style="color:#E53333;font-size:16px;">战栗吧！丧钟已为你鸣响！</span></strong> 
</p>
<p>
<strong><span style="color:#E53333;font-size:16px;">颤抖吧！挽歌已为你宣唱！</span></strong> 
</p>
<p>
<strong><span style="color:#E53333;font-size:16px;">末日审判已经降临,</span></strong> 
</p>
<p>
<strong><span style="color:#E53333;font-size:16px;">所有情侣都要付出代价！</span></strong> 
</p>
<p>
<br/>
</p>
<p>
情侣教会的暴行激起了广大有良知的单身狗的愤怒，一场起义不可避免的爆发了。
</p>
<p>
单身狗分裂为两派，左派的FFF和右派的SOX。
</p>
<p>
FFF旨在烧死一切情侣，但是他们缺乏火源。
</p>
<p>
你作为一名FFF的团员，接受命令寻找传说中的具有火焰魔法能量的燃灵之链。
</p>
<p>
然而，当你找到燃灵之链时，却发现燃灵之链的一部分受到了恶魔能量的腐蚀，即所谓负能量，
</p>
<p>
一部分仍然拥有正能量，为了满足K个起义军团的需要，你需要在含有n个能量子的项链中选取<strong><u>K个互不相邻</u></strong>的子项链。
</p>
<p>
求所能得到的能量的最大值。（相等恶魔能量和正能量可以在数值上抵消）
</p>
<p>
<br/>
</p>
<h3>
【输入格式】
</h3>
<p>
<br/>
</p>
<p>
第一行，两个正整数n和k
</p>
<p>
第二行，这条项链从左到右每个能量子的能量值
</p>
<p>
<br/>
</p>
<h3>
【输出格式】
</h3>
<p>
一个正整数ans,为最大值
</p>
<h3>
【样例输入】
</h3>
<pre><p>
7 3
</p>

<p>
5 -1 4 -8 2 -3 5
</p>
</pre>
<h3>
【样例输出】
</h3>
<pre> 15</pre>
<h3>
【提示】
</h3>
<p>
三个子项链分别为(5,-1,4)(2)(5)
</p>
<p>
首先我们观察得出：
</p>
<p>
<strong>这条链是一个一叉树</strong> 
</p>
<p>
<strong>其次要对这棵树进行剖分</strong> 
</p>
<p>
<strong>所以我们自然想到了树链剖分</strong> 
</p>
<p>
<strong>百度搜索树链剖分，你值得拥有！</strong> 
</p>
<p>
对于 20%的数据，N&lt;=20;K&lt;=10;
</p>
<p>
对于 70%的数据，N&lt;=1000,K&lt;=100;
</p>
<p>
对于 100%的数据,N&lt;=10000,K&lt;=1000;
</p>
<p>
能量子的范围为[-2^15,2^15]
</p>
<h3>
【来源】
</h3>
<p>
在此键入。
</p>
