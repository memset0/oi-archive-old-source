# 题目描述


<h3>
【题目描述】
</h3>
<p>
多边形(Polygon)游戏是单人玩的游戏，开始的时候给定一个由N个顶点构成的多边形(图1所示的例子中，N=4)，每个顶点被赋予一个整数值，而每条边则被赋予一个符号：+(加法运算)或者*(乘法运算)，所有边依次用整数1到N标识。
</p>
<p>
<img src="/upload/image/20140123/20140123215424_28289.png" alt=""/> 
</p>
<p>
图1一个多边形的图形表示
</p>
<p>
首次移动(first move)，允许将某条边删除；
</p>
<p>
接下来的每次顺序移动(subsequentmoves)，包括下面步骤：
</p>
<p>
1、选出一条边E，以及由E联接的顶点V1和V2；
</p>
<p>
2、用一个新的顶点，取代边E及其所联接的两个顶点V1和V2。新顶点要赋予新的值，这个值是对V1和V2，做由E所指定的运算，所得到的结果。
</p>
<p>
所有边都被删除后，只剩下一个顶点，游戏结束。游戏的得分就是该顶点的数值。
</p>
<p>
下面是一个游戏实例：
</p>
<p>
考虑图1中的多边形。
</p>
<p>
玩家第一步删除第3条边。结果如图2所示。
</p>
<p>
<img src="/upload/image/20140123/20140123215826_22836.png" alt=""/> 
</p>
<p>
图2 删除第3条边
</p>
<p>
之后，玩家删除第1条边
</p>
<p>
<img src="/upload/image/20140123/20140123215915_58626.png" alt=""/> 
</p>
<p>
图3 删除第1条边
</p>
<p>
然后删除第4条边，
</p>
<p>
<img src="/upload/image/20140123/20140123215943_25340.png" alt=""/> 
</p>
<p>
图4 删除第4条边
</p>
<p>
最后删除第2条边。得分是0.
</p>
<p>
<img src="/upload/image/20140123/20140123220015_34459.png" alt=""/> 
</p>
<p>
图5 删除第2条边
</p>
<p>
任务：
</p>
<p>
编写一个程序，对于任意给定的多边形，计算可能的最高得分，并且列举出所有的可以导致最高得分的被首次移动的边。
</p>
<h3>
【输入格式】
</h3>
<p>
文件POLYGON.IN给出的是，由N个顶点构成的多边形。文件包括2行：
</p>
<p>
第一行记录的是数值N；
</p>
<p>
第二行包含所有边(1，…，N)分别被赋予的符号，以及嵌入到两条边之间的顶点的数值(第一个整数值对应于与1号、2号边同时相连的顶点；第二个整数对应于与2号、3号边同时相连的顶点；…；等等。最后一个数值对应于与N号、1号边同时相连的顶点)，符号和数值之间由一个空格分隔。边的符号有2种：字母t(对应于+)，字母x(对应于*)。
</p>
<h3>
【输出格式】
</h3>
<p>
在文件POLYGON.OUT的第一行，你的程序必须输出在输入文件指定条件下可能得到的最高得分。
</p>
<p>
有些边如果在首次移动中被删除，可以导致最高得分。在输出文件的第二行，要求列举出所有这样的边，而且按照升序输出，其间用一个空格分开。
</p>
<h3>
【样例输入】
</h3>
<p>
4
</p>
<p>
t -7 t 4 x 2 x 5
</p>
<h3>
【样例输出】
</h3>
<p>
33
</p>
<p>
1 2
</p>
<h3>
【提示】
</h3>
<p>
样例输入对应于图1所示的多边形。第二行的第一个字符是1号边的符号。
</p>
<h3>
【来源】
</h3>
<p>
IOI1998 polygon
</p>
<p>
翻译 by 来煜坤，《把握本质，灵活运用——动态规划的深入探讨》
</p>
