# 题目描述


<h3>
	【题目描述】
</h3>
<p>
	<br/>
邮局需要你来帮助他们为某个邮递员设计出一条能够穿过那遥远乡村的所有村子和小路至少一次的邮路（输入数据将会保证这么一条路是一定存在的）。 <br/>
但是，每条路线都是有一个花费的。各个村子里的村民希望邮递员到达他们村子的时间越早越好。因此，各个村子里的人们采用了一些措施：假设第i号村子是邮递员在他的邮递路线上到达的第k个村子。如果k&lt;=w( i )，那么这个村子的村民就会付给邮局w( i )-k欧元。当然，如果k&gt;w(i)，邮局也同意付k- w( i )欧元给这个村子，对某些村子重复经过要重复收费。此外，邮递员每经过一条小路，邮局也要付给邮递员1欧元作为补贴。 <br/>
现在有n个村子，编号依次为1到n。邮局就位于1号村子，因此邮递员的传递路线从这里开始，也从这个村子结束。能够离开每个村子的路口的数目一定是2，4或者8。这里允许出现同样的村子间存在多条小路，或者某条小路构成了一个自环的情况。 <br/>
你的任务是设计一个路线使得邮局赚的钱最多(或者说赔的钱最少。如果有多种最优解，输出字典序最小的。 <br/>
<img src="/upload/image/20120925/20120925165338_73738.gif" alt=""/>
</p>
<h3>
	【输入】
</h3>
<p>
	<br/>
第一行：两个整数n，m，分别表示村子的数量和小路的数量。 <br/>
接下来n行，每行一个整数：w(i)(1≤w(i)&lt;1000) <br/>
接下来m行，每行两个整数u，v，表示这条小路连接的村子的编号。
</p>
<h3>
	【输出】
</h3>
<p>
	<br/>
第一行：一个整数k，你的程序所设计的路径的长度 <br/>
第二行：k+1个整数，v1，v2…vk+l，每个数之间用一个空格隔开，表示你设计的路径所经过的村子的编号，其中需要满足v1=vk+1=1
</p>
<h3>
	【输入样例】
</h3>
<p>
	<br/>
carrier.in
</p>
<p>
	6 7 <br/>
1 <br/>
7 <br/>
4 <br/>
10 <br/>
20 <br/>
5 <br/>
2 4 <br/>
1 5 <br/>
2 1 <br/>
4 5 <br/>
3 6 <br/>
1 6 <br/>
1 3
</p>
<h3>
	【输出样例】
</h3>
<p>
	<br/>
carrier.out
</p>
<p>
	7 <br/>
1 2 4 5 1 3 6 1
</p>
<h3>
	【提示】
</h3>
<p>
	<br/>
对于30％的数据，有N&lt;=20 <br/>
对于100%的数据，有N&lt;=200; <br/>
补充说明：邮递员每条路线都要去送信，并且每条线路只要送一次就可以了。
</p>
