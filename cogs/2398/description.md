# 题目描述


<p>
[HNOI 2013]切糕
</p>
<p>
第三题：切糕（程序文件名：cake.exe）100 分，运行时限：5s
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
经过千辛万苦小A 得到了一块切糕，切糕的形状是长方体，小A 打算拦腰将切糕切成两半分给小B。出于美观考虑，小A 希望切面能尽量光滑且和谐。于是她找到你，希望你能帮她找出最好的切割方案。
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
出于简便考虑，我们将切糕视作一个长P、宽Q、高R 的长方体点阵。我们将位于第z层中第x 行、第y 列上(1≤x≤P, 1≤y≤Q, 1≤z≤R)的点称为(x,y,z)，它有一个非负的不和谐值v(x,y,z)。一个合法的切面满足以下两个条件：
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
1. 与每个纵轴(一共有P*Q 个纵轴)有且仅有一个交点。即切面是一个函数f(x,y)，对于所有1≤x≤P, 1≤y≤Q,我们需指定一个切割点f(x,y),且1≤f(x,y)≤R。
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
2. 切面需要满足一定的光滑性要求，即相邻纵轴上的切割点不能相距太远。对于所有的1≤x,x’≤P 和1≤y,y’ ≤Q，若|x-x’|+|y-y’|=1，则|f(x,y)-f(x’,y’)| ≤D，其中D 是给定的一个非负整数。
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
可能有许多切面f 满足上面的条件，小A 希望找出总的切割点上的不和谐值最小的那个，即v(x, y, f (x, y))x,y 最小。
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
【输入格式】（input.txt）
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
从文件input.txt中读入数据，输入文件第一行是三个正整数P,Q,R，表示切糕的长P、宽Q、高R。第二行有一个非负整数D，表示光滑性要求。接下来是R个P行Q列的矩阵，第z个矩阵的第x行第y列是v(x,y,z) (1≤x≤P,1≤y≤Q, 1≤z≤R)。
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
100%的数据满足P,Q,R≤40，0≤D≤R，且给出的所有的不和谐值不超过1000。
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
【输出格式】（output.txt）
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
输出文件output.txt 仅包含一个整数，表示在合法基础上最小的总不和谐值。
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
【输入输出样例】
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
input.txt       output.txt
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
2 2 2            6
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
1
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
6 1
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
6 1
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
2 6
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
2 6
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
input.txt   output.txt
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
2 2 2        12
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
0
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
5 1
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
5 1
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
2 5
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
2 5
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
【样例解释】
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
第一组样例中最佳切面的f为f(1,1)=f(2,1)=2,f(1,2)=f(2,2)=1。
</p>
<p>
<br/>
</p>
<p>
<br/>
</p>
<p>
第二组样例中最佳切面的f为f(1,1)=f(2,1)=f(1,2)=f(2,2)=1。
</p>
<p>
<br/>
</p>
