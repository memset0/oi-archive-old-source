# 题目描述


<h3>
【题目描述】
</h3>
<p>
<br/>
</p>
<p>
wcg有一棵节点数为n 的有根树，现在需要给每个节点标号，要求对应子树同构的节点标号相同。
</p>
<p>
若图G1,G2 同构，则存在G1 点集和G2 点集之间的双射ϕ，满足u → v 是G1 中的一条边当且仅当
</p>
<p>
ϕ(u) → ϕ(v) 是G2 中的一条边。
</p>
<p>
<br/>
</p>
<h3>
【输入格式】
</h3>
<p>
<br/>
</p>
<p>
第一行包含一个数n(1 &lt;= n &lt;= 10e5)，表示树的点数。
</p>
<p>
第二行包含n - 1 个数，第i 个数表示编号为i + 1 点的父节点编号，满足父节点的编号小于子节点，根
</p>
<p>
节点编号为1。
</p>
<p>
<br/>
</p>
<h3>
【输出格式】
</h3>
<p>
<br/>
</p>
<p>
一行包含n 个数，表示节点标号，标号大小范围在1 到n 之间。如果有多种标号，给出字典序最小的标
</p>
<p>
号。
</p>
<p>
<br/>
</p>
<h3>
【样例输入】
</h3>
<pre><p>
9
</p>

<p>
1 2 2 1 5 5 7 7
</p>
</pre>
<h3>
【样例输出】
</h3>
<pre>1 2 3 3 4 3 2 3 3</pre>
<h3>
【提示】
</h3>
<p>
<br/>
</p>
<p>
对于30% 的数据，n &lt;= 12。
</p>
<p>
对于50% 的数据，n &lt;= 100。
</p>
<p>
对于100% 的数据，n &lt;= 10e5。
</p>
<p>
<br/>
</p>
<p>
如果看不懂题目描述，可以这么理解：将树上每个节点构成的子树（以此节点为根）分到不同的集合里，每个集合里所有的子树的结构都必须相同，然后输出每个节点构成的子树所属的集合，同时尽量满足答案的字典序小。
</p>
<p>
<br/>
</p>
<h3>
【来源】
</h3>
<p>
qbxt 2017.10.6 t2
</p>
