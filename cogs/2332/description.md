# 题目描述


<h3>
【题目描述】
</h3>
<p>
原题地址: <a href="http://cojs.tk/cogs/problem/problem.php?pid=2274" target="_blank">[HEOI 2016] tree</a> 
</p>
<p>
<img src="/upload/image/20160611/20160611175710_33539.png" alt=""/> 
</p>
<p>
<img src="/upload/image/20160611/20160611175723_29216.png" alt=""/> 
</p>
<p>
<img src="/upload/image/20160611/20160611175731_63230.png" alt=""/> 
</p>
<h3>
【注意事项】
</h3>
<p>
<br/>
</p>
<p>
为了体现增强版，题目限制和数据范围有所增强:
</p>
<p>
时间限制：1.5s
</p>
<p>
内存限制：128MB
</p>
<p>
对于15% 的数据，1&lt;=N,Q&lt;=1000.
</p>
<p>
对于35% 的数据，1&lt;=N,Q&lt;=10000.
</p>
<p>
对于50% 的数据，1&lt;=N,Q&lt;=100000,且数据均为官方数据.
</p>
<p>
对于100% 的数据，1&lt;=N,Q&lt;=1000000.
</p>
<p>
请注意常数因子对于程序运行的影响。
</p>
<p>
<br/>
</p>
<h3>
【来源】
</h3>
<p>
HZOI 2016
</p>
