# 题目描述


<h3>
【题目描述】
</h3>
<p>
维护一种可持久化的文本编辑器,支持下列操作:
</p>
<p>
1 p str 在当前版本的第p个字符后插入字符串str,并作为下一版本(数据保证0&lt;=p&lt;=当前字符串的长度,且插入的字符串中只有小写字母)
</p>
<p>
2 p c 在当前版本中删除从第p个字符开始的后c个字符,并作为下一版本(包含第p个字符,数据保证1&lt;=p&lt;=当前字符串的长度,且p+c-1&lt;=当前字符串的长度)
</p>
<p>
3 x p c 输出第x个版本从第p个字符开始的后c个字符(包含第p个字符,数据保证1&lt;=p&lt;=第x个版本的字符串的长度,且p+c-1&lt;=第x个版本的字符串的长度)
</p>
<p>
为了体现在线,你需要维护一个变量d,在3操作之后,d加上你输出字符串中字符&#39;c&#39;的数量,并且在数据中给出的操作1中的p,操作2中的p和c,操作3中的x,p,c均为加上变量d的结果,你需要把它们减去d之后运算
</p>
<p>
开始时为空串,d=0,且为版本0,每进行操作1,2就会以上一版本的基础上修改形成下一版本
</p>
<h3>
【输入格式】
</h3>
<p>
第一行一个数n,表示有n个操作
</p>
<p>
下面n行,第一个数字为op,表示操作类型
</p>
<p>
op=1时表示第一种操作,后面有一个数p和一个字符串str,意义同上面的描述,在操作之前,你需要将p减去d,才能得到正确的p,d的意义同上面的描述,表示你之前第三种操作输出的所有字符串中字符&#39;c&#39;的数量
</p>
<p>
op=2时表示第二种操作,后面有两个数p,c,意义同上面的描述,在操作之前,你需要将p和c减去d,才能得到正确的p和c,d的意义同上面的描述,表示你之前第三种操作输出的所有字符串中字符&#39;c&#39;的数量
</p>
<p>
op=3时表示第三种操作,后面有三个数x,p,c,意义同上面的描述,在操作之前,你需要将x,p和c减去d,才能得到正确的x,p和c,d的意义同上面的描述,表示你之前第三种操作输出的所有字符串中字符&#39;c&#39;的数量
</p>
<h3>
【输出格式】
</h3>
<p>
对于每个第三种操作输出一行表示结果
</p>
<h3>
【样例输入】
</h3>
<p>
<br/>
</p>
<p>
6
</p>
<p>
1 0 abcdefgh
</p>
<p>
2 4 3
</p>
<p>
3 1 2 5
</p>
<p>
3 3 3 4
</p>
<p>
1 4 xy
</p>
<p>
3 5 4 6
</p>
<p>
<br/>
</p>
<h3>
【样例输出】
</h3>
<p>
<br/>
</p>
<p>
bcdef
</p>
<p>
bcg
</p>
<p>
bxyc
</p>
<p>
<br/>
</p>
<h3>
【提示】
</h3>
<p>
对于样例解密的结果为
</p>
<p>
6
</p>
<p>
1 0 abcdefgh
</p>
<p>
2 4 3
</p>
<p>
3 1 2 5
</p>
<p>
3 2 2 3
</p>
<p>
1 2 xy
</p>
<p>
3 3 2 4
</p>
<p>
本题共20组测试数据,一个点5分,给出数据特征如下
</p>
<p>
测试点编号 操作数量的规模 插入字符串的特点  插入字符串的最大长度
</p>
<p>
<br/>
</p>
<p>
 1      n =500        N/A            10
</p>
<p>
 2      n =1000       N/A             10
</p>
<p>
 3      n =10000   字符只有&#39;a&#39;,&#39;b&#39;      200
</p>
<p>
 4      n =20000   字符只有&#39;a&#39;,&#39;b&#39;       200
</p>
<p>
 5      n =30000   字符只有&#39;a&#39;,&#39;b&#39;       200
</p>
<p>
 6      n =40000   字符只有&#39;a&#39;,&#39;b&#39;       200
</p>
<p>
 7      n =50000   字符只有&#39;a&#39;,&#39;b&#39;       200
</p>
<p>
 8      n =100000  字符只有&#39;a&#39;,&#39;b&#39;       200
</p>
<p>
 9     n =100000  字符只有&#39;a&#39;          200
</p>
<p>
 10     n =100000  字符只有&#39;c&#39;          200
</p>
<p>
 11     n =10000       N/A            200
</p>
<p>
 12    n =20000       N/A            200
</p>
<p>
 13    n =30000       N/A            200
</p>
<p>
 14    n =40000       N/A            200
</p>
<p>
 15    n =50000       N/A            200
</p>
<p>
 16    n =60000       N/A            200
</p>
<p>
 17    n =70000       N/A            200
</p>
<p>
 18    n =80000       N/A            200
</p>
<p>
 19    n =90000       N/A            200
</p>
<p>
 20    n =100000      N/A            200
</p>
<p>
<br/>
</p>
<h3>
【来源】
</h3>
<p>
by stdafx
</p>
<p>
ps:题目异常丑陋,凑合看吧,我只是想普及下rope和可持久化平衡树
</p>
<p>
pps:数据真难造,比标算还难写
</p>
