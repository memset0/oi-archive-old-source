# 题目描述


<p>
【问题描述】
</p>
<p>
T公司是一家专门生产彩色珠子项链的公司，其生产的项链设计新颖、款式多样、价格适中，广受青年人的喜爱。最近T公司打算推出一款项链自助生产系统，使用该系统顾客可以自行设计心目中的美丽项链。
</p>
<p>
该项链自助生产系统包括硬件系统与软件系统，软件系统与用户进行交互并控制硬件系统，硬件系统接受软件系统的命令生产指定的项链。该系统的硬件系统已经完成，而软件系统尚未开发，T公司的人找到了正在参加全国信息学竞赛的你，你能帮助T公司编写一个软件模拟系统吗？
</p>
<p>
一条项链包含N个珠子，每个珠子的颜色是1, 2, …, c中的一种。项链被固定在一个平板上，平板的某个位置被标记位置1，按顺时针方向其他位置被记为2,3,…,N。
</p>
<p>
<img width="429" height="447" src="../../../../mw/images/7/77/Necklace2007.jpg" alt="Image:Necklace2007.jpg"/> 
</p>
<p>
你将要编写的软件系统应支持如下命令：
</p>
<table border="1">
<tbody>
<tr>
<td width="155">
命令
</td>
<td width="144">
参数限制
</td>
<td width="326">
内容
</td>
</tr>
<tr>
<td>
R k
</td>
<td>
0<k<n< td=""></k<n<>
</td>
<td>
意为Rotate k。将项链在平板上顺时针旋转k个位置, 即原来处于位置1的珠子将转至位置k+1，处于位置2的珠子将转至位置k+2，依次类推。
</td>
</tr>
<tr>
<td>
F
</td>
<td>
 
</td>
<td>
意为Flip。将平板沿着给定的对称轴翻转，原来处于位置1的珠子不动，位置2上的珠子与位置N上的珠子互换，位置3上的珠子与位置N-1上的珠子互换，依次类推。
</td>
</tr>
<tr>
<td>
S i j
</td>
<td>
1≤i , j≤N
</td>
<td>
意为Swap i , j。将位置i上的珠子与位置j上的珠子互换。
</td>
</tr>
<tr>
<td>
P i j x
</td>
<td>
1≤i , j≤N, x≤c
</td>
<td>
意为Paint i , j , x。将位置i沿顺时针方向到位置j的一段染为颜色x。
</td>
</tr>
<tr>
<td>
C
</td>
<td>
 
</td>
<td>
意为Count。查询当前的项链由多少个“部分”组成，我们称项链中颜色相同的一段为一个“部分”
</td>
</tr>
<tr>
<td>
CS i j
</td>
<td>
1≤i , j≤N
</td>
<td>
意为CountSegment i , j。查询从位置i沿顺时针方向到位置j的一段中有多少个部分组成。
</td>
</tr>
</tbody>
</table>
<p>
【输入文件】
</p>
<p>
输入文件第一行包含两个整数N, c，分别表示项链包含的珠子数目以及颜色数目。第二行包含N个整数，x1, x2…, xn，表示从位置1到位置N的珠子的颜色，1 ≤xi ≤c。第三行包含一个整数Q，表示命令数目。接下来的Q行每行一条命令，如上文所述。
</p>
<p>
【输出文件】
</p>
<p>
对于每一个C和CS命令，应输出一个整数代表相应的答案。
</p>
<p>
【输入样例】
</p>
<pre>5 3
1 2 3 2 1
4
C
R 2
P 5 5 2
CS 4 1
</pre>
<p>
【输出样例】
</p>
<pre>4
1
</pre>
<p>
【评分方法】
</p>
<p>
本题没有部分分，你的程序的输出只有和标准答案完全一致才能获得满分， 否则不得分。
</p>
<p>
【数据规模和约定】
</p>
<ul>
<li>
对于60%的数据，N ≤1 000，Q ≤1 000；
</li>
<li>
对于100%的数据，N ≤500 000，Q ≤500 000，c ≤1 000。
</li>
</ul>
