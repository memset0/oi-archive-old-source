# 题目描述


<h3>
【题目描述】
</h3>
<p>
Z 国有n座城市，n − 1条双向道路，每条双向道路连接两座城市，且任意两座城市都能通过若干条道路相互到达。
</p>
<p>
Z 国的国防部长小 Z 要在城市中驻扎军队。驻扎军队需要满足如下几个条件：
</p>
<p>
⚫一座城市可以驻扎一支军队，也可以不驻扎军队。
</p>
<p>
⚫由道路直接连接的两座城市中至少要有一座城市驻扎军队。
</p>
<p>
⚫在城市里驻扎军队会产生花费，在编号为i的城市中驻扎军队的花费是pi。
</p>
<p>
小 Z 很快就规划出了一种驻扎军队的方案，使总花费最小。但是国王又给小 Z 提出了m个要求，每个要求规定了其中两座城市是否驻扎军队。小 Z 需要针对每个要求逐一给出回答。具体而言，如果国王提出的第j个要求能够满足上述驻扎条件（不需要考虑第 j  个要求之外的其它要求），则需要给出在此要求前提下驻扎军队的最小开销。如果国王提出的第j个要求无法满足，则需要输出-1 (1 ≤ j ≤ m)。现在请你来帮助小 Z。
</p>
<h3>
【输入格式】
</h3>
<p>
第 1 行包含两个正整数n, m和一个字符串type，分别表示城市数、要求数和数据类型。type是一个由大写字母 A，B 或 C 和一个数字 1，2，3 组成的字符串。它可以帮助你获得部分分。你可能不需要用到这个参数。这个参数的含义在【数据规模与约定】中有具体的描述。
</p>
<p>
第2行n个整数pi，表示编号i的城市中驻扎军队的花费。
</p>
<p>
接下来n − 1行，每行两个正整数u, v，表示有一条u到v的双向道路。
</p>
<p>
接下来m行，第j行四个整数a, x, b, y(a ≠ b)，表示第j个要求是在城市a驻扎x支军队，在城市b驻扎y支军队。其中，x  、 y  的取值只有 0 或 1：若 x 为 0，表示城市 a 不得驻扎军队，若 x 为 1，表示城市 a 必须驻扎军队；若 y 为 0，表示城市 b 不得驻扎军队，若 y 为 1，表示城市 b 必须驻扎军队。
</p>
<p>
输入文件中每一行相邻的两个数据之间均用一个空格分隔。
</p>
<h3>
【输出格式】
</h3>
<p>
输出共m行，每行包含 1  个整数，第j行表示在满足国王第j个要求时的最小开销，如果无法满足国王的第j个要求，则该行输出-1。
</p>
<h3>
【样例输入1】
</h3>
<pre>5 3 C3
2 4 1 3 9
1 5
5 2
5 3
3 4
1 0 3 0
2 1 3 1
1 0 5 0
</pre>
<h3>
【样例输出1】
</h3>
<pre>12
7
-1
</pre>
<h3>
【样例解释】
</h3>
<p>
对于第一个要求，在 4 号和 5 号城市驻扎军队时开销最小。
</p>
<p>
对于第二个要求，在 1 号、2 号、3 号城市驻扎军队时开销最小。
</p>
<p>
第三个要求是无法满足的，因为在 1 号、5 号城市都不驻扎军队就意味着由道路直接连接的两座城市中都没有驻扎军队。
</p>
<h3>
【输入输出样例2】
</h3>
<p>
<a class="ke-insertfile" href="/upload/file/20181113/20181113110745_84311.zip" target="_blank">数据样例2</a> 
</p>
<h3>
【数据规模与约定】
</h3>
<p>
<img src="/upload/image/20181113/20181113104924_59693.jpg" alt=""/> 
</p>
<p>
数据类型的含义：
</p>
<p>
A：城市i与城市i + 1直接相连。
</p>
<p>
B：任意城市与城市 1 的距离不超过 100（距离定义为最短路径上边的数量），即如果这棵树以 1 号城市为根，深度不超过 100。
</p>
<p>
C：在树的形态上无特殊约束。
</p>
<p>
1：询问时保证a = 1, x = 1，即要求在城市 1 驻军。对b, y没有限制。
</p>
<p>
2：询问时保证a, b是相邻的（由一条道路直接连通）
</p>
<p>
3：在询问上无特殊约束。
</p>
<h3>
【来源】
</h3>
<p>
NOIP 2018 Day 2 Task 3
</p>
