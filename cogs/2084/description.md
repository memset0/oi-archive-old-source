# 题目描述


<h3>
【题目描述】
</h3>
<p>
<br/>
</p>
<p>
“有句美国俗语说，如果走起来像鸭子，叫起来像鸭子，那就是一只鸭子。”斯科特·华莱士看着Asm.Def面前屏幕上滚动的绿色字符，若有所思地说。
</p>
<p>
“什么意思？”
</p>
<p>
“你的数据。看上去是一棵树。”
</p>
<p>
“按照保密条令，我什么也不说这是最好的——但见你这么热情，一句话不说也不好。”Asm.Def停下手中的快速数论变换，“确实是树。”
</p>
<p>
“然后你怎么算出来目标的位置？”
</p>
<p>
“都需要按照基本算法，按照图论的那一套理论，去产生。听说过LCA吗？不是那个印度飞机，我是说最近公共祖先……”
</p>
<p>
<img src="/upload/image/20151102/20151102074424_70821.jpg" alt=""/> 
</p>
<p>
Asm.Def通过分析无线电信号得到了一棵有n个节点，以1为根的树。除1之外，节点i的父亲是p_i。节点带有权值，节点i的权值是w_i。
</p>
<p>
我们定义某点的祖先为从根到它路径上的所有点（包括它本身），而两个节点a、b的最近公共祖先是某个点p，使得p同时是a、b的祖先，而且p离根最远。
</p>
<p>
Asm.Def想要求出
</p>
<p>
<img src="/upload/image/20151102/20151102062808_87121.jpg" alt=""/> 
</p>
<p>
（文字：∑∑w_i*w_j*w_LCA(i,j)），
</p>
<p>
其中LCA(i,j)是i、j的最近公共祖先，他认为这个值至关重要。由于这个值可能很大，Asm.Def只需要知道它模1,000,000,007（即10^9+7）的结果。
</p>
<p>
<br/>
</p>
<h3>
【输入格式】
</h3>
<p>
<br/>
</p>
<p>
第1行两个整数：n和w_1.
</p>
<p>
第2行到第n行，第i行有两个整数p_i和w_i。
</p>
<p>
<br/>
</p>
<h3>
【输出格式】
</h3>
<p>
一行一个整数，即答案模1,000,000,007的值。
</p>
<h3>
【样例输入】
</h3>
<pre>2 2
1 1</pre>
<h3>
【样例输出】
</h3>
<pre>17</pre>
<h3>
【提示】
</h3>
<p>
<br/>
</p>
<p>
1×1×1+1×2×2+2×1×2+2×2×2=17。
</p>
<p>
对于30%的数据，n&lt;=100，w_i&lt;=10。
</p>
<p>
对于60%的数据，n&lt;=1000，w_i&lt;=1000.
</p>
<p>
对于100%的数据，1&lt;=n&lt;=10^5，0&lt;=w_i&lt;=10^9，1&lt;=p_i&lt;i.
</p>
<p>
<br/>
</p>
<h3>
【来源】
</h3>
<p>
“Asm.Def战记之太平洋”杯
</p>
