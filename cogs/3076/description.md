# 题目描述


<h3>
【题目描述】
</h3>
<p>
小 P 和小 Z 经常在一起切磋智商，今天他们在玩填数游戏。
</p>
<p>
现在有一张n*m的矩阵，矩阵中每个格子只能填1或-1，小 P 已经提前在矩阵中填好了k个格子，现在他问小 Z，有多少种不同的方法填剩下的格子，使得矩阵满足任意一行或一列中所有数的积都是-1？（两种方法不同当且仅当两种方法中某个格子填的数不同）。小 Z 乞求小 P 降低题目难度，于是小 P 又给出了一个条件，k<strong>严格小于</strong>n和m的最大值，且最后的答案模p就可以了。“聪明”的小 Z 还是不会做，于是他找到了你。
</p>
<h3>
【输入格式】
</h3>
<p>
输入第一行包含两个整数n和m，代表矩阵的大小。
</p>
<p>
第二行包含一个整数k，代表已经填好的格子数。
</p>
<p>
接下来k行，每行三个整数a,b,c，代表第a行，第b列，填了数c。
</p>
<p>
最后一行包含一个整数p，代表需要将答案模p。
</p>
<h3>
【输出格式】
</h3>
<p>
输出只有一行，一个整数表示最后的答案。
</p>
<h3>
【样例输入1】
</h3>
<p>
2 2
</p>
<p>
1
</p>
<p>
2 2 -1
</p>
<p>
2333
</p>
<h3>
【样例输出1】
</h3>
1
<h3>
【样例输入2】
</h3>
<p>
983 533
</p>
<p>
3
</p>
<p>
1 3 1
</p>
<p>
4 2 -1
</p>
<p>
100 100 1
</p>
<p>
666666666
</p>
<h3>
【样例输出2】
</h3>
<pre>195328496
</pre>
<h3>
【样例1说明】
</h3>
<p>
<br/>
</p>
<p>
2×2 的矩阵，右下角填了-1，所以只有
</p>
<p>
-1 1
</p>
<p>
1 -1
</p>
<p>
这一种填法。
</p>
<p>
<br/>
</p>
<h3>
【数据规模与约定】
</h3>
<p>
<br/>
</p>
<p>
对于 30%的数据，1 ≤ n*m ≤ 21。
</p>
<p>
对于 70%的数据，1 ≤ n,m ≤ 1000。
</p>
<p>
其中有 10%的数据，1 ≤ n,m ≤ 1000,k = 0
</p>
<p>
对于 100%的数据，1 ≤ n,m ≤ 1000000,
</p>
<p>
0 ≤ k &lt; max (n,m),
</p>
<p>
1 ≤ a ≤ n, 1 ≤ b ≤ m, c∈ {1,-1},
</p>
<p>
2 ≤ p ≤ 10^9 + 7,
</p>
<p>
数据保证不会出现一个格子填两次。
</p>
<p>
<br/>
</p>
