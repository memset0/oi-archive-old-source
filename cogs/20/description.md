# 题目描述


<div>
【问题描述】
</div>
<div>
    信息的明文是由0利1组成的非空序列。但在网络通信中，为了信息的安全性，常对明文进行加密，用密文进行传输。密文是由0、1和若干个密码字母组成，每个密码字母代表不同的01串，例如，密文=011a0bf00a01。密码破译的关键是确定每个密码的含义。
</div>
<div>
    经过长期统计分析，现在知道了每个密码的固定长度，如今，我方又截获了敌方的两段密文S1和S2，并且知道S1=S2，即两段密文代表相同的明文。你的任务是帮助情报人员对给定的两段密文进行分析，看一看有多少种可能的明文。
</div>
<div>
【输入文件】
</div>
<div>
第1行： S1 (第1段密文)<br/>
第2行： S2 (第2段密文)<br/>
第3行： N (密码总数， N&lt;=26)<br/>
第4—N+3行： 字母i 长度i (密码用小写英文字母表示， 密码长度&lt;=100)<br/>
 
</div>
<div>
【输出文件】
</div>
<div>
M（表示有M种可能的明文）<br/>
 
</div>
<div>
【输入输出样例】
</div>
<div>
encrypt.in
</div>
<div>
100ad1<br/>
cc1<br/>
4<br/>
a 2 <br/>
d 3 <br/>
c 4 <br/>
b 50
</div>
<div>
encrypt.out
</div>
<div>
2
</div>
<div>
【约束条件】
</div>
<div align="left">
明文的长度&lt;=10000
</div>
<div align="left">
注意：
</div>
<div align="left">
如果两个密文出现矛盾情况，则输出0。
</div>
