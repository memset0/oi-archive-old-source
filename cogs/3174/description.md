# 题目描述


<h3>
【题目描述】
</h3>
<p>
布基纳法索空军最近在瓦加杜古上空18000米处发现了一艘残破的航天母舰，在经过精细的搜查之后，布基纳法索空军发现这架空母上的大多数武器装置仍处于工作状态！如果让其启动，那么整个国家甚至周边地区都有可能遭受灭顶之灾！所幸整架空母之上的唯一一位幸存者——一位自称HS的神奇生物在见到布基纳法索空军之后告诉空军们关闭武器系统的方式——把船拆了。可是由于HS的身体构造过于神奇，被布基纳法索国家医院征用去做活体解剖了，空军战士们只能自行拆船
</p>
<p>
<strong>研究发现，空母由N个子舱室和M个活塞组成，只要按照正确的方式推动活塞，舱室就会自动解体。但是要推动活塞需要在活塞相连的两个舱室分别施加一定的力（别问我为什么不能只推一个）并且两个力之间有一定约束关系。综上，布基纳法索空军决定在每个舱室上放一定量的炸药，用冲击力推动活塞</strong> 
</p>
<p>
下面给出舱室间推力关系（T,A,B)
</p>
<p>
T=1代表A舱与B舱推力相等
</p>
<p>
T=2代表A舱推力小于B舱
</p>
<p>
T=3代表A舱推力不小于B舱
</p>
<p>
T=4代表A舱推力大于B舱
</p>
<p>
T=5代表A舱推力不大于B舱
</p>
<p>
<strong>由于炸药用量和所产生推力成正比，因此上述关系可视为在各舱室放置炸药数量的关系</strong> 
</p>
<p>
<strong>为了尽可能的减少炸药的用量，你需要求出整个爆破过程炸药的消耗总量（其中最少的舱室放置1单位的炸药，各舱室炸药量为整单位）</strong> 
</p>
<p>
如果不可能完成任务，输出-1
</p>
<h3>
【输入格式】
</h3>
<p>
第一行两个正整数N,M
</p>
<p>
下面M行每行描述一组（T,A,B)关系
</p>
<p>
输出只有一行
</p>
<p>
最小炸药用量或-1
</p>
<h3>
【样例输入】<br/>
</h3>
<p>
<br/>
</p>
<p>
5 7
</p>
<p>
1 1 2
</p>
<p>
2 3 2
</p>
<p>
4 4 1
</p>
<p>
3 4 5
</p>
<p>
5 4 5
</p>
<p>
2 3 5
</p>
<p>
4 5 1
</p>
<p>
<br/>
</p>
<h3>
【样例输出】<br/>
</h3>
<p>
11
</p>
<h3>
【提示】<br/>
</h3>
<p>
N,M&lt;=10^5
</p>
<p>
此题为Tarjan裸题，仅供练习
</p>
<p>
请勿使用SPFA最短路算法
</p>
<h3>
【来源】
</h3>
<p>
改编自SCOI2011
</p>
