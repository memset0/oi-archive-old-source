# 题目描述


<h3>
【题目描述】
</h3>
<p>
给出一个长度为n序列,维护一种操作和查询,若操作为Modify x y,则将在x位置上的数乘y,若为Query l r p,则输出l到r区间全部数的乘积中个小于等于p的质因子的幂次之和,如l到r的乘积为24,即为2^3*3^1,若p=1,则结果为0,若p=2,则结果为3.
</p>
<h3>
【输入格式】
</h3>
<p>
第一行两个数n,m分别为序列的长度和操作的次数,接下来1行,n个数为初始序列的每个数,接下来m行,若操作为Modify,则后有两个数x,y,若为Query,则后面有三个数l,r,q.
</p>
<h3>
【输出格式】
</h3>
<p>
对应所有的Query操作,输出对应的结果,每行一个.
</p>
<h3>
【样例输入】
</h3>
<pre><p>
3 2
</p>

<p>
24 24 3
</p>

<p>
Modify 3 8
</p>

<p>
Query 1 3 2
</p>
</pre>
<h3>
【样例输出】
</h3>
<pre>9</pre>
<h3>
【提示】
</h3>
<p>
样例说明:
</p>
<p>
 对第三个数乘8后为24,1到3的乘积分解质因数为2^9*3^3,那么小于等于2的质因子只有2,幂次为9故结果为9.
</p>
<p>
数据范围约定:
</p>
<p>
 对于20%的数据,n&lt;=10,m&lt;=10,询问的乘积不会超过10^5.
</p>
<p>
 对于另外40%的数据,n&lt;=100000,m&lt;=50000,询问的乘积不会超过64位整形.
</p>
<p>
 对于剩余的数据,n&lt;=100000,m&lt;=200000,询问的乘积不会超过10^10000
</p>
<p>
 对于全部数据保证不会出现超过400的质因子.
</p>
<h3>
【来源】
</h3>
<p>
by stdafx
</p>
