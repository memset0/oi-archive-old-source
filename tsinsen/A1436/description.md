<div id="pcont1" style="margin-top:20px; display:block;">

# 问题描述

<div class="pdcont">　　小Gennady生日时收到了一副骨牌。这副骨牌包含28块2*1的不同的骨牌，骨牌的每一半包含一个0到6的数字。如下所示：<br/>
　　0-0 0-1 0-2 0-3 0-4 0-5 0-6<br/>
　　1-1 1-2 1-3 1-4 1-5 1-6<br/>
　　2-2 2-3 2-4 2-5 2-6<br/>
　　3-3 3-4 3-5 3-6<br/>
　　4-4 4-5 4-6<br/>
　　5-5 5-6<br/>
　　6-6<br/>
　　一个包含了28个骨牌的图被叫成magic，仅当能被14个互不相交的2*2的方块覆盖，每个方块能由4个相同的数字组成。每次Gennady拼出一个magic图后，这副骨牌发挥它的魔力——让他赢下下场比赛。但Gennady发现他不能拼已经拼过的图，否则别人会赢得比赛。<br/>
　　Gennady选择了一个n*m的棋盘，并在上面放了许多1*2的矩形小片。每个小片恰好占领了棋盘上的两个相邻方格，这些小片不能重叠，但可以互相接触。棋盘上总共有28个小片，和骨牌个数相同。现在，Gennady要把每个小片换成骨牌，拼出magic图片。不同的小片应被替换成不同骨牌。请算出在小片位置给定的情况下，Gennady能赢得接下来的几场比赛，并且你要给出一种方案来赢得下一场CF。<br/>
<img width="503" height="479" src="source/tsinsen/A1436/img/aHR0cDovL3d3dy50c2luc2VuLmNvbS9SZXF1aXJlRmlsZS5kbz9maWQ9VE1CVEJOOE0=.do"/></div>
# 输入格式

<div class="pdcont">　　第一行包含两个正整数n,m (1 ≤ n, m ≤ 30)。接下来的n行，每行包含m个字符，表示棋盘上小片的位置。点表示空格，字母 &#34;a&#34; 到 &#34;z&#34; 和 &#34;A, &#34;B&#34;表示小片的位置。棋盘上恰好有28个小片，被同一小片覆盖的方格用同一个字母，而不同小片用不同字母表示。棋盘信息保证合法。数据保证至少有一解。</div>
# 输出格式

<div class="pdcont">　　第一行一个数字，表示把小片换成骨牌，拼成magic图片的方案，也就是通过这种小片排列能够赢得的比赛总数。接下来n行，每行包含m个字符，每个字符是点或数字0到6，表示任一合法解。所有骨牌必须不同。</div>
# 样例输入

<div class="pddata">8 8<br/>
.aabbcc.<br/>
.defghi.<br/>
kdefghij<br/>
klmnopqj<br/>
.lmnopq.<br/>
.rstuvw.<br/>
xrstuvwy<br/>
xzzAABBy</div>
# 样例输出

<div class="pddata">10080<br/>
.001122.<br/>
.001122.<br/>
33440055<br/>
33440055<br/>
.225566.<br/>
.225566.<br/>
66113344<br/>
66113344</div>
# 数据规模和约定

<div class="pdcont">　　对于30%的数据1 ≤ n, m ≤ 15；<br/>
　　对于60%的数据1 ≤ n, m ≤ 20；<br/>
　　对于100%的数据1 ≤ n, m ≤ 30；</div>

</div>