<div id="pcont1" style="margin-top:20px; display:block;">

# 问题描述

<div class="pdcont">　　现在你需要帮助一批在太平洋某个小岛上的研究人员，他们研究的是很多年前居住在这个岛上的古代部落文化。<br/>
<br/>
　　他们总共发现了N个村落，其中某几对村落之间有道路相连，这些道路从两个方向都可以走。总共有N-1条道路，并且任意两个村落能够互相到达。<br/>
<br/>
　　这些部落并不和平，经常会有战争。在一次战争结束后，某些村落将会被完全摧毁，在经过一段和平的年代后，某些村庄可能会被重建。<br/>
<br/>
　　在任意一个时刻，任意两个没有被摧毁的村庄之间的道路是被人们使用的。换句话说，找到一个最小的边集，它们把所有的未被摧毁的村庄连在一起，使它们两两可达。注意在这个岛的历史上，只存在这些研究者发现的N-1条道路。<br/>
<br/>
　　研究人员认为观察不同时间使用道路的长度和能够帮助理解这个部落的文化，并解决一些历史问题。<br/>
<br/>
　　你会得到这个部落的所有历史。你的任务是在某些时刻，确定使用道路的长度和。</div>
# 输入格式

<div class="pdcont">　　第一行一个整数n(1&lt;=n&lt;=10^5)表示岛上的村落数目&gt;<br/>
<br/>
　　接下来的n-1行每行3个整数 u v w  (1&lt;=u,v&lt;=n,u!=v,1&lt;=w&lt;=10^9)表示在第u个村落和第v个村落之间有长度为w的边<br/>
<br/>
　　下一行一个整数q(1&lt;=q&lt;=10^5)，表示询问个数<br/>
<br/>
　　接下来q行每行描述一个操作<br/>
<br/>
　　有以下三种形式：<br/>
<br/>
　　&#34;+ x&#34; — 第x个村庄被重建 (1 ≤ x ≤ n).<br/>
<br/>
　　&#34;- x&#34; — 第x个村庄被摧毁 (1 ≤ x ≤ n).<br/>
<br/>
　　&#34;?&#34; —考古学家想要知道此时使用的道路总长度<br/>
<br/>
<br/>
<br/>
　　保证每个操作都是合法的，即不会出现摧毁不存在的村落或者重建已存在的村落<br/>
<br/>
　　保证至少有一个“？”<br/>
<br/>
　　也保证在询问时刻有解</div>
# 输出格式

<div class="pdcont">　　每个“？“对应一个整数为询问的结果</div>
# 样例输入

<div class="pddata">6<br/>
1 2 1<br/>
1 3 5<br/>
4 1 7<br/>
4 5 3<br/>
6 4 2<br/>
10<br/>
+ 3<br/>
+ 1<br/>
?<br/>
+ 6<br/>
?<br/>
+ 5<br/>
?<br/>
- 6<br/>
- 3<br/>
?</div>
# 样例输出

<div class="pddata">5<br/>
14<br/>
17<br/>
10</div>

</div>