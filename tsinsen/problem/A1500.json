{"title":"Alice与能源计划（罗剑桥）","time_limit":2000,"memory_limit":512,"url":"http://www.tsinsen.com/A1500","statement":[{"title":"","format":"html","require":["katex"],"content":"\n<div id=\"pcont1\" style=\"margin-top:20px; display:block;\">\n"},{"title":"# 问题描述","format":"html","require":["katex"],"content":"\n<div class=\"pdcont\">　　在梦境中，Alice来到了火星。不知为何，转眼间Alice被任命为火星能源部长，并立刻面临着一个严峻的考验。<br/>\n　　......<br/>\n　　为了方便，我们可以将火星抽象成平面，并建立平面直角坐标系。<br/>\n　　火星上一共有<i>N</i>个居民点。每个居民点认为是平面上的一个点。第<i>i</i>个居民点的坐标为(<i>X<sub>i</sub>, Y<sub>i</sub></i>），对能源的需求量为<i>Power<sub>i</sub></i>。每个居民点消耗的能源由它附近的发电站提供。由于技术原因，<b>一个居民点消耗的所有能源必须来自同一座发电站</b>。<br/>\n　　自人类移民火星之初，政府就有一个规模宏大的发电站建设计划。<br/>\n　　按照这个计划，政府将在火星上建立<i>M</i>座发电站，这<i>M</i>座发电站将是火星居民的全部能量来源。其中，第<i>i</i>座发电站的坐标为(<i>x<sub>i</sub>, y<sub>i</sub></i>)，产生能量的上限值为<i>Limit<sub>i</sub></i>，建设费用为<i>Price<sub>i</sub></i>。同样由于技术原因，第<i>i</i>座发电站只能为<b>与它的距离不超过</b><b><i>R<sub>i</sub></i></b><b>的居民点</b>提供能源。<br/>\n　　然而，由于政府的财政状况一直十分紧张，截至目前，这<i>M</i>座发电站中只有少量建成并投入使用，多数的发电站尚未开始建设。<br/>\n　　......<br/>\n　　Alice的任务是修改这个计划，使得它更符合实际情况。根据新的规定，<b>一座发电站产生的所有能源必须提供给同一个居民点</b>。Alice知道这个规定意味着<i>N</i>个居民点消耗的能源将分别由<i>N</i>座不同的发电站提供，而且为第i个居民点提供能源的那座发电站的<i>Limit</i>值一定不小于<i>Power<sub>i</sub></i>。<br/>\n　　......<br/>\n　　Alice需要在原计划的<i>M</i>座发电站中<b>选择恰好</b><b><i>N</i></b><b>座发电站</b>，并完全放弃剩余的<i>M - N</i>座发电站，使得这<i>N</i>座发电站能够满足<i>N</i>个居民点的需要。<br/>\n　　对于一个可行的方案，设方案中选择的<i>N</i>座发电站构成集合<i>S</i>，而已经建成的发电站构成集合<i>T</i>，那么定义这个方案的代价为<br/>\n<br/>\n<i></i><br/>\n　　<img src=\"source/tsinsen/A1500/img/aHR0cDovL3d3dy50c2luc2VuLmNvbS9SZXF1aXJlRmlsZS5kbz9maWQ9QkdnTTZGVEY=.do\" width=\"326\" height=\"60\"/>.<br/>\n　　即，一个方案的代价等于<b>被选择的且尚未建成</b>的发电站的建设费用之和加上<b>没有被选择的且已经建成</b>的发电站的建设费用之和。<br/>\n　　......<br/>\n　　在所有可行方案中，你必须帮助Alice找到<b>代价最小</b>的方案，并将选择的<i>N</i>座发电站<b>按编号从小到大的顺序</b>输出。<br/>\n　　如果代价最小的方案不唯一，则输出其中<b>字典序最小</b>的方案。<br/>\n　　......<br/>\n<b>注意，输入文件包含多组测试数据。</b><b></b></div>"},{"title":"# 输入格式","format":"html","require":["katex"],"content":"\n<div class=\"pdcont\">　　第一行包含一个正整数<i>T</i>，表示有<i>T</i>组测试数据。接下来依次是<i>T</i>组测试数据。<br/>\n　　每组测试数据的第一行包含两个整数<i>N</i><i>、</i><i>M</i>。<br/>\n　　接下来<i>N</i>行，每行<i>3</i>个整数：<i>X<sub>i</sub></i><i>、</i><i>Y<sub>i</sub></i><i>、</i><i>Power<sub>i</sub></i>。<br/>\n　　再接下来<i>M</i>行，每行<i>6</i>个整数：<i>x<sub>i</sub></i><i>、</i><i> y<sub>i</sub></i><i>、</i><i>Limit<sub>i</sub></i><i>、</i><i>Price<sub>i</sub></i><i>、</i><i>R<sub>i</sub></i><i>、</i><i>Finished<sub>i</sub></i><i>。</i>若<i>Finished<sub>i </sub>= 1</i>，表示第<i>i</i>座发电站已经建成；否则<i>Finished<sub>i</sub> = 0</i><i>，</i>表示第<i>i</i>座发电站尚未开始建设。<i></i></div>"},{"title":"# 输出格式","format":"html","require":["katex"],"content":"\n<div class=\"pdcont\">　　对于每组测试数据：<br/>\n　　若<b>存在</b>可行方案则输出两行。第一行为一个整数，表示最小代价；第二行是若干个递增的整数，表示<b>字典序最小的最优方案</b>选择的发电站的编号。<br/>\n　　若<b>不存在</b>可行方案，则仅输出一行为一个整数<i>-1</i>。</div>"},{"title":"# 样例输入","format":"html","require":["katex"],"content":"\n<div class=\"pddata\">4<br/>\n1 1<br/>\n4 4 1<br/>\n8 7 1 2 5 1<br/>\n2 3<br/>\n0 0 3<br/>\n2 0 2<br/>\n1 1 5 1 3 0<br/>\n1 0 5 1 1 1<br/>\n3 0 5 1 3 0<br/>\n2 3<br/>\n0 0 3<br/>\n2 0 2<br/>\n1 1 2 0 3 0<br/>\n1 0 1 0 1 1<br/>\n3 0 3 0 2 0<br/>\n2 3<br/>\n0 0 3<br/>\n2 0 2<br/>\n1 1 4 2 2 0<br/>\n1 0 2 9 1 1<br/>\n3 0 5 4 2 1</div>"},{"title":"# 样例输出","format":"html","require":["katex"],"content":"\n<div class=\"pddata\">0<br/>\n1<br/>\n1<br/>\n1 2<br/>\n-1<br/>\n6<br/>\n1 2</div>"},{"title":"# 样例说明","format":"html","require":["katex"],"content":"\n<div class=\"pdcont\">　　第<i>1</i>组测试数据：<br/>\n　　只有一个居民点，其坐标为(<i>4, 4</i>)，能源需求量<i>Power<sub>1</sub> = 1</i>；仅一座发电站，其坐标为(<i>8, 7</i>)，产生的能量上限<i>Limit<sub>1</sub> = 1</i>，建设费用<i>Price<sub>1</sub> = 2</i>，服务范围半径<i>R<sub>1</sub> = 5</i>，<i>Finished<sub>1</sub> = 1</i>表示已经建成。<br/>\n　　两个点之间的距离等于<i>5</i>不超过<i>R<sub>1</sub></i>，并且<i>Power<sub>1</sub></i> <i>≤</i><i> Limit<sub>1</sub></i>。因此唯一的可行方案是花费<i>0</i>的代价保留<i>1</i>号发电站，使它为<i>1</i>号居民点提供能源。<br/>\n<br/>\n　　第<i>2</i>组测试数据：任意选择两个发电站都是一个可行方案。最小代价是<i>1</i><i>，</i>对应的方案有两种：选择<i>1</i>号和<i>2</i>号发电站；选择<i>2</i>号和<i>3</i>号发电站。而前者的字典序更小。<br/>\n　　第<i>3</i>组测试数据：不存在可行方案。<br/>\n　　第<i>4</i>组测试数据：代价最小的方案唯一：选择<i>1</i>号和<i>2</i>号发电站，代价为<i>6</i>。</div>"},{"title":"# 数据规模和约定","format":"html","require":["katex"],"content":"\n<div class=\"pdcont\">　　对于<i>40%</i>的数据：<i>1 </i><i>≤</i><i> N, M </i><i>≤</i><i> 16</i>。<br/>\n　　此外<i>20%</i>的数据：对于任意发电站<i>i</i>有<i>Price<sub>i</sub> = 0</i>。<br/>\n　　对于<i>70%</i>的数据：<i>1 </i><i>≤</i><i> N </i><i>≤</i><i> 50</i><i>，</i><i>1 </i><i>≤</i><i> M </i><i>≤</i><i> 100</i>。<br/>\n　　对于<i>100%</i>的数据：<i>1 </i><i>≤</i><i> N </i><i>≤</i><i> 400</i><i>，</i><i>1 </i><i>≤</i><i> M </i><i>≤</i><i> 500</i><i>，</i><i>1 </i><i>≤</i><i> T </i><i>≤</i><i> 10</i><i>，</i><i>0 </i><i>≤</i><i> x<sub>i</sub>, y<sub>i </sub>, X<sub>i </sub>, Y<sub>i</sub>, Price<sub>i</sub> </i><i>≤</i><i> 10 000</i><i>，</i><i>1 </i><i>≤</i><i> R<sub>i</sub>, Power<sub>i</sub>, Limit<sub>i</sub> </i><i>≤</i><i> 10 000</i><i>。</i>不同的居民点或发电站的坐标有可能重合。</div>"},{"title":"# 附注","format":"html","require":["katex"],"content":"\n<div class=\"pdcont\">　　关于方案的字典序的大小关系的说明：<br/>\n<br/>\n　　设方案<i>A</i>选择的<i>N</i>座发电站的编号从小到大依次为<i>A<sub>1</sub>, A<sub>2</sub>, </i>…<i>, A<sub>N</sub></i>；设方案<i>B</i>选择的<i>N</i>座发电站的编号从小到大依次为<i>B<sub>1</sub>, B<sub>2</sub>, </i>…<i>, B<sub>N</sub></i>。<br/>\n　　我们称方案<i>A</i>比方案<i>B</i>字典序更小，当且仅当存在正整数<i>i</i>，满足<i>1≤i≤N，</i>使得对任意<i>1≤k≤i-1</i>有<i>A<sub>k</sub> = B<sub>k</sub></i>，且<i>A<sub>i</sub> &lt; B<sub>i</sub></i>。</div>\n\n</div>\n"}]}