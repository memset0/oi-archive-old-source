{"title":"Data Compression","time_limit":1000,"memory_limit":512,"url":"http://www.tsinsen.com/A1291","statement":[{"title":"","format":"html","require":["katex"],"content":"\n<div id=\"pcont1\" style=\"margin-top:20px; display:block;\">\n"},{"title":"# 问题描述","format":"html","require":["katex"],"content":"\n<div class=\"pdcont\">　　Please compress a string which consists of capital letters only. To compress the string, <i>N</i> rules are given, each of which is a string of three letters <i>c</i><sub>1</sub> <i>c</i><sub>2</sub> <i>c</i><sub>3</sub>, meaning that two consecutive letters <i>c</i><sub>2</sub> <i>c</i><sub>3</sub> can be replaced with one letter <i>c</i><sub>1</sub>.<br/>\n　　Besides, there is a set <i>S</i> of letters. The final compressed string should only contain letters in <i>S</i>, as short as possible.</div>"},{"title":"# 输入格式","format":"html","require":["katex"],"content":"\n<div class=\"pdcont\">　　The first line of the input is an integer <i>N</i>, the number of rules.<br/>\n　　Each of the following <i>N</i> lines contains three capital letters, <i>c</i><sub>1</sub> <i>c</i><sub>2</sub> <i>c</i><sub>3</sub>.<br/>\n　　The next line contains the string needed to be compressed and the last line contains <i>S</i>, the set of letters that can appear in the final string.</div>"},{"title":"# 输出格式","format":"html","require":["katex"],"content":"\n<div class=\"pdcont\">　　The output should contain exactly one line with one integer, the shortest length of the final compressed string. If there is no solution, output –1.</div>"},{"title":"# 样例输入","format":"html","require":["katex"],"content":"\n<div class=\"pddata\">4<br/>\nABC<br/>\nBCC<br/>\nCDD<br/>\nAAA<br/>\nCCDD<br/>\nAD</div>"},{"title":"# 样例输出","format":"html","require":["katex"],"content":"\n<div class=\"pddata\">1</div>"},{"title":"# Constraints","format":"html","require":["katex"],"content":"\n<div class=\"pdcont\">　　For all test cases, <i>N</i> ≤ 5000, and the length of the original string is no larger than 100.</div>\n\n</div>\n"}]}