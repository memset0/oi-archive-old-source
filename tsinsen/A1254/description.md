<div id="pcont1" style="margin-top:20px; display:block;">

# 问题描述

<div class="pdcont">　　Ray 乐忠于旅游，这次他来到了T 城。T 城是一个水上城市，一共有<br/>
　　N 个景点，有些景点之间会用一座桥连接。为了方便游客到达每个景点但<br/>
　　又为了节约成本，T 城的任意两个景点之间有且只有一条路径。换句话说，<br/>
　　T 城中只有N - 1 座桥。Ray 发现，有些桥上可以看到美丽的景色，让人<br/>
　　心情愉悦，但有些桥狭窄泥泞，令人烦躁。于是，他给每座桥定义一个愉<br/>
　　悦度w，也就是说，Ray 经过这座桥会增加w 的愉悦度，这或许是正的也<br/>
　　可能是负的。有时，Ray 看待同一座桥的心情也会发生改变。现在，Ray<br/>
　　想让你帮他计算从u 景点到v 景点能获得的总愉悦度。有时，他还想知道<br/>
　　某段路上最美丽的桥所提供的最大愉悦度，或是某段路上最糟糕的一座桥<br/>
　　提供的最低愉悦度。</div>
# 输入格式

<div class="pdcont">　　输入的第一行包含一个整数N，表示T 城中的景点个数。N &lt;=<br/>
　　100000。<br/>
　　接下来N - 1 行，每行三个整数u、v 和w，表示有一条u 到v，使<br/>
　　Ray 愉悦度增加w 的桥。桥的编号为0 ... N - 1。|w| &lt;= 1000。<br/>
　　输入的第N + 1 行包含一个整数M，表示Ray 的操作数目。M &lt;=<br/>
　　500000。<br/>
　　接下来的M 行，操作有如下三种形式：<br/>
　　C i w，表示Ray 对于经过第i 座桥的愉悦度变成了w。<br/>
　　N u v，表示Ray 对于经过景点u 到v 的路径上的每一座桥的愉悦度<br/>
　　都变成原来的相反数。<br/>
　　SUM u v，表示询问从景点u 到v 所获得的总愉悦度。<br/>
　　MAX u v，表示询问从景点u 到v 的路径上的所有桥中某一座桥所提<br/>
　　供的最大愉悦度。<br/>
　　MIN u v，表示询问从景点u 到v 的路径上的所有桥中某一座桥所提<br/>
　　供的最小愉悦度。<br/>
　　测试数据保证，任意时刻，Ray 对于经过每一座桥的愉悦度的绝对值<br/>
　　小于等于1000。</div>
# 输出格式

<div class="pdcont">　　对于每一个询问(操作S、MAX 和MIN)，输出答案。<br/>
　　7</div>
# 样例输入

<div class="pddata">3<br/>
1 1<br/>
1 2 2<br/>
8<br/>
SUM 0 2<br/>
MAX 0 2<br/>
N 0 1<br/>
SUM 0 2<br/>
MIN 0 2<br/>
C 1 3<br/>
SUM 0 2<br/>
MAX 0 2</div>
# 样例输出

<div class="pddata">3<br/>
2<br/>
1<br/>
-1<br/>
5<br/>
3</div>

</div>