<div id="pcont1" style="margin-top:20px; display:block;">

# 问题描述

<div class="pdcont">　　Hudson夫人已经很久没有做她拿手的煎饼了，不过最终她还是决定再次做起来。她最近学到了m种新的食谱，于是她迫不及待地准备尝试。这些食谱由n种配料组成。Hudson夫人在厨房标有0到n-1的瓶子里装有这些调料（每种调料都被装在不同的瓶子里）。每个瓶子里的配料都有其相应的价格——ai。<br/>
　　对于第i种煎饼食谱，我们都知道三个数：di，si，ci。这里d和ci均为整数，si是一个di进制的数字系统所写出的字符串。这个字符串包含数字、拉丁字母（表示大于9的数字）和问号。如果把si中的问号替换为数字和字母可以变成x（比较时忽略前导0），则称di进制数字x和字符串si是匹配的。每个问号恰好替换为一个数字或字母。若我们替换了所有问号，我们可以删去前导0变成一个数字。例如：11进制数字40A9875和字符串“??4??987?”匹配，4A9875则不匹配。<br/>
　　为了用第i种方法烹饪煎饼，Hudson夫人需要所有与字符串si匹配的数字的瓶子。定义食谱i的指令数字（zi）为所有瓶子的配料价格积与ci的和。即zi=ci+pi(aj)，（j是满足匹配的数字）Hudson夫人对指令数字本身并不感兴趣，她只想知道这个数字的最小质因数。所以你的任务是对于每个食谱i，输出zi的最小约数，如果它大于100则输出-1。</div>
# 输入格式

<div class="pdcont">　　第一行一个数n（1&lt;=n&lt;=10000）。第二行包含了有空格隔开的整数表示配料价格a0，a1，...，a(n-1)。（1&lt;=ai&lt;=10^18）。<br/>
　　第三行包含一个数m（1&lt;=m&lt;=30000）——Hudson夫人学到的食谱数。<br/>
　　接下来m行描述食谱，每行一个。开始读入由十进制写成的di（2&lt;=di&lt;=16）。隔开一个空格接下来字符串si——一个长为1到30的字符串。由“0”至“9”和“A”至“F”以及“?”构成字母“A”到“F”分别对应数字10到15。保证所有数字或相应字母严格小于di。最后隔开一个空格读入由十进制写成的整数ci（1&lt;=ci&lt;=10^18）。</div>
# 输出格式

<div class="pdcont">　　对于每一种食谱输出一行，指令数字最小质因子，若其大于100则输出-1。</div>
# 样例输入

<div class="pddata">4<br/>
2 3 5 7<br/>
4<br/>
2 ?0 11<br/>
2 ?1 13<br/>
2 0? 17<br/>
2 1? 19</div>
# 样例输出

<div class="pddata">3<br/>
2<br/>
23<br/>
2</div>
# 样例说明

<div class="pdcont">　　有四个瓶子，标号为0到3，而其价格分别为2，3，5，7。所有配料编号二进制下都是两位数，第一种配料第二个数字为0，第二种配料第二个数字为1，第三种配料第一个数字为0，第三种配料第二个数字为1，所以指令数字分别如下：第一种2×5+11=21（答案为3），第二种3×7+13=44（答案为2），第三种2×3+17=23（答案为23），第四种5×7+19=54（答案为2）。</div>

</div>