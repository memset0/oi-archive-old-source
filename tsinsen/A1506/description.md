<div id="pcont1" style="margin-top:20px; display:block;">

# 问题描述

<div class="pdcont">　　你有一棵以1号节点为根的有根树。。。</div>
# 输入格式

<div class="pdcont">　　第一行一个数n 表示节点个数<br/>
　　第2到n行，每行一个数x，第i行的x表示i节点的父亲为x<br/>
　　接下来一个数m，表示操作与询问个数的总和<br/>
　　接下来m行，每行的开头有1个数p<br/>
　　若p为0，则接下来有2个数x，y，表示将x号节点的权值加上y<br/>
　　若p为1，则接下来有3个数x，y，z，表示将x号节点到y号节点的这条链上的每个节点的权值加上z<br/>
　　若p为2，则接下来有2个数x，y，表示将以x号节点为根的子树的每个节点的权值加上z<br/>
　　若p为3，则接下来有2个数x，y，表示询问x号节点到y号节点的这条链上每个节点的权值和，你需要输出这个和<br/>
　　若p为4，则接下来有2个数x，y，表示询问x号节点到y号节点的这条链上每个节点的权值的最大值，你需要输出这个最大值<br/>
　　若p为5，则接下来有2个数x，y，表示将x号节点的父亲改为y号节点</div>
# 输出格式

<div class="pdcont">　　对于每个3与4操作，输出1行，表示答案</div>
# 样例输入

<div class="pddata">3<br/>
1<br/>
1<br/>
2<br/>
1 2 3 -1<br/>
3 2 3</div>
# 样例输出

<div class="pddata">-3</div>
# 数据规模和约定

<div class="pdcont">　　保证任何时候每个节点的权值的绝对值小于40000<br/>
　　4%的数据n,m&lt;=5<br/>
　　另外12%的数据n,m&lt;=10000<br/>
　　另外40%的数据，没有5操作<br/>
　　另外20%的数据，没有2操作<br/>
　　100%的数据 N&lt;=50000，m&lt;=100000</div>

</div>