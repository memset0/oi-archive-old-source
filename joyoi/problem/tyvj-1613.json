{"title":"不和谐的公司","time_limit":1000,"memory_limit":128,"url":"http://www.joyoi.cn/problem/tyvj-1613","statement":[{"title":"","format":"markdown","require":["katex"],"content":"\n# \n\n \n # 题目描述 \n也许你不知道，百度noip贴吧其实开了一家公司，专门负责各种计算机竞赛相关事务（比如水啊，打印啊，诸如此类），赚到的钱自然是给Nettle神牛等吧主出去腐败了。&gt;_&lt;<BR>然而好景不长，这个公司越来越大，部门越来越多，待遇越来越不均衡，员工怨言越多越多，最后整个公司几乎陷于瘫痪。<BR>Nettle神牛为了解决这个问题（好让他继续出去腐败），决定精简架构。但是这并不容易，搞了半天，他把整个公司搞成了一个很诡异的结构：<BR>1）\t最高部门为贴吧管理组。<BR>2）\t每个部门要不就没有下属部门，要有就一定有且只有两个下属部门。<BR>3）\t为了公司的运作稳定，整个公司的组织架构需要扁平化，所以这个结构不会超过17层，也就是说所有部门最多只有16个上级部门（直接或间接）。<BR>对于所有没有下属部门的部门，Nettle神牛会计算出每个部门的所有人员的工资总额。而对于所有有下属部分的部门，不妨假设为i部门和j部门，那么i部门及其所有下属部门（包括直接下属和间接下属）的工资总额（假如有的话）加起来的和要等于j部门及其所有下属部门的工资总额。比如贴吧管理组下属小吧主部和技术部，技术部又下属黑客部和出题部，那么出题部加黑客部工资总额要等于小吧主部，同时黑客部的工资也要等于出题部的工资总额。这样他认为整个公司就变得非常和谐。<BR>而要达到这么一个和谐的公司，就需要调整一些没有下属部门的部门的工资。然而这也并不容易，如果调整工资的部门数量太多，员工会暴动，所以他希望调整工资的部门总数最少。请你帮忙计算出这个最小值。<BR> \n\n \n # 输入格式 \n输入第一行是一个数N，表示总共有N个部门。（1&lt;=N&lt;=2^17-1）<BR>接下来的N行，第i行有两个数或三个数，第一个数是T，表示i部门有几个下属部门，保证T=0或者T=2。若T=2，则后面还有两个数x,y，表示x部门与y部门是i的下属部门。i,x,y都是部门的编号。若T=0，后面跟着的数表示该部门的工资总额。保证每个部门的工资总额不超过10^10。<BR> \n\n \n # 输出格式 \n输出只有一个数，表示调整的部门数量最小值。 \n\n \n # 提示 \n样例解释<BR>编号为1的部门有两个下属部门2和3，2是没有下属部门的部门，工资总额为2；3有两个下属部门4、5。所以3要求平衡，题目给定的已经平衡了；1要求平衡，我们需要修改2部门的工资总额到4，这样公司就和谐了。<BR> "},{"title":"样例数据","format":"markdown","require":["katex"],"content":"<style>\n        table,table tr th, table tr td { border:1px solid #0094ff; }\n        table { width: 200px; min-height: 25px; line-height: 25px; text-align: center; border-collapse: collapse;}   \n    </style>\n<table>\n\t<tr>\n\t\t<td>输入样例</td>\n\t\t<td>输出样例</td>\n\t</tr>\n<tr><td>5\r\n2 2 3\r\n0 2\r\n2 4 5\r\n0 2\r\n0 2\r\n</td><td>1</td></tr></table>\n\n"}]}