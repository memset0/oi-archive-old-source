{"title":"小H的聚会","time_limit":1000,"memory_limit":64,"url":"http://www.joyoi.cn/problem/tyvj-3461","statement":[{"title":"","format":"markdown","require":["katex"],"content":"\n# \n\n \n # 题目描述 \n<p>\n小H的聚会（party.pas/c/cpp）\r<br>\r<br>【任务描述】\r<br>\r<br>　　小H从小就非常喜欢计算机，上了中学以后，他更是迷上了计算机编程。经过多年的不懈努力，小H幸运的被选入信息学竞赛省队，就要去他日思夜想的河南郑州参加第22届全国信息学奥林匹克竞赛（NOI2005）。\r<br>\r<br>　　小H的好朋友小Y和小Z得知了这个消息，都由衷的为他感到高兴。他们准备举办一个party，邀请小H和他的所有朋友参加，为小H庆祝一下。\r<br>\r<br>　　经过好几天的调查，小Y和小Z列出了一个小H所有好友的名单，上面一共有N个人（方便起见，我们将他们编号为1至N的整数）。然而名单上的人实在是太多了，而且其中不少人小 \r<br>Y和小Z并不认识。如何把他们都组织起来参加聚会呢？\r<br>\r<br>　　小Y和小Z希望为小H的N个好友设计一张联系的网络，这样，若某个人得知了关于聚会的最新情况，则其他人都可以直接或间接得到消息。同时为了尽量的保证消息传递得简单、高效以及最重要的一点：保密（为了给小H一个惊喜，在party的筹备阶段这个聚会的消息是绝对不能让他知道的），小Y和小Z决定让尽量少的好友直接联系：为了保证N个好友都能互相直接或间接联系到，只需要让(N-1)对好友直接联系就可以了。\r<br>\r<br><br><center><img src=\"/source/joyoi/tyvj-3461/img/aHR0cDovL3d3dy5qb3lvaS5jbi9wcm9ibGVtL3R5dmotMzQ2MS9wcm9ibGVtc19pbWFnZXMvMjI3MS9wMS5naWY=.gif\"></img></center>\r<br>\r<br>　　显然，名单上的好友也不都互相认识，而即使是两个互相认识的人，他们之间的熟悉程度也是有区别的。因此小Y和小Z又根据调查的结果，列出了一个好友间的关系表，表中标明了哪些人是可以直接联系的，而对于每一对可以互相联系的好友，小Y和小Z又为他们标出了联系的愉快程度。如3和4的关系非常好，因此标记他们之间的联系愉快程度为10；而1和3是一般的朋友，则他们的愉快程度要小一些。上面的图1表示一个N=5的联系表，其中点表示名单上的好友，边则表示两个好友可以直接联系，边上的数字即为他们联系的愉快程度。\r<br>\r<br>　　小Y和小Z希望大家都能喜欢这次聚会，因此决定在尽量最大化联系网络的愉快程度：所谓联系网络的愉快程度，即每一对直接联系人之间的愉快程度之和。如在图1中，加粗的边表示了一个让愉快程度最大联系的网络，其愉快程度为5+6+10+5=26。\r<br>\r<br>　　然而，如果让某个人直接和很多的人联系，这势必会给他增添很大的负担。因此小Y和小Z还为每个人分别设定了一个最大的直接联系人数ki，表示在联系网络中，最多只能有ki个人和i直接联系。\r<br>\r<br>　　还是用图1的例子，若我们为1至5每个点分别加上了ki = 1, 1, 4, 2, 2的限制，则上述方案就不能满足要求了。此时的最优方案如图2所示，其愉快程度为3+6+10+5 = 24。\r<br>\r<br>\r<br><br><center><img src=\"/source/joyoi/tyvj-3461/img/aHR0cDovL3d3dy5qb3lvaS5jbi9wcm9ibGVtL3R5dmotMzQ2MS9wcm9ibGVtc19pbWFnZXMvMjI3MS9wMi5naWY=.gif\"></img></center>\r<br>\r<br>　　你能帮小Y和小Z求出在满足限制条件的前提下，愉快程度尽量大的一个联系网络吗？\r<br></p> \n\n \n # 输入格式 \n<p>\n　　输入文件party.in的第1行都是两个整数N和M。N表示小H的好友总数，M表示小Y和小Z列出来的可以直接联系的好友对数。输入文件的第2行包含N个在[1, N-1]范围内的整数，依次描述k1, k2, …, kN。相邻的两个数字之间用一个空格隔开。以下M行，每行描述一对可以互相联系的好友，格式为ui vi ci。表示ui和vi可以直接联系，他们的联系愉快程度为ci。\r<br>\r<br>　　另外，在所有这些数据的最后还有单独的一行包括一个(0, 1]范围内的实数d作为评分系数。你的程序并不需要去理会这个参数，但你可以根据这个参数的提示去设计不同的算法。有关d的说明，可以参见后面的评分方法。\r<br></p> \n\n \n # 输出格式 \n<p>\n　　输出文件Party.out的第1行为一个整数，表示你找到的最大的愉快程度。\r<br>　　以下(N-1)行，描述这个网络。每行一个数ei，表示在网络中，让输入文件中第(ei + 2)行描述的一对好友直接联系。</p> "},{"title":"# 样例数据","format":"markdown","require":["katex"],"content":"<style>\n        table,table tr th, table tr td { border:1px solid #0094ff; }\n        table { width: 200px; min-height: 25px; line-height: 25px; text-align: center; border-collapse: collapse;}   \n    </style>\n<table>\n\t<tr>\n\t\t<td>输入样例</td>\n\t\t<td>输出样例</td>\n\t</tr>\n<tr><td>5 6 \r\n1 1 4 2 2 \r\n1 2 5 \r\n1 3 3 \r\n2 3 6 \r\n2 5 3 \r\n3 4 10 \r\n4 5 5 \r\n0.00001 \r\n</td><td>\n24 \r\n2 \r\n3 \r\n5 \r\n6 </td></tr></table>\n\n"}]}