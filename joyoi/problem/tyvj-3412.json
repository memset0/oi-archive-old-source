{"title":"流言的传播","time_limit":1000,"memory_limit":64,"url":"http://www.joyoi.cn/problem/tyvj-3412","statement":[{"title":"","format":"markdown","require":["katex"],"content":"\n# \n\n \n # 题目描述 \n<p>\n流言的传播（rumor.pas\\c\\cpp）\r<br>\r<br>【题目描述】\r<br>　　昨天下午，Matrix67陪MM出去逛街，走累了后去咖啡店歇了歇脚；再后来MM陪Matrix67去了一趟书店，之后两人去电影院看了一场电影。从电影院出来后已经很晚了，考虑到MM的安全问题，Matrix67先送MM回到宿舍，然后自己才回去。第二天Matrix67起床后发现问题严重了：昨天和MM出去玩本来什么都没发生，但现在一些不堪入耳的流言正疯狂传播，很多细节都说得有鼻子有眼的。在澄清事实并抓出元凶的同时，Matrix67希望切断一些流言传播的路径，尽可能减缓流言传播的速度。\r<br>　　除去Matrix67和他的MM，学校里还有N个人。这N个人形成了M对双向的朋友关系，这些朋友关系连通了所有N个人。不同的朋友间传递消息的速度各不相同。如果A和B是第i对朋友，那么当其中一个人听到流言后，他会在Ti的时间内传给另一个人。现在，Matrix67只知道流言并没有传遍整个学校，但他不知道哪些人已经听说了这个流言。他希望切断尽可能少的朋友关系，使得无论是哪些人已经获知了流言，流言都无法以原来的速度传给一个新的人（即新的得知此流言的人的出现将变得更晚）。换句话说，Matrix67希望找到一个最小的边集E，使得对任意一个不等于全集的点集S，恰好只有一个顶点在S里的边中权值最小的那一条在边集E中。\r<br></p> \n\n \n # 输入格式 \n<p>\n　　输入文件rumor.in第一行输入两个用空格隔开的正整数N和M，分别表示学校的人数和朋友关系数。\r<br>    以下M行每行有三个用空格隔开的正整数，其中第i行的三个正整数为Ai, Bi, Ti，表示Ai和Bi是第i对朋友，它们之间传递消息需要Ti的时间。输入数据保证0<Ai≠Bi<=N，0<Ti<=2 000 000 000，且对任意i≠j都有Ti≠Tj。\r<br></p> \n\n \n # 输出格式 \n<p>\n　　你需要输出你所得到的最小值和具体的方案。\r<br>    输出文件rumor.out的第一行是一个正整数，代表你的最优方案中需要切断的朋友关系数。\r<br>    以下若干行每行一个正整数，表示你的方案里需要切断的朋友关系在输入数据中的编号（即你需要切断的是输入数据中给的第几条边）。这些数必须按照增序排列输出。\r<br>    如果有多种最优方案，你只需要输出其中一种即可。我们的评测系统会自动判断你的输出数据的正确性。\r<br>\r<br></p> \n\n \n # 提示 \n<p>\n【样例说明】\r<br>　　　　　　　　　　　　　　　（１）\r<br>　　　　　　　　　　　　　　　　ｏ\r<br>　　　　　　　　　　　　　　　／　＼\r<br>　　　　　　　　　　　　１　／　　　＼　２\r<br>　　　　　　　　　　　　　／　　　　　＼\r<br>（４）　ｏ－－－－－－－ｏ－－－－－－－ｏ　（２）\r<br>　　　　　　　　４　　（３）　　３　　　\r<br>　　首先，(3)---(4)这条边必须去掉，否则若只有4号同学得知流言，流言将以相同的速度传给下一个人。对于其它三条边，只需要去掉权值较小的两条即可，这样不论获知流言的是哪个（些）人，所有可以继续向外传播流言的边中最小的那一条一定已经被去掉了。可以证明，去掉三条边已经是最优的答案了。\r<br>\r<br>【数据规模】\r<br>　　对于30%的数据，N<=10，M<=20；\r<br>　　对于50%的数据，N<=100，M<=1 000；\r<br>　　对于100%的数据，N<=10 000，M<=100 000。\r<br></p> "},{"title":"# 样例数据","format":"markdown","require":["katex"],"content":"<style>\n        table,table tr th, table tr td { border:1px solid #0094ff; }\n        table { width: 200px; min-height: 25px; line-height: 25px; text-align: center; border-collapse: collapse;}   \n    </style>\n<table>\n\t<tr>\n\t\t<td>输入样例</td>\n\t\t<td>输出样例</td>\n\t</tr>\n<tr><td>4 4\r\n1 2 2\r\n4 3 4\r\n2 3 3\r\n1 3 1\r\n</td><td>\n3\r\n1\r\n2\r\n4\r\n</td></tr></table>\n\n"}]}