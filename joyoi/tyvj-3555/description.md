# 

 
 # 题目描述 
<p>
FGD想从成都去上海旅游。在旅途中他希望经过一些城市并在那里欣赏风景，品尝风味小吃或者做其他的有趣的事情。经过这些城市的顺序不是完全随意的，比如说FGD不希望在刚吃过一顿大餐之后立刻去下一个城市登山，而是希望去另外什么地方喝下午茶。幸运的是,FGD的旅程不是既定的，他可以在某些旅行方案之间进行选择。<br>由于FGD非常讨厌乘车的颠簸，他希望在满足他的要求的情况下，旅行的距离尽量短，这样他就有足够的精力来欣赏风景或者是泡MM了^_^.<br>整个城市交通网络包含N个城市以及城市与城市之间的双向道路M条。城市自1至N依次编号，道路亦然。没有从某个城市直接到它自己的道路，两个城市之间最多只有一条道路直接相连，但可以有多条连接两个城市的路径。任意两条道路如果相遇，则相遇点也必然是这N个城市之一，在中途，由于修建了立交桥和下穿隧道，道路是不会相交的。每条道路都有一个固定长度。<br>在中途，FGD想要经过K(K<=N-2)个城市。成都编号为1，上海编号为N,而FGD想要经过的N个城市编号依次为2,3,…,K+1.<br>举例来说，假设交通网络如下图。FGD想要经过城市2,3,4,5，并且在2停留的时候在3之前，而在4,5停留的时候在3之后。那么最短的旅行方案是1-2-4-3-4-5-8,总长度为19。<br>注意FGD为了从城市2到城市4可以路过城市3,但不在城市3停留。这样就不违反FGD的要求了。并且由于FGD想要走最短的路径，因此这个方案正是FGD需要的。<br><br> <br></p> 

 
 # 输入格式 
<p>
第一行包含3个整数N(2<=N<=20000),M(1<=M<=200000),K(0<=K<=20),意义如上所述。<br>以下M行，每行包含3个整数X，Y，Z，(1<=X<Y<=N, 1<=Z=1000)表示城市X与Y之间有一条双向道路。你可以认为输入文件使得一定能自成都到上海以及任何FGD想要去的城市。<br>下一行包含一个整数G(0<=G<=K*(K-1)/2).<br>以下G行，每行包含2个整数X,Y，(2<=X,Y<=K+1)表示FGD想要在游览城市Y之前,一定要游览城市X。你可以认为至少存在一种满足所有限制的游览方案。<br><br></p> 

 
 # 输出格式 
<p>
只包含一行，包含一个整数，表示最短的旅行距离。<br></p> 

 
 # 提示 
<p>
<br><img border="0" src="/source/joyoi/tyvj-3555/img/aHR0cDovL3d3dy5qb3lvaS5jbi9wcm9ibGVtL3R5dmotMzU1NS9wcm9ibGVtc19pbWFnZXMvMjM5Ni8xMDk3LmpwZw==.jpg"><br><br>上面对应于题目中给出的例子。<br></p> 
# 样例数据
<style>
        table,table tr th, table tr td { border:1px solid #0094ff; }
        table { width: 200px; min-height: 25px; line-height: 25px; text-align: center; border-collapse: collapse;}   
    </style>
<table>
	<tr>
		<td>输入样例</td>
		<td>输出样例</td>
	</tr>
<tr><td>8 15 4
1 2 3
1 3 4
1 4 4
1 6 2
1 7 3
2 3 6
2 4 2
2 5 2
3 4 3
3 6 3
3 8 6
4 5 2
4 8 6
5 7 4
5 8 6
3
2 3
3 4
3 5

</td><td>
19

</td></tr></table>
