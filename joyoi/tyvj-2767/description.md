# 

 
 # 题目描述 
<p>
一个由0和1构成的非空序列叫做一个二进制序列。一个二进制等式指的是两个二进制序列完全相等（长度及每一位都对应相等）。例如1001=1001，但100不等于10,110不等于011.<br>一个二进制方程是一个形如X1X2 .. Xp= Y1Y2 .. Yq 的方程。Xi，Yi是二进制数字（ 0或1 ）或一个用小写字母表示的未知数。每一个未知数的解是一个二进制序列，且每个未知数的解的长度是已知的。每组解必须满足在方程中把未知数替换成该解后的两个二进制序列完全相等。<br>比如若a=1001，那么1a10的二进制序列就是1100110（即用1001去替代a）。<br>对于方程1a=a1，若a的长度为1，则有唯一解a=1，此时11=11，而a=0不满足。<br>而对于方程ab=ba，若a，b的长度都为1，则有两组解（a=1，b=1），（a=0，b=0）. 若a，b的长度都为2,则有4组解.<br>现在将给出你方程,需要你求方程有多少组解.<br></p> 

 
 # 输入格式 
<p>
本题有多组数据，第一行一个T(T<=5),表示有T组数据.每组数据描述了一个方程。<br>接下来描述这T组数据.每组数据的第一行为N(0<=N<=26),表示未知数的个数, 未知数的名称按字母表顺序标号,从1到N依次为a,b,c......下一行是用空格分开的N个正整数,依次表示未知数的长度.(注意可能有未知数没有在方程中出现),再下一行一个L,（L<=10000）表示方程左边表达式的长度,接着一行有一个长度为L的字符串描述了方程左边.表达式的格式如上文所说(或见样例)。下面两行描述了方程的右边,格式和规模和左边一样. <br>数据保证方程的一边把未知数替换成它的解后的二进制序列的总长度S<=10000(若a=1001，那么1a10的总长度为7)<br></p> 

 
 # 输出格式 
<p>
T行,每行一个整数表示该方程的解数。</p> 

 
 # 提示 
<p>
数据规模：<br>40%的数据,有N<=10,所有未知数的长度和Sum<=20,L<=10.<br>100%的数据如题目所说。	<br></p> 
# 样例数据
<style>
        table,table tr th, table tr td { border:1px solid #0094ff; }
        table { width: 200px; min-height: 25px; line-height: 25px; text-align: center; border-collapse: collapse;}   
    </style>
<table>
	<tr>
		<td>输入样例</td>
		<td>输出样例</td>
	</tr>
<tr><td>2
5
4 2 4 4 2
5
1bad1
4
acbe
1
2
5
11111
5
11111
</td><td>16
4	</td></tr></table>
