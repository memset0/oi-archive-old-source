# 

 
 # 题目背景 
李元芳在X掉铁手团8大高手后吐血坠河失忆。。<BR>焦急如焚的如燕请学OI的你帮助来建立脑神经联系。。 

 
 # 题目描述 
姑且假设如燕有一台显微镜，能够看到元芳大脑中的情况。她发现了一片可以建立联系的神经元(可以看做点)，不妨标号1~n，只要建立从1~n的联系，元芳就可以恢复记忆。当然在1~n中，可以在一些神经元之间建立联系，然而每一个联系都有一定的副作用。生物学中，大脑的神经元是一个微观世界，因此每个联系的副作用值(权值)会通过字符串间接体现。<BR>下面我们规定：<BR>（1）如果该字符串是一个数(保证首位不为0)，那么它就用来直接运算。<BR>（2）如果该字符串就是'memory'，那么副作用为0；<BR>（3）如果该字符串直接包含"memory"且不是memory本身，则副作用为1；<BR>（4）在不满足1,2,3的情况下，如果该字符串的最长上升子序列的长度大于等于'memory'的长度，则副作用为2；<BR>（5）不属于上述情况的，副作用为它的长度。<BR>PS.：以上“包含”指的是包含memory这个整体，换句话说，memory是连着的才算包含。<BR><BR>请求出建立1~n的联系所需的最小副作用。<BR><BR>数据范围：字符串长度&lt;=255&nbsp;&nbsp;&nbsp;&nbsp;2&lt;=n&lt;=100<BR><BR>数据保证字符串要么全部由数字组成(可以直接运算)，要么全部由小写字母组成(需要进行处理)。<BR>数据也保证字符串后边没有多余的空格。<BR>数据还保证从1到n有路可走。<BR><BR>20%的数据满足数据中只含有数字而不涉及字符串处理问题<BR>100%的数据中有的字符串是一串小写字母，有的是一个数。<BR>无向图，无负权。<BR> 

 
 # 输入格式 
第一行n,m&nbsp;&nbsp;&nbsp;&nbsp;m表示有m对联系可供选择<BR>接下来m行，每行的格式为：<BR>x&nbsp;&nbsp;&nbsp;y&nbsp;&nbsp;string<BR>表示从x号神经元到y号神经元的联系，副作用是通过string这个字符串体现的。<BR>再次提醒：无向图。<BR>数据保证一个字符串要么全由数字组成，要么全由小写字母组成,字符串后无多余空格。<BR>2&lt;=n&lt;=100,1&lt;=m&lt;=1000<BR> 

 
 # 输出格式 
1~n建立联系的最小副作用<BR> 

 
 # 提示 
By&nbsp;Lydliyudong 
# 样例数据
<style>
        table,table tr th, table tr td { border:1px solid #0094ff; }
        table { width: 200px; min-height: 25px; line-height: 25px; text-align: center; border-collapse: collapse;}   
    </style>
<table>
	<tr>
		<td>输入样例</td>
		<td>输出样例</td>
	</tr>
<tr><td>5 6
1 3 memory  //本身是memory，副作用0
1 2 orzlyd     //副作用为它的长度
2 3 firstprize
3 5 phantom
1 5 provinceteam
4 5 abcdefghijklmn //最长上升子序列长度大于6，副作用为2

//评测的输入数据当然不会有这些注释的。。。
</td><td>7
//即从1->3->5</td></tr></table>
