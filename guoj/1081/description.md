
# 题目描述

> "Um ba ba be
>
> Um ba ba be
>
> De day da
>
> Ee day da, that's okay
>
> It's the terror of knowing
>
> What the world is about
>
> Watching some good friends
>
> Screaming 'Let me out'
>
> Pray tomorrow gets me higher"

"Under Pressure"是一首节奏欢快的歌。

作为贝斯手，John 在弹奏的时候有着自己的独特技巧，同时，人们都不知道的是，John 的贝斯不同于一般人的贝斯。

John 的贝斯非比寻常，上面有 $n$ 个按键，第 $i$ 个按键有一个力度上限 $A_i$，即John能按在这个键上的力度范围为 $[0,A_i]$，当按键的力度为 $x_i$ 时，会产生 $B_ix_i+C_i$ 的美妙值。

John 在弹奏的时候，会以一定的力度按下每个按键，记在第 $i​ $个按键按下的力度为 $x_i​$，那么记 $T​$ 等于所有美妙值在 $k​$ 进制下做逐位取 $\max​$ 得到的值，John 会得到 $F(T)​$ 作为本次弹奏的愉悦值。

其中 $F(T)$ 是一个关于 $k$ 进制数 $T$ 的函数，定义如下：

- 有 $k$ 个参数 $f(0..k-1)$，其中保证 $f(0)=0$
- 记 $T=\sum_i t_i\times k^i$，其中 $0\le t_i<k$
- $F(T)=\sum_i f(t_i)$

对两个 $k​$ 进制数逐位取 $\max​$ 得到的值定义如下：

- 有两个 $k​$ 进制数 $U=\sum_i u_i\times k ^i,V=\sum_i v_i\times k^i​$，其中 $0\le u_i,v_i<k​$
- 对 $U,V$ 进行 $k$ 进制 $\max$ 得到：$S=\sum_i (\max(u_i,v_i))\times k^i$
- 此运算显然满足结合律。

一天 John 在家里胡乱弹奏，他突发奇想：如果他将所有按键的方式（共 $\prod_{i=1}^n (A_i+1)$ 种）都尝试了，他得到的所有愉悦值的和是多少呢？

请你帮 John 求出答案，由于答案可能很大，请将答案对 $998244353$ 取模后输出。

# 输入格式

从标准输入读入。

第一行两个整数 $n$ 和 $k$。

第二行 $k$ 个整数，表示 $f(0..k-1)$

接下来 $n$ 行，每行是三个整数 $A,B,C​$，描述一个按键。

# 输出格式

输出到标准输出。

一行一个整数，表示答案对 $998244353$ 取模的结果。

# 样例

#### 样例输入1

```plain
5 5
0 1 1 1 1
6 1 2
5 3 2
4 9 9
1 3 4
5 7 3
```

#### 样例输出1

```plain
6885
```

#### 样例输入2

```plain
5 5
0 394347332 534387138 126207763 295315762
157 444284501 114863663
99 388981206 286410605
614 161427159 156989404
694 297937698 73297712
711 110500264 749342295
```

#### 样例输出2

```plain
552249614
```

# 数据范围与提示

本题采用捆绑测试。

对于所有数据，$0\le A_i,B_i,C_i\le 10^9,1\le n\le 100,1\le k\le 1000,0\le f(i)<10^9+7​$，保证$f(0)=0​$

子任务如下：

- Subtask1（10分）$A_i\le 1000​$
- Subtask2（20分）$k=2​$
- Subtask3（10分）$k\le 300,B_i,C_i< k$
- Subtask4（30分）$1\le n\le 100,1\le k\le 80$
- Subtask5（10分）$1\le n\le 100,1\le k\le 300$
- Subtask6（20分）无特殊限制。

命题人：samjia2000

