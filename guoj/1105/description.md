
# 题目描述

有一棵$n$个点的树，每个节点上有一个权值$w_i$，最开始根为$1$号点．现在有$3$种类型的操作：

 - `1 root`, 表示将根设为$root$.
 - `2 u v x`, 设$u, v$的最近公共祖先为$p$, 将$p$的子树中的所有点的权值加上$x$.
 - `3 u`, 查询$u$的子树中的所有点的权值和．

对于每个$3$操作，输出答案．

# 输入格式

第一行三个整数$n, q$，表示树的大小以及操作个数.

接下来一行$n$个整数表示$w_i$.

接下来$n - 1$行，每行两个整数$u, v$, 描述树上的一条边．

接下来$q$行，每行描述一个操作，格式见问题描述． 

# 输出格式

对于每个$3$操作，输出一行一个整数表示答案．

# 样例

**样例 1 输入**
```
6 7
1 4 2 8 5 7
1 2
3 1
4 3
4 5
3 6
3 1
2 4 6 3
3 4
1 6
2 2 4 -5
1 4
3 3
```

**样例 1 输出**
```
27
19
5
```

本题有附加样例，请自行下载。

# 数据范围与提示

对于所有数据，有$1 \leq n, q \leq 3 \times 10^5, -10^7 \leq w_i, x \leq 10^7$.

| 子任务编号 |        $n,q$         |    特殊限制    | 分值 |
| :--------: | :------------------: | :------------: | :--: |
|     1      |     $\leq 10^3$      |       无       |  19  |
|     2      |     $\leq 10^5$      |  没有$1$操作   |  21  |
|     3      |     $\leq 10^5$      |  没有$2$操作   |  16  |
|     4      |     $\leq 10^5$      | $2$操作中$u=v$ |  27  |
|     5      | $\leq 3 \times 10^5$ |       无       |  17  |

本题将使用捆绑测试。

出题人：dy0607

来源：HNOI 2018 省队集训 Day 1 T1

