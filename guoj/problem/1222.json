{"title":"「NOI2001」陨石的秘密                              ","time_limit":3000,"memory_limit":64,"url":"https://guoj.icu/problem/1222","statement":[{"title":"# 题目描述","format":"markdown","require":["katex"],"content":"\n公元 $11380$ 年，一颗巨大的陨石坠落在南极。于是，灾难降临了，地球上出现了一系列反常的现象。当人们焦急万分的时候，一支中国科学家组成的南极考察队赶到了出事地点。经过一番侦察，科学家们发现陨石上刻有若干行密文，每一行都包含 $5$ 个整数：\r\n\r\n```plain\r\n1 1 1 1 6\r\n0 0 6 3 57\r\n8 0 11 3 2845\r\n```\r\n\r\n著名的科学家 SS 发现，这些密文实际上是一种复杂运算的结果。为了便于大家理解这种运算，他定义了一种 SS 表达式：\r\n1. SS 表达式是仅由‘`{`’，‘`}`’，‘`[`’，‘`]`’，‘`(`’，‘`)`’组成的字符串。\r\n2. 一个空串是 SS 表达式。\r\n3. 如果 $A$ 是 SS 表达式，且 $A$ 中不含字符‘`{`’，‘`}`’，‘`[`’，‘`]`’，则 `(`$A$`)`是 SS 表达式。\r\n4. 如果 $A$ 是 SS 表达式，且 $A$ 中不含字符‘`{`’，‘`}`’，则`[`$A$`]`是 SS 表达式。\r\n5. 如果 $A$ 是 SS 表达式，则`{`$A$`}`是 SS 表达式。\r\n6. 如果 $A$ 和 $B$ 都是 SS 表达式，则 AB 也是 SS 表达式。\r\n\r\n例如\r\n\r\n```plain\r\n()(())[]\r\n{()[()]}\r\n{{[[(())]]}}\r\n```\r\n\r\n都是 SS 表达式。\r\n\r\n而\r\n\r\n```plain\r\n()([])()\r\n[()\r\n```\r\n\r\n不是 SS 表达式。\r\n\r\n一个 SS 表达式 $E$ 的深度 $D(E)$ 定义如下：\r\n$$\r\nD(E)=\\left\\{\r\n\\begin{aligned}\r\n&0,&\\text{如果 }E\\text{ 是空串}\\\\\r\n&D(A)+1,&\\text{如果 }E=\\texttt{(}a\\texttt{)}\\text{ 或者 }E=\\texttt{[}a\\texttt{]}\\text{ 或者 }E=\\texttt{\\{}a\\texttt{\\}}\\\\\r\n&\\max(D(A),D(B)),&\\text{如果 }E=AB\\text{,其中 }A,B\\text{ 是 SS 表达式}\r\n\\end{aligned}\r\n\\right.\r\n$$\r\n例如 `(){()}[]` 的深度为 $2$。\r\n\r\n密文中的复杂运算是这样进行的：\r\n\r\n设密文中每行前 $4$ 个数依次为 $L1$，$L2$，$L3$，$D$，求出所有深度为 $D$，含有 $L1$ 对 `{}`，$L2$ 对 `[]`，$L3$ 对 `()` 的 $SS$ 串的个数，并用这个数对当前的年份 $11380$ 求余数，这个余数就是密文中每行的第 $5$ 个数，我们称之为“神秘数”。\r\n\r\n密文中某些行的第五个数已经模糊不清，而这些数字正是揭开陨石秘密的钥匙。现在科学家们聘请你来计算这个神秘数。\r\n\r\n\n"},{"title":"# 输入格式","format":"markdown","require":["katex"],"content":"\n共一行，$4$ 个整数 $L1$，$L2$，$L3$，$D$。相邻两个数之间用一个空格分隔。\n"},{"title":"# 输出格式","format":"markdown","require":["katex"],"content":"\n共一行，包含一个整数，即神秘数。\n"},{"title":"# 样例","format":"markdown","require":["katex"],"content":"\n#### 样例输入\r\n```plain\r\n1 1 1 2\r\n```\r\n\r\n#### 输出样例\r\n```plain\r\n8\r\n```\r\n\n"},{"title":"# 数据范围与提示","format":"markdown","require":["katex"],"content":"\n对于全部的数据，$0\\leqslant L1\\leqslant 10$，$0\\leqslant L2\\leqslant 10$，$0\\leqslant L3\\leqslant 10$，$0\\leqslant D\\leqslant 30$。\n\n\n"}]}