{"title":"「NOI2007」生成树计数                              ","time_limit":1000,"memory_limit":128,"url":"https://guoj.icu/problem/1257","statement":[{"title":"# 题目描述","format":"markdown","require":["katex"],"content":"\n最近，小栋在无向连通图的生成树个数计算方面有了惊人的进展，他发现：\r\n\r\n- $n$ 个结点的环的生成树个数为 $n$。\r\n- $n$ 个结点的完全图的生成树个数为 $n^{n-2}$。\r\n\r\n这两个发现让小栋欣喜若狂，由此更加坚定了他继续计算生成树个数的想法，他要计算出各种各样图的生成树数目。\r\n\r\n一天，小栋和同学聚会，大家围坐在一张大圆桌周围。小栋看了看，马上想到了生成树问题。如果把每个同学看成一个结点，邻座（结点间距离为 $1$）的同学间连一条边，就变成了一个环。可是，小栋对环的计数已经十分娴熟且不再感兴趣。于是，小栋又把图变了一下：不仅把邻座的同学之间连一条边，还把相隔一个座位（结点间距离为 $2$）的同学之间也连一条边，将结点间有边直接相连的这两种情况统称为有边相连，如图 $1$ 所示。\r\n\r\n![](/source/guoj/1257/img/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMDYvMjQvNWQxMDExNWYzZWM1ZDQ2MjM3LnBuZw==.png)\r\n\r\n小栋以前没有计算过这类图的生成树个数，但是，他想起了老师讲过的计算任意图的生成树个数的一种通用方法：构造一个 $n\\times n$ 的矩阵 $A=\\{a_{ij}\\}$。\r\n\r\n$$\r\n\\text{其中 }a_{ij}=\\left\\{\r\n\\begin{aligned}\r\n&d_i&,i=j\\\\\r\n&-1&,i\\text{ 与 }j\\text{ 有边相连}\\\\\r\n&0&,\\text{其他}\r\n\\end{aligned}\r\n\\right.\r\n$$\r\n\r\n其中 $d_i$ 表示结点 $i$ 的度数。\r\n\r\n与图 $1$ 相应的 $A$ 矩阵如下所示。为了计算图 $1$ 所对应的生成数的个数，只要去掉矩阵 $A$ 的最后一行和最后一列，得到一个 $(n-1)\\times (n-1)$ 的矩阵 $B$，计算出矩阵 $B$ 的行列式的值便可得到图 $1$ 的生成树的个数。\r\n\r\n$$\r\nA=\\begin{bmatrix}\r\n4&-1&-1&0&0&0&-1&-1\\\\\r\n-1&4&-1&-1&0&0&0&-1\\\\\r\n-1&-1&4&-1&-1&0&0&0\\\\\r\n0&-1&-1&4&-1&-1&0&0\\\\\r\n0&0&-1&-1&4&-1&-1&0\\\\\r\n0&0&0&-1&-1&4&-1&-1\\\\\r\n-1&0&0&0&-1&-1&4&-1\\\\\r\n-1&-1&0&0&0&-1&-1&4\\\\\r\n\\end{bmatrix}\\ \r\nB=\\begin{bmatrix}\r\n4&-1&-1&0&0&0&-1\\\\\r\n-1&4&-1&-1&0&0&0\\\\\r\n-1&-1&4&-1&-1&0&0\\\\\r\n0&-1&-1&4&-1&-1&0\\\\\r\n0&0&-1&-1&4&-1&-1\\\\\r\n0&0&0&-1&-1&4&-1\\\\\r\n-1&0&0&0&-1&-1&4\r\n\\end{bmatrix}\r\n$$\r\n\r\n所以生成树的个数为 $|B|=3528$ 。小栋发现利用通用方法，因计算过于复杂而很难算出来，而且用其他方法也难以找到更简便的公式进行计算。于是，他将图做了简化，从一个地方将圆桌断开，这样所有的同学形成了一条链，连接距离为 $1$ 和距离为 $2$ 的点。例如八个点的情形如下：\r\n\r\n![](/source/guoj/1257/img/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMDYvMjQvNWQxMDEzNDc0NDg2MjY0NjM5LnBuZw==.png)\r\n\r\n这样生成树的总数就减少了很多。小栋不停的思考，一直到聚会结束，终于找到了一种快捷的方法计算出这个图的生成树个数。可是，如果把距离为 $3$ 的点也连起来，小栋就不知道如何快捷计算了。现在，请你帮助小栋计算这类图的生成树的数目。\r\n\n"},{"title":"# 输入格式","format":"markdown","require":["katex"],"content":"\n输入文件中包含两个整数 $k,n$，由一个空格分隔。$k$ 表示要将所有距离不超过 $k$（含 $k$）的结点连接起来，$n$ 表示有 $n$ 个结点。\n"},{"title":"# 输出格式","format":"markdown","require":["katex"],"content":"\n输出文件输出一个整数，表示生成树的个数。由于答案可能比较大，所以你只要输出答案除 $65521$ 的余数即可。\n"},{"title":"# 样例","format":"markdown","require":["katex"],"content":"\n#### 样例输入\r\n```plain\r\n3 5\r\n```\r\n#### 样例输出\r\n```plain\r\n75\r\n```\r\n#### 样例说明\r\n\r\n样例对应的图如下：\r\n\r\n![](/source/guoj/1257/img/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMDYvMjQvNWQxMDEzZGYyZjM5ZTUxMTYyLnBuZw==.png)\r\n\r\n$$\r\nA=\\begin{bmatrix}\r\n3&-1&-1&-1&0\\\\\r\n-1&4&-1&-1&-1\\\\\r\n-1&-1&4&-1&-1\\\\\r\n-1&-1&-1&4&-1\\\\\r\n0&-1&-1&-1&3\r\n\\end{bmatrix}\\ \r\nB=\\begin{bmatrix}\r\n3&-1&-1&-1\\\\\r\n-1&4&-1&-1\\\\\r\n-1&-1&4&-1\\\\\r\n-1&-1&-1&4\r\n\\end{bmatrix}\\ \r\n|B|=75\r\n$$\n"},{"title":"# 数据范围与提示","format":"markdown","require":["katex"],"content":"\n对于所有的数据 $2\\le k\\le n$\r\n\r\n|数据编号|$k$ 范围|$n$ 范围|数据编号|$k$ 范围|$n$ 范围|\r\n|:-:|:-:|:-:|:-:|:-:|:-:|\r\n|$1$|$k=2$|$n\\le 10$|$6$|$k\\le 5$|$n\\le 100$|\r\n|$2$|$k=3$|$n=5$|$7$|$k\\le 3$|$n\\le 2000$|\r\n|$3$|$k=4$|$n\\le 10$|$8$|$k\\le 5$|$n\\le 10000$|\r\n|$4$|$k=5$|$n=10$|$9$|$k\\le 3$|$n\\le 10^{15}$|\r\n|$5$|$k\\le 3$|$n\\le 100$|$10$|$k\\le 5$|$n\\le 10^{15}$|\r\n\r\n#### 提示\r\n\r\n行列式的一种计算方法，记 $\\alpha(P)$ 表示 $P$ 中逆序对的个数，令 $B$ 的行列式\r\n\r\n$$\r\n|B|=\\sum_{P=p_1p_2\\cdots p_n\\text{ 是 }1\\text{ 到 }n\\text{ 的排列}}(-1)^{\\alpha(P)}\\prod_{i=1}^nb_{i,p_i}\r\n$$\r\n\r\n如 $B=\\begin{bmatrix}1&2&3\\\\4&5&6\\\\7&8&9\\end{bmatrix}$，则计算如下：\r\n\r\n|$P$|$\\alpha(P)$|$b_{1,p_1}$|$b_{2,p_2}$|$b_{3,p_3}$|$(-1)^{\\alpha(P)}\\prod_{i=1}^nb_{i,p_i}$|\r\n|:-:|:-:|:-:|:-:|:-:|:-:|\r\n|$1\\ 2\\ 3$|$0$|$1$|$5$|$0$<!---->|$0$|\r\n|$1\\ 3\\ 2$|$1$|$1$<!---->|$6$|$8$|$-48$|\r\n|$2\\ 1\\ 3$|$1$<!---->|$2$|$4$|$0$|$0$<!---->|\r\n|$2\\ 3\\ 1$|$2$|$2$<!---->|$6$|$7$|$84$|\r\n|$3\\ 1\\ 2$|$2$<!---->|$3$|$4$|$8$|$96$|\r\n|$3\\ 2\\ 1$|$3$|$3$<!---->|$5$|$7$|$-105$|\r\n\r\n所以 $B$ 的行列式为 $0-48+0+84+96-105=27$。\n\n\n"}]}