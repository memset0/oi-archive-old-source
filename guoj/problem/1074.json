{"title":"「HNOI2019」白兔之舞                              ","time_limit":2000,"memory_limit":512,"url":"https://guoj.icu/problem/1074","statement":[{"title":"题目描述","format":"markdown","require":["katex"],"content":"\n有一张顶点数为 $(L+1)\\times n$ 的有向图。这张图的每个顶点由一个二元组 $(u,v)$ 表示 $(0\\le u\\le L,1\\le v\\le n)$。这张图不是简单图，对于任意两个顶点 $(u_1,v_1),(u_2,v_2)$，如果 $u_1<u_2$，则从 $(u_1,v_1)$ 到 $(u_2,v_2)$ 一共有 $w(v_1,v_2)$ 条不同的边，如果 $u_1\\ge u_2$ 则没有边。\r\n\r\n白兔将在这张图上上演一支舞曲。白兔初始时位于该有向图的顶点 $(0,x)$。\r\n\r\n白兔将会跳若干步。每一步，白兔会从当前顶点沿任意一条出边跳到下一个顶点。白兔可以在任意时候停止跳舞（也可以没有跳就直接结束）。当到达第一维为 $L$ 的顶点就不得不停止，因为该顶点没有出边。\r\n\r\n假设白兔停止时，跳了 $m$ 步，白兔会把这只舞曲给记录下来成为一个序列。序列的第 $i$ 个元素为它第 $i$ 步经过的边。\r\n\r\n问题来了：给定正整数 $k$ 和 $y\\ (1\\le y\\le n)$，对于每个 $t\\ (0\\le t<k)$，求有多少种舞曲（假设其长度为 $m$）满足 $m \\bmod k=t$，且白兔最后停在了坐标第二维为 $y$ 的顶点？\r\n\r\n两支舞曲不同定义为它们的长度（$m$）不同或者存在某一步它们所走的边不同。\r\n\r\n输出的结果对 $p$ 取模。\n"},{"title":"输入格式","format":"markdown","require":["katex"],"content":"\n第一行六个用空格隔开的整数 $n,k,L,x,y,p$。\r\n\r\n接下来 $n$ 行，每行有 $n$ 个用空格隔开的整数，第 $i$ 行的第 $j$ 个数表示 $w(i,j)$。\n"},{"title":"输出格式","format":"markdown","require":["katex"],"content":"\n依次输出 $k$ 行，每行一个数表示答案对 $p$ 取模的结果。\n"},{"title":"样例","format":"markdown","require":["katex"],"content":"\n#### 样例输入 1\r\n```plain\r\n2 2 3 1 1 998244353\r\n2 1\r\n1 0\r\n```\r\n#### 样例输出 1\r\n```plain\r\n16\r\n18\r\n```\r\n#### 样例说明 1\r\n$t=0$：\r\n1. 路径长度为 $0$，方案数为 $1$。\r\n2. 路径长度为 $2$，一共有六类路径：\r\n    - $(0,1)\\to (1,1)\\to (2,1)$ 该路径有 $w(1,1)\\times w(1,1)=4$ 条；\r\n    - $(0,1)\\to (1,1)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,1)=4$ 条；\r\n    - $(0,1)\\to (2,1)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,1)=4$ 条；\r\n    - $(0,1)\\to (1,2)\\to (2,1)$ 该路径有 $w(1,2)\\times w(2,1)=1$ 条；\r\n    - $(0,1)\\to (1,2)\\to (3,1)$ 该路径有 $w(1,2)\\times w(2,1)=1$ 条；\r\n    - $(0,1)\\to (2,2)\\to (3,1)$ 该路径有 $w(1,2)\\times w(2,1)=1$ 条；\r\n\r\n答案就为 $1+4+4+4+1+1+1=16$。\r\n\r\n$t=1$：\r\n1. 路径长度为 $1$，一共有三类路径：\r\n    - $(0,1)\\to (1,1)$ 该路径有 $w(1,1)=2$ 条；\r\n    - $(0,1)\\to (2,1)$ 该路径有 $w(1,1)=2$ 条；\r\n    - $(0,1)\\to (3,1)$ 该路径有 $w(1,1)=2$ 条；\r\n2. 路径长度为 $3$，一共有三类路径：\r\n    - $(0,1)\\to (1,1)\\to (2,1)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,1)\\times w(1,1)=8$ 条；\r\n    - $(0,1)\\to (1,1)\\to (2,2)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,2)\\times w(2,1)=2$ 条；\r\n    - $(0,1)\\to (1,2)\\to (2,1)\\to (3,1)$ 该路径有 $w(1,2)\\times w(2,1)\\times w(1,1)=2$ 条；\r\n\r\n答案就为 $2+2+2+8+2+2=18$。\r\n\r\n#### 样例输入 2\r\n```plain\r\n3 4 100 1 3 998244353\r\n1 1 1\r\n1 1 1\r\n1 1 1\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n506551216\r\n528858062\r\n469849094\r\n818871911\r\n```\n"},{"title":"数据范围与提示","format":"markdown","require":["katex"],"content":"\n对于全部数据，$p$ 为一个质数，$10^8<p<2^{30}$，$1\\le n\\le 3$，$1\\le x\\le n$，$1\\le y\\le n$，$0\\le w(i,j)<p$，$1\\le k\\le 65536$，$k$ 为 $p-1$ 的约数，$1\\le L\\le 10^8$。\r\n\r\n对于每组测试点，特殊限制如下：\r\n- 测试点 $1,2$：$L\\le 10^5$；\r\n- 测试点 $3$：$n=1,w(1,1)=1$，$k$ 的最大质因子为 $2$；\r\n- 测试点 $4$：$n=1$，$k$ 的最大质因子为 $2$；\r\n- 测试点 $5$：$n=1,w(1,1)=1$；\r\n- 测试点 $6$：$n=1$；\r\n- 测试点 $7,8$：$k$ 的最大质因子为 $2$。\n\n\n"}]}