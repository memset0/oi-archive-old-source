{"title":"「余姚中学 2019 联测 Day 5」幻方                               ","time_limit":1000,"memory_limit":1024,"url":"https://guoj.icu/problem/1090","statement":[{"title":"# 题目描述","format":"markdown","require":["katex"],"content":"\n老虎和蒜头是好朋友。\r\n\r\n老虎最近在研究幻方问题。幻方问题是指，在一个 $n × n$ 的网格上填入 $1$ 至 $n × n$ 的所有数，使得\r\n每一行每一列的和，以及两条对角线的和相等。即对于这个矩阵 $a$ 来说，存在 $C$，使得：\r\n\r\n1. $\\sum_{i=1}^{n} a_{i,j} = C$ 对所有 $1 ≤ j ≤ n$ 成立。\r\n2. $\\sum_{j=1}^{n} a_{i,j} = C$ 对所有 $1 ≤ i ≤ n$ 成立。\r\n3. $\\sum_{i=1}^{n} a_{i,i} =\\sum_{i=1}^{n} a_{n−i+1,i} = C$ 成立。\r\n\r\n构造一个幻方对老虎来说太容易了。但老虎不会计算 $n × n$ 的幻方的个数，于是他去询问蒜头。蒜\r\n头自然是轻松给出了一个简单的公式。为了考察老虎到底有没有听懂，蒜头还给老虎出了一道随堂测验：\r\n求 $n × n$ 的所有模 $m$ 意义下的矩阵中，每一行每一列的和及两条对角线的和都相等的幻方个数。即对于\r\n这个矩阵 $a$，存在 $C$，使得：\r\n\r\n1. $0 ≤ a_{i,j} < m$ 对所有 $1 ≤ i ≤ n, 1 ≤ j ≤ n$ 成立\r\n2. $\\sum_{i=1}^{n} a_{i,j} ≡ C \\pmod m$ 对所有 $1 ≤ j ≤ n$ 成立。\r\n3. $\\sum_{j=1}^{n} a_{i,j} ≡ C \\pmod m$ 对所有 $1 ≤ i ≤ n$ 成立。\r\n4. $\\sum_{i=1}^{n} a_{i,i} ≡\\sum_{i=1}^{n} a_{n−i+1,i} ≡ C \\pmod m$ 成立。\r\n\r\n你能帮老虎解决这个**随堂测验**吗？你只需要输出答案对 $10^9 + 7$ 取模的结果。\n"},{"title":"# 输入格式","format":"markdown","require":["katex"],"content":"\n输入的第一行是一个正整数 $T$，表示数据的组数。\r\n\r\n输入共一行两个正整数 $n, m$，表示矩阵的大小和模数。\n"},{"title":"# 输出格式","format":"markdown","require":["katex"],"content":"\n对于每组数据，输出一行一个数，表示答案。\n"},{"title":"# 样例","format":"markdown","require":["katex"],"content":"\n#### 输入样例1\r\n```plain\r\n4\r\n3 2\r\n20 998244353\r\n12345 233\r\n12345678 23456789\r\n```\r\n#### 输出样例1\r\n```plain\r\n8\r\n990915953\r\n504999036\r\n347121114\r\n```\n"},{"title":"# 数据范围与提示","format":"markdown","require":["katex"],"content":"\n对于 $100%$ 的数据，$1 ≤ T ≤ 100, 3 ≤ n ≤ 10^9, 2 ≤ m ≤ 10^9$。\r\n表中留空代表与以上数据范围相同。\r\n\r\n|子任务编号| 子任务分值| $n ≤$| 特殊性质|\r\n|---|---|---|---|\r\n|1 |10| $5$| $m ≤ 5$|\r\n|2 |20| $20$||\r\n|3 |30| $10^5$| $m = 233$|\r\n|4 |40|||\r\n\r\n命题人：whzzt\n\n\n"}]}