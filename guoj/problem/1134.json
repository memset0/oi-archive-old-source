{"title":"「JSOI2019」神经网络                              ","time_limit":1000,"memory_limit":1024,"url":"https://guoj.icu/problem/1134","statement":[{"title":"题目描述","format":"markdown","require":["katex"],"content":"\n火星探险队发现，火星人的思维方式与人类非常不同，是因为他们拥有与人类很不一样的神经网络结构。为了更好地理解火星人的行为模式，JYY 对小镇上火星人的大脑进行了扫描，得到了一些重要数据。\r\n\r\n火星人在出生后，神经网络可以看作是一个由若干无向树 $\\{T_1(V_1, E_1),T_2(V_2,E_2),\\cdots,T_m(V_m,E_m)\\}$ 构成的森林。随着火星人年龄的增长，神经连接的数量也不断增长。初始时，神经网络中生长的连接 $E^\\star =\\varnothing$。神经网络根据如下规则生长：\r\n\r\n- 如果节点 $u\\in V_i,v\\in V_j$ 分别属于不同的无向树 $T_i$ 和 $T_j(i\\ne j)$，则 $E^\\star$ 中应当包含边 $(u,v)$。\r\n\r\n最终，在不再有神经网络连接可能生长后，神经网络之间的节点连接可以看成是一个**无向图** $G(V,E)$，其中 \r\n$$\r\nV=V_1\\cup V_2\\cup\\cdots\\cup V_m,\\ E=E_1\\cup E_2\\cup\\cdots\\cup E_m\\cup E^\\star\r\n$$\r\n火星人的决策是通过在 $G(V,E)$ 中建立环路完成的。针对不同的外界输入，火星人会建立不同的神经连接环路，从而做出不同的响应。为了了解火星人行为模式的复杂性，JYY 决定计算 $G$ **中哈密顿回路的数量**。\r\n\r\n$G(V,E)$ 的哈密顿回路是一条简单回路，从第一棵树的第一个节点出发，恰好经过 $V$ 中的其他节点一次且仅一次，并且回到第一棵树的第一个节点。\n"},{"title":"输入格式","format":"markdown","require":["katex"],"content":"\n从标准输入中读入数据。\r\n\r\n第一行读入 $m$，表示火星人神经网络初始时无向树的数量。\r\n\r\n接下来输入有 $m$ 部分，第 $i$ 部分描述了树 $T_i$。\r\n\r\n对于 $T_i$，输入的第一行是树 $T_i(V_i,E_i)$ 中节点的数量 $k_i$。假设 $V_i=\\{v_1,v_2,\\cdots,v_{k_i}\\}$。\r\n\r\n接下来 $k_i−1$ 行，每行两个整数 $x,y$，表示该树节点 $v_x,v_y(1\\le x,y\\le k_i)$ 之间有一条树边，即 $(v_x,v_y)\\in E_i$。\n"},{"title":"输出格式","format":"markdown","require":["katex"],"content":"\n输出到标准输出中。\r\n\r\n因为哈密顿回路的数量可能很多，你只需要输出一个非负整数，表示答案对 $998244353$ 取模后的值。\n"},{"title":"样例","format":"markdown","require":["katex"],"content":"\n#### 样例 1 输入\r\n```plain\r\n2 3\r\n1 2\r\n1 3\r\n2\r\n1 2\r\n```\r\n#### 样例 1 输出\r\n```plain\r\n12\r\n```\r\n#### 样例 1 解释\r\n在这个样例中，$G$ 中一共有 $5$ 个点，只有第一棵树的 $2,3$ 节点之间没有边，其他任意两个点之间都存在边。这样的图哈密顿回路个数为 $12$。\r\n\r\n#### 样例 2\r\n见附加文件。\n"},{"title":"数据范围与提示","format":"markdown","require":["katex"],"content":"\n|测试点|$\\sum_{i=1}^mk_i$|$m$|$k_i$|树形态限制|\r\n|:-:|:-:|:-:|:-:|:-:|\r\n|$1$|$\\le 10$|$\\le 3$|无限制|无限制|\r\n|$2$|$\\le 15$|$\\le 4$|无限制|无限制|\r\n|$3$|$\\le 600$|$\\le 300$|$\\le 2$|无限制|\r\n|$4,5,6$|$\\le 900$|$\\le 300$|$\\le 3$|无限制|\r\n|$7,8,9,10$|$2,500$|$50$<!--qaq-->|$50$|无限制|\r\n|$11,12,13,14$|$\\le 5,000$|$\\le 300$|无限制|每棵树都是链|\r\n|$15,16,17,18,19,20$|$\\le 5,000$|$\\le 300$|无限制|无限制|\n\n\n"}]}