{"title":"「余姚中学 2019 联测 Day 2」Under Pressure                              ","time_limit":3000,"memory_limit":1024,"url":"https://guoj.icu/problem/1081","statement":[{"title":"# 题目描述","format":"markdown","require":["katex"],"content":"\n> \"Um ba ba be\r\n>\r\n> Um ba ba be\r\n>\r\n> De day da\r\n>\r\n> Ee day da, that's okay\r\n>\r\n> It's the terror of knowing\r\n>\r\n> What the world is about\r\n>\r\n> Watching some good friends\r\n>\r\n> Screaming 'Let me out'\r\n>\r\n> Pray tomorrow gets me higher\"\r\n\r\n\"Under Pressure\"是一首节奏欢快的歌。\r\n\r\n作为贝斯手，John 在弹奏的时候有着自己的独特技巧，同时，人们都不知道的是，John 的贝斯不同于一般人的贝斯。\r\n\r\nJohn 的贝斯非比寻常，上面有 $n$ 个按键，第 $i$ 个按键有一个力度上限 $A_i$，即John能按在这个键上的力度范围为 $[0,A_i]$，当按键的力度为 $x_i$ 时，会产生 $B_ix_i+C_i$ 的美妙值。\r\n\r\nJohn 在弹奏的时候，会以一定的力度按下每个按键，记在第 $i​ $个按键按下的力度为 $x_i​$，那么记 $T​$ 等于所有美妙值在 $k​$ 进制下做逐位取 $\\max​$ 得到的值，John 会得到 $F(T)​$ 作为本次弹奏的愉悦值。\r\n\r\n其中 $F(T)$ 是一个关于 $k$ 进制数 $T$ 的函数，定义如下：\r\n\r\n- 有 $k$ 个参数 $f(0..k-1)$，其中保证 $f(0)=0$\r\n- 记 $T=\\sum_i t_i\\times k^i$，其中 $0\\le t_i<k$\r\n- $F(T)=\\sum_i f(t_i)$\r\n\r\n对两个 $k​$ 进制数逐位取 $\\max​$ 得到的值定义如下：\r\n\r\n- 有两个 $k​$ 进制数 $U=\\sum_i u_i\\times k ^i,V=\\sum_i v_i\\times k^i​$，其中 $0\\le u_i,v_i<k​$\r\n- 对 $U,V$ 进行 $k$ 进制 $\\max$ 得到：$S=\\sum_i (\\max(u_i,v_i))\\times k^i$\r\n- 此运算显然满足结合律。\r\n\r\n一天 John 在家里胡乱弹奏，他突发奇想：如果他将所有按键的方式（共 $\\prod_{i=1}^n (A_i+1)$ 种）都尝试了，他得到的所有愉悦值的和是多少呢？\r\n\r\n请你帮 John 求出答案，由于答案可能很大，请将答案对 $998244353$ 取模后输出。\n"},{"title":"# 输入格式","format":"markdown","require":["katex"],"content":"\n从标准输入读入。\r\n\r\n第一行两个整数 $n$ 和 $k$。\r\n\r\n第二行 $k$ 个整数，表示 $f(0..k-1)$\r\n\r\n接下来 $n$ 行，每行是三个整数 $A,B,C​$，描述一个按键。\n"},{"title":"# 输出格式","format":"markdown","require":["katex"],"content":"\n输出到标准输出。\r\n\r\n一行一个整数，表示答案对 $998244353$ 取模的结果。\n"},{"title":"# 样例","format":"markdown","require":["katex"],"content":"\n#### 样例输入1\r\n\r\n```plain\r\n5 5\r\n0 1 1 1 1\r\n6 1 2\r\n5 3 2\r\n4 9 9\r\n1 3 4\r\n5 7 3\r\n```\r\n\r\n#### 样例输出1\r\n\r\n```plain\r\n6885\r\n```\r\n\r\n#### 样例输入2\r\n\r\n```plain\r\n5 5\r\n0 394347332 534387138 126207763 295315762\r\n157 444284501 114863663\r\n99 388981206 286410605\r\n614 161427159 156989404\r\n694 297937698 73297712\r\n711 110500264 749342295\r\n```\r\n\r\n#### 样例输出2\r\n\r\n```plain\r\n552249614\r\n```\n"},{"title":"# 数据范围与提示","format":"markdown","require":["katex"],"content":"\n本题采用捆绑测试。\r\n\r\n对于所有数据，$0\\le A_i,B_i,C_i\\le 10^9,1\\le n\\le 100,1\\le k\\le 1000,0\\le f(i)<10^9+7​$，保证$f(0)=0​$\r\n\r\n子任务如下：\r\n\r\n- Subtask1（10分）$A_i\\le 1000​$\r\n- Subtask2（20分）$k=2​$\r\n- Subtask3（10分）$k\\le 300,B_i,C_i< k$\r\n- Subtask4（30分）$1\\le n\\le 100,1\\le k\\le 80$\r\n- Subtask5（10分）$1\\le n\\le 100,1\\le k\\le 300$\r\n- Subtask6（20分）无特殊限制。\r\n\r\n命题人：samjia2000\n\n\n"}]}