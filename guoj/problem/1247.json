{"title":"「NOI2006」网络收费                              ","time_limit":3000,"memory_limit":128,"url":"https://guoj.icu/problem/1247","statement":[{"title":"# 题目描述","format":"markdown","require":["katex"],"content":"\n网络已经成为当今世界不可或缺的一部分。每天都有数以亿计的人使用网络进行学习、科研、娱乐等活动。然而，不可忽视的一点就是网络本身有着庞大的运行费用。所以，向使用网络的人进行适当的收费是必须的，也是合理的。\r\n\r\nMY 市 NS 中学就有着这样一个教育网络。网络中的用户一共有 $2^N$ 个，编号依次为 $1, 2, 3, \\ldots, 2^N$。这些用户之间是用路由点和网线组成的。用户、路由点与网线共同构成一个满二叉树结构。树中的每一个叶子结点都是一个用户，每一个非叶子结点（灰色）都是一个路由点，而每一条边都是一条网线（见下图，用户结点中的数字为其编号）。\r\n\r\n![](/source/guoj/1247/img/aHR0cHM6Ly93d3cud2p5eXkudG9wL3dwLWNvbnRlbnQvdXBsb2Fkcy8yMDE5LzA2LzIwMTkwNjIzMTc1Mi5wbmc=.png)\r\n\r\nMY 网络公司的网络收费方式比较奇特，称为“ 配对收费 ”。即对于每两个用户 $i,j(1≤\\leqslant i<j\\leqslant 2^N)$ 进行收费。由于用户可以自行选择两种付费方式 A、B 中的一种，所以网络公司向学校收取的费用与每一位用户的付费方式有关。该费用等于每两位不同用户配对产生费用之和。\r\n\r\n为了描述方便，首先定义这棵网络树上的一些概念：\r\n\r\n**祖先：**根结点没有祖先， 非根结点的祖先包括它的父亲以及它的父亲的祖先；  \r\n**管辖叶结点：**叶结点本身不管辖任何叶结点，非叶结点管辖它的左儿子所管辖的叶结点与它的右儿子所管辖的叶结点；  \r\n**距离：**在树上连接两个点之间的用边最少的路径所含的边数。\r\n\r\n对于任两个用户 $i,j(1≤\\leqslant i<j\\leqslant 2^N)$，首先在树上找到与它们距离最近的公共祖先：路由点 $P$，然后观察 $P$ 所管辖的叶结点（即用户）中选择付费方式 A 与 B 的人数，分别记为 $nA$ 与 $nB$，接着按照网络管理条例第 X 章第 Y 条第 Z 款进行收费（如下表），其中 $F_{i,j}$ 为 $i$ 和 $j$ 之间的流量，且为已知量。\r\n\r\n|$i$ 付费方式|$j$ 付费方式|$nA$ 与 $nB$ 大小关系|付费系数 $k$|实际付费|\r\n|:-:|:-:|:-:|:-:|:-:|\r\n|A|A|$nA<nB$|$2$|$k\\times F_{i,j}$|\r\n|A|B|$nA<nB$|$1$|$k\\times F_{i,j}$|\r\n|B|A|$nA<nB$|$1$|$k\\times F_{i,j}$|\r\n|B|B|$nA<nB$|$0$|$k\\times F_{i,j}$|\r\n|A|A|$nA\\geqslant nB$|$0$|$k\\times F_{i,j}$|\r\n|A|B|$nA\\geqslant nB$|$1$|$k\\times F_{i,j}$|\r\n|B|A|$nA\\geqslant nB$|$1$|$k\\times F_{i,j}$|\r\n|B|B|$nA\\geqslant nB$|$2$|$k\\times F_{i,j}$|\r\n\r\n由于最终所付费用与付费方式有关，所以 NS 中学的用户希望能够自行改变自己的付费方式以减少总付费。然而，由于网络公司已经将每个用户注册时所选择的付费方式记录在案，所以对于用户 $i$，如果他/她想改变付费方式（由 A 改为 B 或由 B 改为 A），就必须支付 $C_i$ 元给网络公司以修改档案（修改付费方式记录）。\r\n\r\n现在的问题是，给定每个用户注册时所选择的付费方式以及 $C_i$，试求这些用户应该如何选择自己的付费方式以使得 NS 中学支付给网络公司的总费用最少（更改付费方式费用 $+$ 配对收费的费用）。\n"},{"title":"# 输入格式","format":"markdown","require":["katex"],"content":"\n输入文件中第一行有一个正整数 $N$。\r\n\r\n第二行有 $2^N$ 个整数，依次表示 $1$ 号，$2$ 号，$\\ldots$，$2^N$ 号用户注册时的付费方式，每一个数字若为 $0$，则表示对应用户的初始付费方式为 A，否则该数字为 $1$，表示付费方式为 B。\r\n\r\n第三行有 $2^N$ 个整数，表示每一个用户修改付费方式需要支付的费用，依次为 $C_1,C_2,\\ldots,C_M$。$(M=2^N)$\r\n\r\n以下 $2^N-1$ 行描述给定的两两用户之间的流量表 $F$，总第 $(i+3)$ 行第 $j$ 列的整数为 $F_{i,j}+i$。$(1\\leqslant i<2^N$，$1\\leqslant j\\leqslant 2^N – i)$ 所有变量的含义可以参见题目描述。\n"},{"title":"# 输出格式","format":"markdown","require":["katex"],"content":"\n你的程序只需要向输出文件输出一个整数，表示 NS 中学支付给网络公司的最小总费用。（单位：元）\n"},{"title":"# 样例","format":"markdown","require":["katex"],"content":"\n#### 样例输入\r\n```plain\r\n2\r\n1 0 1 0\r\n2 2 10 9\r\n10 1 2\r\n2 1\r\n3\r\n```\r\n#### 样例输出\r\n```plain\r\n8\r\n```\r\n#### 样例说明\r\n将 $1$ 号用户的付费方式由 B 改为 A， NS 中学支付给网络公司的费用达到最小。\n"},{"title":"# 数据范围与提示","format":"markdown","require":["katex"],"content":"\n#### 评分方法\r\n\r\n本题没有部分分，你的程序的输出只有和我们的答案完全一致才能获得满分，否则不得分。\r\n\r\n#### 数据规模和约定\r\n$40\\%$ 的数据中 $N\\leqslant 4$；\r\n\r\n$80\\%$ 的数据中 $N\\leqslant 7$；\r\n\r\n$100\\%$ 的数据中 $N\\leqslant 10$，$0\\leqslant F_{i,j}\\leqslant 500$，$0\\leqslant C_i\\leqslant 500000$。\n\n\n"}]}