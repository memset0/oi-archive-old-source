{"title":"「BJOI2019」奥术神杖                              ","time_limit":1000,"memory_limit":512,"url":"https://guoj.icu/problem/1211","statement":[{"title":"# 题目描述","format":"markdown","require":["katex"],"content":"\nBezorath 大陆抵抗地灾军团入侵的战争进入了僵持的阶段，世世代代生活在 Bezorath 这片大陆的精灵们开始寻找远古时代诸神遗留的神器，试图借助神器的神秘力量帮助她们战胜地灾军团。\r\n\r\n在付出了惨痛的代价后，精灵们从步步凶险的远古战场取回了一件保存尚完好的神杖。但在经历过那场所有史书都视为禁忌的“诸神黄昏之战”后，神杖上镶嵌的奥术宝石已经残缺，神力也几乎消耗殆尽。精灵高层在至高会议中决定以举国之力收集残存至今的奥术宝石，并重金悬赏天下能工巧匠修复这件神杖。\r\n\r\n你作为神术一脉第五百零一位传人，接受了这个艰巨而神圣的使命。 神杖上从左到右镶嵌了 $n$ 颗奥术宝石，奥术宝石一共有 $10$ 种，用数字 `0123456789` 表示。有些位置的宝石已经残缺，用 `.` 表示，你需要用完好的奥术宝石填补每一处残缺的部分（每种奥术宝石个数不限，且不能够更换未残缺的宝石）。古老的魔法书上记载了 $m$ 种咒语 $(S_i,V_i)$，其中 $S_i$ 是一个非空数字串，$V_i$ 是这种组合能够激发的神力。\r\n\r\n神杖的初始神力值 $\\mathrm{Magic} = 1$，每当神杖中出现了连续一段宝石与 $S_i$ 相等时，神力值 $\\mathrm{Magic}$ 就会乘以 $V_i$。但神杖如果包含了太多咒语就不再纯净导致神力降低：设 $c$ 为神杖包含的咒语个数（若咒语类别相同但出现位置不同视为多次），神杖最终的神力值为 $\\sqrt[c]{\\mathrm{Magic}}$。（若 $c = 0$ 则神杖最终神力值为 $1$。）\r\n\r\n例如有两种咒语 $(01,3)$ 、$(10,4)$，那么神杖 `0101` 的神力值为 $\\sqrt[3]{ 3 \\times 4 \\times 3}$。\r\n\r\n你需要使修复好的神杖的最终的神力值最大，输出任何一个解即可。\r\n\n"},{"title":"# 输入格式","format":"markdown","require":["katex"],"content":"\n第一行两个正整数 $n,m$，表示宝石数和咒语数。\r\n\r\n第二行为一个长度为 $n$ 的字符串 $T$，表示初始的神杖。\r\n\r\n接下来 $m$ 行每行一个非空数字串 $S_i$ 和一个正整数 $V_i$，表示每种咒语。\r\n\n"},{"title":"# 输出格式","format":"markdown","require":["katex"],"content":"\n输出最终神杖上从左到右镶嵌的宝石，多解时任意输出一个即可。\r\n\n"},{"title":"# 样例","format":"markdown","require":["katex"],"content":"\n#### 样例输入 1\r\n\r\n```plain\r\n4 3\r\n....\r\n1 2\r\n2 2\r\n3 1\r\n```\r\n\r\n#### 样例输出 1\r\n\r\n```plain\r\n2019\r\n```\r\n\r\n#### 样例解释 1\r\n\r\n法杖最终神力值为 $2$。\r\n\r\n#### 样例输入 2\r\n\r\n```plain\r\n5 4\r\n..0..\r\n0 2\r\n00 2\r\n01 4\r\n10 3\r\n```\r\n\r\n#### 样例输出 2\r\n\r\n```plain\r\n11012\r\n```\r\n\r\n#### 样例解释 2\r\n\r\n法杖最终神力值为 $\\sqrt[3]{2 \\times 3 \\times 4}$。\r\n\r\n#### 样例输入 3\r\n\r\n```plain\r\n18 6\r\n...2.1.0.1..1.0..1\r\n011 6\r\n111 4\r\n010 12\r\n121 7\r\n101 5\r\n10 3\r\n```\r\n\r\n#### 样例输出 3\r\n\r\n```plain\r\n121211203112120121\r\n```\r\n\n"},{"title":"# 数据范围与提示","format":"markdown","require":["katex"],"content":"\n设 $s = \\sum_{i=1}^{m} |S_i|$，即所有咒语的串长之和。\r\n\r\n| 测试点 | $n\\le$ | $s\\le$ | 特殊性质 |\r\n|:-:|:-:|:-:|:-:|\r\n| $1\\sim 3$ | $6$ | $20$ ||\r\n| $4\\sim 5$ | $501$ | $5$ ||\r\n| $6$ | $501$ | $501$ | 所有 $V_i$ 相同 |\r\n| $7$ | $501$ | $501$ | $V_i$ 最多只有 $2$ 种不同的取值 |\r\n| $8$ | $501$ | $501$ | $V_i$ 最多只有 $3$ 种不同的取值 |\r\n| $9\\sim 11$ | $501$ | $501$ | $T$ 中全部由 `.` 组成 |\r\n| $12\\sim 13$ | $501$ | $501$ | $T$ 最多只有 $3$ 个位置是 `.` |\r\n| $14\\sim 16$ | $501$ | $501$ | |\r\n| $17\\sim 20$ | $1501$ | $1501$ | |\r\n\r\n对于 $100\\%$ 的数据，满足 $1\\le n, m, s \\le 1501, 1\\le V_i\\le 10^9$。\n\n\n"}]}