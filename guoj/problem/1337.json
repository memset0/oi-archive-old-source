{"title":"「CSP-S 2019」 D. Emiya 家今天的饭                              ","time_limit":1000,"memory_limit":256,"url":"https://guoj.icu/problem/1337","statement":[{"title":"题目描述","format":"markdown","require":["katex"],"content":"\nEmiya 是个擅长做菜的高中生，他共掌握 $n$ 种**烹饪方法**，且会使用 $m$ 种**主要食材**做菜。为了方便叙述，我们对烹饪方法从 $1 \\sim n$ 编号，对主要食材从 $1 \\sim m$ 编号。\r\n\r\nEmiya 做的每道菜都将使用**恰好一种**烹饪方法与**恰好一种**主要食材。更具体地，Emiya 会做 $a_{i,j}$ 道不同的使用烹饪方法 $i$ 和主要食材 $j$ 的菜（$1 \\leq i \\leq n, 1 \\leq j \\leq m$），这也意味着 Emiya 总共会做 $\\sum\\limits_{i=1}^{n} \\sum\\limits_{j=1}^{m} a_{i,j}$ 道不同的菜。\r\n\r\nEmiya 今天要准备一桌饭招待 Yazid 和 Rin 这对好朋友，然而三个人对菜的搭配有不同的要求，更具体地，对于一种包含 $k$ 道菜的搭配方案而言：\r\n- Emiya 不会让大家饿肚子，所以将做**至少一道菜**，即 $k \\geq 1$\r\n- Rin 希望品尝不同烹饪方法做出的菜，因此她要求每道菜的**烹饪方法互不相同**\r\n- Yazid 不希望品尝太多同一食材做出的菜，因此他要求每种**主要食材**至多在**一半**的菜（即 $\\lfloor \\frac{k}{2} \\rfloor$ 道菜）中被使用\r\n\r\n这里的 $\\lfloor x \\rfloor$ 为下取整函数，表示不超过 $x$ 的最大整数。\r\n\r\n这些要求难不倒 Emiya，但他想知道共有多少种不同的符合要求的搭配方案。两种方案不同，当且仅当存在至少一道菜在一种方案中出现，而不在另一种方案中出现。\r\n\r\nEmiya 找到了你，请你帮他计算，你只需要告诉他符合所有要求的搭配方案数对质数 $998,244,353$ 取模的结果。\n"},{"title":"输入格式","format":"markdown","require":["katex"],"content":"\n第 1 行两个用单个空格隔开的整数 $n,m$。\r\n\r\n第 2 行至第 $n + 1$ 行，每行 $m$ 个用单个空格隔开的整数，其中第 $i + 1$ 行的 $m$ 个数依次为 $a_{i,1}, a_{i,2}, \\cdots, a_{i,m}$。\n"},{"title":"输出格式","format":"markdown","require":["katex"],"content":"\n仅一行一个整数，表示所求方案数对 $998,244,353$ 取模的结果\n"},{"title":"样例","format":"markdown","require":["katex"],"content":"\n\r\n#### 样例输入 1\r\n```plain\r\n2 3 \r\n1 0 1\r\n0 1 1\r\n```\r\n#### 样例输出 1\r\n```plain\r\n3\r\n```\r\n#### 样例解释 1\r\n\r\n由于在这个样例中，对于每组 $i, j$，Emiya 都最多只会做一道菜，因此我们直接通过给出烹饪方法、主要食材的编号来描述一道菜。\r\n\r\n符合要求的方案包括：\r\n- 做一道用烹饪方法 1、主要食材 1 的菜和一道用烹饪方法 2、主要食材 2 的菜\r\n- 做一道用烹饪方法 1、主要食材 1 的菜和一道用烹饪方法 2、主要食材 3 的菜\r\n- 做一道用烹饪方法 1、主要食材 3 的菜和一道用烹饪方法 2、主要食材 2 的菜\r\n\r\n因此输出结果为 $3 \\mod 998,244,353 = 3$。 需要注意的是，所有只包含一道菜的方案都是不符合要求的，因为唯一的主要食材在超过一半的菜中出现，这不满足 Yazid 的要求。\r\n#### 样例输入 2\r\n```plain\r\n3 3\r\n1 2 3\r\n4 5 0\r\n6 0 0\r\n```\r\n#### 样例输出 2\r\n```plain\r\n190\r\n```\r\n#### 样例解释 2\r\n\r\nEmiya 必须至少做 2 道菜。\r\n\r\n做 2 道菜的符合要求的方案数为 100。\r\n\r\n做 3 道菜的符合要求的方案数为 90。\r\n\r\n因此符合要求的方案数为 100 + 90 = 190。\r\n#### 样例输入 3\r\n```plain\r\n5 5\r\n1 0 0 1 1\r\n0 1 0 1 0\r\n1 1 1 1 0\r\n1 0 1 0 1\r\n0 1 1 0 1\r\n```\r\n#### 样例输出 3\r\n```plain\r\n742\r\n```\r\n\r\n\n"},{"title":"数据范围与提示","format":"markdown","require":["katex"],"content":"\n| 测试点编号 | $n=$ | $m=$ | $a_{i,j}<$ | 测试点编号 | $n=$  |  $m=$  |  $a_{i,j}<$   |\r\n| :--------: | :--: | :--: | :--------: | :--------: | :---: | :----: | :-----------: |\r\n|    $1$     | $2$  | $2$  |    $2$     |    $7$     | $10$  |  $2$   |    $1000$     |\r\n|    $2$     | $2$  | $3$  |    $2$     |    $8$     | $10$  |  $3$   |    $1000$     |\r\n|    $3$     | $5$  | $2$  |    $2$     | $9\\sim12$  | $40$  |  $2$   |    $1000$     |\r\n|    $4$     | $5$  | $3$  |    $2$     | $13\\sim16$ | $40$  |  $3$   |    $1000$     |\r\n|    $5$     | $10$ | $2$  |    $2$     | $17\\sim21$ | $40$  | $500$  |    $1000$     |\r\n|    $6$     | $10$ | $3$  |    $2$     | $22\\sim25$ | $100$ | $2000$ | $998,244,353$ |\r\n\r\n对于所有测试点，保证 $1 \\leq n \\leq 100$，$1 \\leq m \\leq 2000$，$0 \\leq a_{i,j} \\lt 998,244,353$。\n\n\n"}]}