{"title":"「HNOI 2019」JOJO                              ","time_limit":1000,"memory_limit":512,"url":"https://guoj.icu/problem/1071","statement":[{"title":"题目描述","format":"markdown","require":["katex"],"content":"\nJOJO 的奇幻冒险是一部非常火的漫画。漫画中的男主角经常喜欢连续喊很多的「欧拉」或者「木大」。\r\n\r\n为了防止字太多挡住漫画内容，现在打算在新的漫画中用 $x$ 欧拉或者 $x$ 木大表示有 $x$ 个欧拉或者木大。\r\n\r\n为了简化内容我们现在用字母表示喊出的话。\r\n\r\n我们用数字和字母来表示一个串，例如：`2 a 3 b` 表示的串就是 `aabbb`。\r\n\r\n一开始漫画中什么话都没有，接下来你需要依次实现 $n$ 个操作，总共只有 $2$ 种操作：\r\n- 第一种：`1 x c`：在当前漫画中加入 $x$ 个 $c$，表示在当前串末尾加入 $x$ 个 $c$ 字符。保证当前串是空串或者串尾字符不是 $c$；\r\n- 第二种：`2 x`：觉得漫画没画好，将漫画还原到第 $x$ 次操作以后的样子，表示将串复原到第 $x$ 次操作后的样子，如果 $x=0$ 则是将串变成空串。如果当前串是 `bbaabbb`，第 $4$ 次操作后串是 `bb`，则 `2 4` 会使 `bbaabbb` 变成 `bb`，保证 $x$ 小于当前操作数。\r\n\r\n众所周知空条承太郎十分聪明，现在迪奥已经被打败了，他开始考虑自己的漫画中的一些问题：\r\n\r\n对于一个串的每个前缀 $A$，都有一个最长的比它短的前缀 $B$ 与前缀 $A$ 的一个后缀匹配，设这个最长的前缀 $B$ 的长度为 $L$。$L$ 为 $0$ 时意味着  $B$ 是一个空串。\r\n\r\n每一次操作后，你都需要将当前的串的所有前缀的 $L$ 求和并对 $998244353$ 取模输出告诉空条承太郎，好和他的白金之星算出的答案对比。比如 `bbaaabba` 的 $L$ 分别是 $0, 1, 0, 0, 0, 1, 2, 3$，所以对于这个串的答案就是 $7$。\n"},{"title":"输入格式","format":"markdown","require":["katex"],"content":"\n第一行包括一个正整数 $n$，表示操作数量。\r\n\r\n接下来 $n$ 行每行包含一个操作，操作格式如题目描述所示，例如：\r\n- `1 x c`\r\n- `2 x`\r\n\r\n保证数据合法。\n"},{"title":"输出格式","format":"markdown","require":["katex"],"content":"\n仅包含 $n$ 行，第 $i$ 行一个整数，表示 $i$ 个操作之后串的答案。\n"},{"title":"样例","format":"markdown","require":["katex"],"content":"\n#### 样例输入\r\n```plain\r\n11\r\n1 2 a\r\n1 3 b\r\n1 2 a\r\n1 1 b\r\n2 2\r\n1 3 a\r\n1 2 b\r\n2 6\r\n2 5\r\n1 7 a\r\n1 5 c\r\n```\r\n#### 样例输出\r\n```plain\r\n1\r\n1\r\n4\r\n7\r\n1\r\n6\r\n13\r\n6\r\n1\r\n14\r\n14\r\n```\r\n#### 样例说明\r\n| 操作 |      此时的串       |             答案（取模后）             |\r\n| :--: | :-----------------: | :------------------------------------: |\r\n| $1$  |        `aa`         |                $0+1=1$                 |\r\n| $2$  |       `aabbb`       |             $0+1+0+0+0=1$              |\r\n| $3$  |      `aabbbaa`      |           $0+1+0+0+0+1+2=4$            |\r\n| $4$  |     `aabbbaab`      |          $0+1+0+0+0+1+2+3=7$           |\r\n| $5$  |       `aabbb`       |             $0+1+0+0+0=1$              |\r\n| $6$  |     `aabbbaaa`      |          $0+1+0+0+0+1+2+2=6$           |\r\n| $7$  |    `aabbbaaabb`     |        $0+1+0+0+0+1+2+2+3+4=13$        |\r\n| $8$  |     `aabbbaaa`      |          $0+1+0+0+0+1+2+2=6$           |\r\n| $9$  |       `aabbb`       |             $0+1+0+0+0=1$              |\r\n| $10$ |   `aabbbaaaaaaa`    |      $0+1+0+0+0+1+2+2+2+2+2+2=14$      |\r\n| $11$ | `aabbbaaaaaaaccccc` | $0+1+0+0+0+1+2+2+2+2+2+2+0+0+0+0+0=14$ |\r\n\r\n\n"},{"title":"数据范围与提示","format":"markdown","require":["katex"],"content":"\n$20\\%$ 的数据满足 $n\\le 300$，对于每个 $1$ 操作中的 $x\\le 300$；\r\n\r\n另有 $30\\%$ 的数据满足 $n\\le 10^5$，且对于每个 $1$ 操作中的 $x=1$；\r\n\r\n另有 $30\\%$ 的数据满足 $n\\le 10^5$，且不含 $2$ 操作；\r\n\r\n$100\\%$ 的数据满足 $n\\le 10^5$，且每个 $1$ 操作中的 $x\\le 10^4$。\n\n\n"}]}