{"title":"「NOI2002」机器人 M 号                              ","time_limit":2000,"memory_limit":256,"url":"https://guoj.icu/problem/1228","statement":[{"title":"# 题目描述","format":"markdown","require":["katex"],"content":"\n3030 年，Macsy 正在火星部署一批机器人。\r\n\r\n第 $1$ 秒，他把机器人 $1$ 号运到了火星，机器人 $1$ 号可以制造其他的机器人。\r\n\r\n第 $2$ 秒，机器人 $1$ 号造出了第一个机器人——机器人 $2$ 号。\r\n\r\n第 $3$ 秒，机器人 $1$ 号造出了另一个机器人——机器人 $3$ 号。\r\n\r\n之后每一秒，机器人 $1$ 号都可以造出一个新的机器人。第 $m$ 秒造出的机器人编号为 $m$。我们可以称它为机器人 $m$ 号，或者 $m$ 号机器人。\r\n\r\n机器人造出来后，马上开始工作。$m$ 号机器人，每 $m$ 秒会休息一次。比如 $3$ 号机器人，会在第 $6$，$9$，$12$，$\\ldots$ 秒休息，而其它时间都在工作。\r\n\r\n机器人休息时，它的记忆将会被移植到当时出生的机器人的脑中。比如 $6$ 号机器人出生时，$2$，$3$ 号机器人正在休息，因此，$6$ 号机器人会收到第 $2$，$3$ 号机器人的记忆副本。我们称第 $2$，$3$ 号机器人是 $6$ 号机器人的老师。\r\n\r\n如果两个机器人没有师徒关系，且没有共同的老师，则称这两个机器人的知识是互相独立的。<u><i>注意：$1$ 号机器人与其他所有机器人的知识独立（因为只有 $1$ 号才会造机器人），它也不是任何机器人的老师。</i></u>\r\n\r\n一个机器人的<u><i>独立数</i></u>，是指所有编号比它小且与它知识互相独立的机器人的个数。比如 $1$ 号机器人的<u><i>独立数</i></u>为 $0$，$2$ 号机器人的<u><i>独立数</i></u>为 $1$（$1$ 号机器人与它知识互相独立），$6$ 号机器人的<u><i>独立数</i></u>为 $2$（$1$，$5$ 号机器人与它知识互相独立，$2$，$3$ 号机器人都是它的老师，而 $4$ 号机器人与它有共同的老师——$2$ 号机器人）。\r\n\r\n新造出来的机器人有 $3$ 种不同的职业。对于编号为 $m$ 的机器人，如果能把 $m$ 分解成偶数个不同奇素数的积，则它是政客，例如编号 $15$；否则，如果 $m$ 本身就是奇素数或者能把 $m$ 分解成奇数个不同奇素数的积，则它是军人，例如编号 $3$，编号 $165$。其它编号的机器人都是学者，例如编号 $2$, 编号 $6$, 编号 $9$。\r\n\r\n第 $m$ 秒诞生的机器人 $m$ 号，想知道它和它的老师中，所有政客的<u><i>独立数</i></u>之和，所有军人的<u><i>独立数</i></u>之和，以及所有学者的<u><i>独立数</i></u>之和。可机器人 $m$ 号忙于工作没时间计算，你能够帮助它吗？\r\n\r\n为了方便你的计算，Macsy 已经帮你做了 $m$ 的素因子分解。为了输出方便，只要求输出总和除以 $10000$ 的余数。\n"},{"title":"# 输入格式","format":"markdown","require":["katex"],"content":"\n输入的第一行是一个正整数 $k$，$k$ 是 $m$ 的不同的素因子个数。\r\n\r\n以下 $k$ 行，每行两个整数，$p_i$, $e_i$,表示 $m$ 的第 $i$ 个素因子和它的指数 $(i=1,2,\\ldots,k)$。$p_1,p_2,\\ldots,p_k$ 是不同的素数，$\\displaystyle\\prod_{i=1}^kp_i^{e_i}$。所有素因子按照从小到大排列，即 $p_1<p_2<\\ldots<p_k$。\n"},{"title":"# 输出格式","format":"markdown","require":["katex"],"content":"\n输出包括三行。\r\n\r\n第一行是机器人 $m$ 号和它的老师中，所有政客的独立数之和除以 $10000$ 的余数。\r\n第二行是机器人 $m$ 号和它的老师中，所有军人的独立数之和除以 $10000$ 的余数。\r\n第三行是机器人 $m$ 号和它的老师中，所有学者的独立数之和除以 $10000$ 的余数。\n"},{"title":"# 样例","format":"markdown","require":["katex"],"content":"\n#### 样例输入\r\n```plain\r\n3\r\n2 1\r\n3 2\r\n5 1\r\n```\r\n#### 样例输出\r\n```plain\r\n8\r\n6\r\n75\r\n```\r\n#### 样例解释\r\n$m = 2\\times 3^2\\times 5=90$。$90$ 号机器人有 $10$ 个老师，加上它自己共 $11$ 个。其中政客只有 $15$ 号；军人有 $3$ 号和 $5$ 号；学者有 $8$ 个，它们的编号分别是：$2,6,9,10,18,30,45,90$。\n"},{"title":"# 数据范围与提示","format":"markdown","require":["katex"],"content":"\n对于全部的数据，$1\\le k\\le 1000$，$2\\le p_i<10,000$，$1\\le e_i\\le 1,000,000$。\r\n\r\n#### 评分标准\r\n输出文件包含三个数。如果你的程序算对了三个数，该测试点得 $10$ 分；如果你的程序算对了两个数，该测试点得 $7$ 分；如果你的程序算对了一个数，该测试点得 $4$ 分；如果你的程序一个数也没算对，该测试点得 $0$ 分。\n\n\n"}]}