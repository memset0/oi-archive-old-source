{"title":"「MtOI2019」幻想乡数学竞赛                              ","time_limit":1200,"memory_limit":16,"url":"https://guoj.icu/problem/1324","statement":[{"title":"# 题目描述","format":"markdown","require":["katex"],"content":"\n注：本题MtOI2019赛时时限$800ms$，Luogu时限$600ms$，LOJ时限$700ms$。\r\n\r\n一年一度的幻想乡数学竞赛(thMO)又要开始了。  \r\n幻想乡中学习数学的少(lao)女(tai)们(po)和冰之妖精baka一起准备着thMO。  \r\n但是在那一刻，幻想乡日复一日的宁静被打破了。  \r\n广播里，播放起了死亡的歌曲！\r\n在那一刻，人们又回想起了被算数支配的恐惧。  \r\n就剩下baka，baka，baka，baka的声音在幻想乡里回荡。  \r\n \r\n---  \r\n\r\n河城 荷取(Kawashiro Nitori)正坐在thMO2019的考场上！  \r\n因为荷取有着她的[超级计算机](https://www.luogu.org/problemnew/show/P4911)，在成功地用光学迷彩覆盖了计算机之后，荷取在thMO2019的考场上所向披靡。  \r\n* 荷取用她的超级计算机$0ms$跑出了这么一道题：  \r\n  $$\\exists \\{ a_n\\} (n=0,1,\\cdots ,10^{18}),\\text{已知}a_0=2,a_1=5,a_{n+2}=3a_{n+1}-2a_n \\text{，求}a_n\\bmod 10^{9}+7$$    \r\n\r\n* 荷取：显然，这个题可以用矩阵乘法+快速幂，可以$O(\\log n)$水过去，差不多就这样：     \r\n$$\\begin{bmatrix} a_n & a_{n+1} \\end{bmatrix}=\\begin{bmatrix} a_1 & a_2 \\end{bmatrix} \\times \\begin{bmatrix} 0 & -2 \\\\ 1 & 3 \\end{bmatrix}^n$$      \r\n\r\n  \r\n但是荷取遇到了一道她不会的题，她正在寻求你的帮助呢！ \r\n\r\n___\r\n\r\n存在一个数列$\\{ a_n\\} (n\\in \\{ 0,1,2,\\cdots ,2^{64}-1\\} )$。  \r\n已知$a_0=-3,a_1=-6,a_2=-12,a_n=3a_{n-1}+a_{n-2}-3a_{n-3}+3^n$。  \r\n* 现在给你一个非负整数$n$，令$p=10^{9}+7$，请你求出$a_n \\bmod p$。 \r\n* **注：若$a_n<0$，请输出$(a_n \\bmod p+p)\\bmod p$。**    \r\n  \r\n  \r\n为了更充分地考验你的水平，荷取设置了$T$组询问。\r\n* 为了在某种程度上减少你的输入和输出量，我们采用以下的代码来生成询问：  \r\n  \r\n```\r\nnamespace Mker\r\n{\r\n//  Powered By Kawashiro_Nitori\r\n//  Made In Gensokyo, Nihon\r\n\t#include<climits>\r\n\t#define ull unsigned long long\r\n\t#define uint unsigned int\r\n\tull sd;int op;\r\n\tinline void init() {scanf(\"%llu %d\", &sd, &op);}\r\n\tinline ull ull_rand()\r\n\t{\r\n\t\tsd ^= sd << 43;\r\n\t\tsd ^= sd >> 29;\r\n\t\tsd ^= sd << 34;\r\n\t\treturn sd;\r\n\t}\r\n\tinline ull rand()\r\n\t{\r\n\t\tif (op == 0) return ull_rand() % USHRT_MAX + 1;\r\n\t\tif (op == 1) return ull_rand() % UINT_MAX + 1; \r\n\t\tif (op == 2) return ull_rand();\r\n\t}\r\n}\r\n```  \r\n在调用`Mker::init()`函数之后，你第$i$次调用`Mker::rand()`函数时返回的便是第$i$次询问的$n_i$。\r\n\r\n在这里给出$op$的限制：\r\n\r\n* 如果$op=0$，满足$n_i \\leq 2^{16}$。\r\n\r\n* 如果$op=1$，满足$n_i \\leq 2^{32}$。\r\n\r\n* 如果$op=2$，满足$n_i \\leq 2^{64}-1$。\r\n\r\n为了减少你的输出量，你只需要输出所有询问答案的**异或和**。\r\n\r\n因为此题出题人丧心病狂把时限调到了卡常后的std的最大时间的$1.1$倍，请注意常数优化（**std默认开启O2优化**，**不含其他编译优化**）。\r\n\r\n\r\n\n"},{"title":"# 输入格式","format":"markdown","require":["katex"],"content":"\n第一行三个整数，输入$T$，$seed$和$op$。\n"},{"title":"# 输出格式","format":"markdown","require":["katex"],"content":"\n第一行一个整数，输出$T$组询问的答案的**异或和**。  \n"},{"title":"# 样例","format":"markdown","require":["katex"],"content":"\n### 样例输入 $1$\r\n\r\n~~~\r\n142857 1145141919 0\r\n~~~\r\n\r\n### 样例输出 $1$\r\n\r\n~~~\r\n562611141\r\n~~~\r\n\r\n### 样例输入 $2$\r\n\r\n~~~\r\n142857 1145141919 1\r\n~~~\r\n\r\n### 样例输出 $2$\r\n\r\n~~~\r\n894946216\r\n~~~\r\n\r\n### 样例输入 $3$\r\n\r\n~~~\r\n142857 1145141919 2\r\n~~~\r\n\r\n### 样例输出 $3$\r\n\r\n~~~\r\n771134436\r\n~~~\n"},{"title":"# 数据范围与提示","format":"markdown","require":["katex"],"content":"\n### 子任务  \r\n\r\n![png](/source/guoj/1324/img/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMDQvMTkvNWNiOWJiMmM2YzFkNi5wbmc=.png)  \r\n\r\n### 题目来源\r\n\r\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T4\r\n\r\n出题人：disangan233\r\n\r\n验题人：suwakow\r\n\r\n蒟蒻出题人$\\color{grey} {\\mathsf{disangan233}}$在与$\\mathsf o \\color{red} {\\mathsf{uuan}}$和$\\mathsf P \\color{red} {\\mathsf{inkRabbit}}$的讨论后决定将这个题作为比赛的卡常题，旨在推广OI的一些常数优化技巧，并防止AK。\r\n\r\n来自$\\mathsf N \\color{red} {\\mathsf{aCly~Fish}}$的评价\r\n\r\n![fish](/source/guoj/1324/img/aHR0cHM6Ly9pLmxvbGkubmV0LzIwMTkvMDgvMTkvMXI4WFNvRHZoUm5iNDkzLnBuZw==.png)\n\n\n"}]}