{"title":"「HNOI 2018 省队集训 Day 4」f                              ","time_limit":8000,"memory_limit":512,"url":"https://guoj.icu/problem/1116","statement":[{"title":"题目描述","format":"markdown","require":["katex"],"content":"\n小 y 是一个讨厌毒瘤题的女孩子。\r\n\r\n小 w 是一个喜欢出毒瘤题的出题人。\r\n\r\n小 w 出了一个毒瘤题，于是小 y 非常生气。小 w 想通过做出这道毒瘤题来让小 y 消气。\r\n\r\n但是，小 w 已经许久没做毒瘤题了，代码能力早已退化。但是，为了哄小 y 开心，他必须做出这道题。所以，他希望你能帮他解决这个毒瘤题。\r\n\r\n下面是这道毒瘤题的题面：\r\n\r\n给你一棵$n$个点的树，每个点有一个点权和所在集合编号。\r\n\r\n有$m$个询问，每个询问有$4$种操作。\r\n\r\n1. 修改一个点的点权。\r\n2. 修改一个点的所在集合，保证修改前后点的集合不一样。\r\n3. 查询一条满足两端点都在集合$y$的最大路径权值，保证集合$y$不为空集。在这里，一条路径的权值定义为这条路径的在$y$集合的点的点权和。\r\n4. 查询一条满足所有点都在集合$y$的最大点权连通块，保证集合$y$不为空集。\r\n\r\n请注意，一个单独的点也算一条路径或一个连通块。\r\n\r\n由于小 w 有时想即时得到消息，所以他可能会让你在线解决这些问题。\n"},{"title":"输入格式","format":"markdown","require":["katex"],"content":"\n第一行五个整数$n, m, k, T, O$，分别表示点数，询问数，集合数，是否强制在线和子任务编号。\r\n\r\n接下来$n$行，每行两个整数$w_i, y_i$，分别表示$i$号点的点权，集合编号。\r\n\r\n接下来$n-1$行，每行两个整数$u, v$，表示$u$到$v$之间有一条边。\r\n\r\n接下来$m$行，每行第一个数为$op$，表示询问编号。且若$T=1$，那么这一行剩下的数全部都要异或上$g$，其中$g = lastans \\bmod 998244353$，初始$lastans = 0$。\r\n\r\n如果$op = 1$，接下来两个整数$x, w$，表示将$x$的点权改为$w$。\r\n\r\n如果$op = 2$，接下来两个整数$x, y$，表示将$x$的集合改为$y$。\r\n\r\n如果$op = 3$，接下来一个整数$y$，表示查询一条满足两端点都在集合$y$的最大路径权值。\r\n\r\n如果$op = 4$，接下来一个整数$y$，表示查询一条满足所有点都在集合$y$的最大点权连通块。\n"},{"title":"输出格式","format":"markdown","require":["katex"],"content":"\n对于所有的$op \\in \\{3, 4\\}$的操作，每行依次输出一个答案。\n"},{"title":"样例","format":"markdown","require":["katex"],"content":"\n**样例 1 输入**\r\n```\r\n5 5 5 0 1\r\n476416874 1\r\n-734291638 2\r\n-209707479 3\r\n248601378 1\r\n473438305 5\r\n2 1\r\n3 1\r\n4 1\r\n5 4\r\n4 1\r\n4 5\r\n1 3 857108629\r\n2 5 4\r\n1 2 716486897\r\n```\r\n\r\n**样例 1 输出**\r\n```\r\n725018252\r\n473438305\r\n```\r\n\r\n本题有附加样例，请自行下载。\n"},{"title":"数据范围与提示","format":"markdown","require":["katex"],"content":"\n**数据范围**\r\n\r\nSubtask #1 (5'): $n, m \\leq 10^4$。\r\n\r\nSubtask #2 (10'): 树是一条链。\r\n\r\nSubtask #3 (20'): $op \\in \\{1, 3\\}$。\r\n\r\nSubtask #4 (15'): $k \\leq 2$。\r\n\r\nSubtask #5 (15'): $T = 0$。\r\n\r\nSubtask #6 (35'): 无特殊性质。\r\n\r\n对于$100\\%$的数据，满足$n, m \\leq 10^5, k \\leq n, T \\in \\{0, 1\\}, O \\in \\{1, 2, 3, 4, 5, 6\\}, |w| \\leq 10^9, y \\leq k$。\r\n\r\n本题将使用捆绑测试。由于评测机实际性能问题，时限由 5s 加到 8s 。\r\n\r\n**提示**\r\n\r\n题目并不难(想)。\r\n\r\n出题人：wfj\r\n\r\n来源：HNOI 2018 省队集训 Day 4 T3\r\n\n\n\n"}]}