{"title":"「余姚中学 2019 联测 Day 5」再放送                              ","time_limit":2000,"memory_limit":1024,"url":"https://guoj.icu/problem/1091","statement":[{"title":"题目描述","format":"markdown","require":["katex"],"content":"\n老虎和蒜头是好朋友。\r\n\r\n老虎设计了一个有 $n$ 间房间的迷宫，每间房间都有一个权值 $v_x$，房间之间用通道连接。老虎很懒，\r\n因此他只设置了 $n − 1$ 条通道：刚好足够迷宫联通。老虎决定研究在这个图上的随机游走游戏。具体来\r\n说，当老虎在房间 $x$ 时，他会等概率选择一个相邻的房间 $y$ 并走过去。然而，迷宫里的每个房间不能访\r\n问超过两次，因此老虎只会考虑相邻的还能访问的房间$ y$。如果不存在这样的房间，老虎就将最终的房间\r\n的权值 $v_y$ 记录下来，并结束游戏。\r\n\r\n老虎想要知道当他初始在房间 $S$ 时，最终记录下的权值的期望。注意此时房间 $S$ 已经被访问了一次。\r\n你只需要输出答案对 $10^9 + 7$ 取模的值即可。\n"},{"title":"输入格式","format":"markdown","require":["katex"],"content":"\n输入的第一行包括一个正整数 $n$，表示迷宫的大小。\r\n\r\n接下来一行包括 $n$ 个数，第 $i$ 个数表示房间 $i$ 的权值。\r\n\r\n接下来 $n − 1$ 行，每行两个数 $x$ 和 $y$，表示迷宫中的一条边。\r\n\r\n最后一行包括一个数 $S$，表示老虎初始的起点。\n"},{"title":"输出格式","format":"markdown","require":["katex"],"content":"\n输出一行一个整数表示答案。\n"},{"title":"样例","format":"markdown","require":["katex"],"content":"\n#### 输入样例1\r\n```plain\r\n2\r\n5 8\r\n1 2\r\n1\r\n```\r\n#### 输出样例1\r\n```plain\r\n8\r\n```\r\n___\r\n#### 输入样例2\r\n```plain\r\n4\r\n1 2 3 4\r\n1 2\r\n2 3\r\n2 4\r\n2\r\n```\r\n#### 输出样例2\r\n```plain\r\n666666674\r\n```\r\n___\r\n#### 输入样例3\r\n```plain\r\n9\r\n11 22 33 44 55 66 77 88 99\r\n1 2\r\n2 3\r\n3 4\r\n3 5\r\n4 6\r\n5 7\r\n2 8\r\n1 9\r\n4\r\n```\r\n#### 输出样例3\r\n```plain\r\n138310264\r\n```\r\n\n"},{"title":"数据范围与提示","format":"markdown","require":["katex"],"content":"\n对于 $100%$ 的数据，$1 ≤ n ≤ 10^6, 1 ≤ vi ≤ 10^9$。表中留空代表与以上数据范围相同。\r\n\r\n|子任务编号 |子任务分值 |$n ≤$|\r\n|---|---|---|\r\n|1 |10<!--qaq-->| 10|\r\n|2| 20 |300|\r\n|3 |30 |3000|\r\n|4 |40||\r\n\r\n命题人：whzzt\n\n\n"}]}