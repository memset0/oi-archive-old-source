
# 题目描述

小 y 是一个讨厌毒瘤题的女孩子。

小 w 是一个喜欢出毒瘤题的出题人。

小 w 出了一个毒瘤题，于是小 y 非常生气。小 w 想通过做出这道毒瘤题来让小 y 消气。

但是，小 w 已经许久没做毒瘤题了，代码能力早已退化。但是，为了哄小 y 开心，他必须做出这道题。所以，他希望你能帮他解决这个毒瘤题。

下面是这道毒瘤题的题面：

给你一棵$n$个点的树，每个点有一个点权和所在集合编号。

有$m$个询问，每个询问有$4$种操作。

1. 修改一个点的点权。
2. 修改一个点的所在集合，保证修改前后点的集合不一样。
3. 查询一条满足两端点都在集合$y$的最大路径权值，保证集合$y$不为空集。在这里，一条路径的权值定义为这条路径的在$y$集合的点的点权和。
4. 查询一条满足所有点都在集合$y$的最大点权连通块，保证集合$y$不为空集。

请注意，一个单独的点也算一条路径或一个连通块。

由于小 w 有时想即时得到消息，所以他可能会让你在线解决这些问题。

# 输入格式

第一行五个整数$n, m, k, T, O$，分别表示点数，询问数，集合数，是否强制在线和子任务编号。

接下来$n$行，每行两个整数$w_i, y_i$，分别表示$i$号点的点权，集合编号。

接下来$n-1$行，每行两个整数$u, v$，表示$u$到$v$之间有一条边。

接下来$m$行，每行第一个数为$op$，表示询问编号。且若$T=1$，那么这一行剩下的数全部都要异或上$g$，其中$g = lastans \bmod 998244353$，初始$lastans = 0$。

如果$op = 1$，接下来两个整数$x, w$，表示将$x$的点权改为$w$。

如果$op = 2$，接下来两个整数$x, y$，表示将$x$的集合改为$y$。

如果$op = 3$，接下来一个整数$y$，表示查询一条满足两端点都在集合$y$的最大路径权值。

如果$op = 4$，接下来一个整数$y$，表示查询一条满足所有点都在集合$y$的最大点权连通块。

# 输出格式

对于所有的$op \in \{3, 4\}$的操作，每行依次输出一个答案。

# 样例

**样例 1 输入**
```
5 5 5 0 1
476416874 1
-734291638 2
-209707479 3
248601378 1
473438305 5
2 1
3 1
4 1
5 4
4 1
4 5
1 3 857108629
2 5 4
1 2 716486897
```

**样例 1 输出**
```
725018252
473438305
```

本题有附加样例，请自行下载。

# 数据范围与提示

**数据范围**

Subtask #1 (5'): $n, m \leq 10^4$。

Subtask #2 (10'): 树是一条链。

Subtask #3 (20'): $op \in \{1, 3\}$。

Subtask #4 (15'): $k \leq 2$。

Subtask #5 (15'): $T = 0$。

Subtask #6 (35'): 无特殊性质。

对于$100\%$的数据，满足$n, m \leq 10^5, k \leq n, T \in \{0, 1\}, O \in \{1, 2, 3, 4, 5, 6\}, |w| \leq 10^9, y \leq k$。

本题将使用捆绑测试。由于评测机实际性能问题，时限由 5s 加到 8s 。

**提示**

题目并不难(想)。

出题人：wfj

来源：HNOI 2018 省队集训 Day 4 T3


