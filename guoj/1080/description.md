
# 题目描述

> "Is this the real life
>
> Is this just fantasy"

这是空前的盛况，属于回归的 Queen 乐队的舞台。

观众们跟着 Queen 唱着这振奋人心的波西米亚狂想曲。

没有人知道，Queen 的成员在创作这首歌的时候花费了多少的心思。

许多许多年之后，后人利用先进的科技分析这首歌的时候，发现这首歌与一个常用的数据结构--树有着密切的关系。

后人决定模拟这首歌的创作过程。

一开始有 $m$ 棵树，这 $m$ 棵树排成一排，按照 $1..m$ 编号，这些树的形态都是一样的：都是有 $n$ 个节点的树。

初始的时候每棵树的每个节点上都有一个音符，节点 $i$ 上的音符编号为 $i$。

在创作的过程中，需要做出 $q$ 次操作。

每次操作形如： `l,r,u,v` ，表示对于编号为 $l..r$ 的树，将这棵树中音符 $u$ 所在的节点到音符 $v$ 所在的节点的最短路径上的所有边进行收缩。

其中“收缩”定义如下：

对于一条边 $e=(u,v)$，对 $e$ 进行收缩指的是将 $u,v$ 合并成一个新的节点 $w$，并且 $w$ 上的音符的集合为原本 $u,v$ 上的音符集合的并集。

形式化的，令 $N(u)$ 表示节点 $u$ 上的音符集合，将树 $T=(V,E)$ 中的 $e=(u,v)$ 这条边收缩成新节点 $w$ 得到树 $T'=(V',E')$。

其中 $V'=(V \backslash \{ u,v \}) \cup \{w\}$。

对于 $(x,y) \in E$ 且 $\{ x,y \} \cap \{u,v\}=0$，$(x,y)\in E'$；对于 $(x,y)\in E$ 且 $x \in \{u,v\},y \notin \{u,v \}$，$(w,y)\in E'$。

在进行了 $q$ 次操作之后，对于第 $i$ 棵树，记 $S_i$ 为这棵树中任意两个不同的音符所在的节点之间的距离和（音符 $x,y$ 和音符 $y,x$ 只用计算一次）

得出的 $S$ 序列就是根据这 $q$ 个操作得到的乐谱！

现在给你 $n,m,q$，这棵树初始的形态以及 $q$ 次操作，请你求出 $S$。

由于输出的数据量较大，请输出对 $S$ 加密的结果：
$$\sum_{i=1}^{m}S_i \times {12345678}^i\mod 10^9+7$$


# 输入格式

从标准输入读入。

第一行三个整数 $n,m,q$，分别表示树中的节点数，树的数量以及操作数。

接下来 $n-1$ 行，每行两个整数 $u,v$，表示树中的一条边 $(u,v)$。

接下来 $q$ 行，每行四个整数 $l,r,u,v$，表示对于编号为 $l..r$ 的树，将这棵树中音符 $u$ 所在的节点到音符 $v$ 所在的节点的最短路径上的所有边进行收缩。

# 输出格式

输出到标准输出。

一行一个整数，表示对 $S$ 加密的结果。

# 样例

#### 样例输入1
```plain
7 10 5
1 2
2 3
3 4
3 5
2 6
5 7
2 6 4 5
2 10 5 6
6 10 6 1
1 2 4 2
4 5 5 4
```

#### 样例输出1
```plain
411628501
```

#### 样例解释1

最终的 $S$ 为 `28 12 12 12 12 6 12 12 12 12`

# 数据范围与提示

本题采用捆绑测试。

对于所有数据，$n,m,q\le 500000$

子任务如下：

- Subtask3（20分）给出的树是一条链，节点$i$和$i+1$之间存在一条边
- Subtask4（20分）给出的树的形态完全随机
- Subtask7（20分）无特殊限制

其余 Subtask 见 [Problem 1079](/problem/1079)

命题人：samjia2000

